
<!-- saved from url=(0082)http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><script src="./x11vnc_files/athena.js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app219.us.archive.org';v.server_ms=1566;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="./x11vnc_files/bundle-playback.js" charset="utf-8"></script>
<script type="text/javascript" src="./x11vnc_files/wombat.js" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="./x11vnc_files/ruffle.js"></script>
<script type="text/javascript">
    __wm.init("http://web.archive.org/web");
  __wm.wombat("http://www.karlrunge.com/x11vnc/faq.html","20210304200604","http://web.archive.org/","web","https://web-static.archive.org/_static/",
	      "1614888364");
</script>
<link rel="stylesheet" type="text/css" href="./x11vnc_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="./x11vnc_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->
<title>x11vnc: a VNC server for real X displays</title></head>
<body bgcolor="white"><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;"><template shadowrootmode="closed"><div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;" class="">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=http%3A//web.archive.org/web/20210304200604/http%3A//www.karlrunge.com/x11vnc/faq.html" scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="http://web.archive.org/web/" title="Wayback Machine home page"><img src="https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-100.png, https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0"></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="http://web.archive.org/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.karlrunge.com/x11vnc/faq.html" onfocus="this.focus();this.select();" style="flex:1;" autocomplete="off"><input type="hidden" name="type" value="replay"><input type="hidden" name="date" value="20210304200604"><input type="submit" value="Go">
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
                <div class="s" id="wm-nav-captures" style="flex:1;"><a class="t" href="http://web.archive.org/web/*/http://www.karlrunge.com/x11vnc/faq.html" title="See a list of every capture for this URL">210 captures</a><div class="r" title="Timespan for captures of this URL">29 Jan 2009 - 4 Mar 2021</div></div>
        <div class="k">
          <a href="http://web.archive.org/web/20140501000000/http://www.karlrunge.com/x11vnc/faq.html" id="wm-graph-anchor">
            <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
              <canvas id="wm-sparkline-canvas" width="725" height="27" border="0"></canvas>
            <div class="yt" style="display: none; width: 25px; height: 27px; left: 450px;"></div><div class="mt" style="display: none; width: 2px; height: 27px; left: 459px;"></div></div>
          </a>
        </div>
      </div>
    </div>
    <div class="n">
      <table>
        <tbody>
          <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
          <tr class="m">
            <td class="b" nowrap="nowrap"><a href="http://web.archive.org/web/20200917110617/http://www.karlrunge.com/x11vnc/faq.html" title="17 Sep 2020"><strong>Sep</strong></a></td>
            <td class="c" id="displayMonthEl" title="You are here: 20:06:04 Mar 04, 2021">Mar</td>
            <td class="f" nowrap="nowrap">Apr</td>
          </tr>
          <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
          <tr class="d">
            <td class="b" nowrap="nowrap"><a href="http://web.archive.org/web/20200917110617/http://www.karlrunge.com/x11vnc/faq.html" title="11:06:17 Sep 17, 2020"><img src="https://web-static.archive.org/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0"></a></td>
            <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 20:06:04 Mar 04, 2021">04</td>
            <td class="f" nowrap="nowrap"><img src="https://web-static.archive.org/_static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0"></td>
          </tr>
          <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
          <tr class="y">
            <td class="b" nowrap="nowrap"><a href="http://web.archive.org/web/20200229062612/http://www.karlrunge.com/x11vnc/faq.html" title="29 Feb 2020"><strong>2020</strong></a></td>
            <td class="c" id="displayYearEl" title="You are here: 20:06:04 Mar 04, 2021">2021</td>
            <td class="f" nowrap="nowrap">2022</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
                <span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#" title="Share via My Web Archive" style="display: none;">
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in" style="display: inline-block;">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web" style="display: none;"></span>
        </span>
                <a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
        <a id="wm-tb-close" href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="http://web.archive.org/web/20210304200604/http://web.archive.org/screenshot/http://www.karlrunge.com/x11vnc/faq.html" id="wm-screenshot" title="screenshot" style="visibility: hidden;">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
        <a id="wm-share-facebook" href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#" data-url="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
        <a id="wm-share-twitter" href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#" data-url="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
        <a id="wm-expand" class="wm-btn wm-closed" href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#expand"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
        <div id="wm-capinfo-notice" source="api"></div>
                <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/archiveteam);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/archiveteam" target="_new"><span class="wm-title">Archive Team</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  <img align="right" src="http://archiveteam.org/images/e/e6/Archiveteam.jpg" width="200"> Formed in 2009, the Archive Team (not to be confused with the archive.org Archive-It Team) is a rogue archivist collective dedicated to saving copies of rapidly dying or deleted websites for the sake of history and digital heritage. The group is 100% composed of volunteers and interested parties, and has expanded into a large amount of related projects for saving online and digital history.
<p>
History is littered with hundreds of conflicts over the future of a community, group, location or business that were "resolved" when one of the parties stepped ahead and destroyed what was there. With the original point of contention destroyed, the debates would fall to the wayside. Archive Team believes that by duplicated condemned data, the conversation and debate can continue, as well as the richness and insight gained by keeping the materials. Our projects have ranged in size from a single volunteer downloading the data to a small-but-critical site, to over 100 volunteers stepping forward to acquire terabytes of user-created data to save for future generations.
</p><p>
The main site for Archive Team is at <a href="http://www.archiveteam.org/">archiveteam.org</a> and contains up to the date information on various projects, manifestos, plans and walkthroughs.
</p><p>
This collection contains the output of many Archive Team projects, both ongoing and completed. Thanks to the generous providing of disk space by the Internet Archive, multi-terabyte datasets can be made available, as well as in use by the <a href="http://archive.org/web/web.php">Wayback Machine</a>, providing a path back to lost websites and work. 
</p><p>
Our collection has grown to the point of having sub-collections for the type of data we acquire. If you are seeking to browse the contents of these collections, the Wayback Machine is the best first stop. Otherwise, you are free to dig into the stacks to see what you may find.
</p><p>
<b>The Archive Team Panic Downloads</b> are full pulldowns of currently extant websites, meant to serve as emergency backups for needed sites that are in danger of closing, or which will be missed dearly if suddenly lost due to hard drive crashes or server failures. 
</p><p>
	</p></div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/archiveteam_urls)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/archiveteam_urls" target="_new"><span class="wm-title">Archive Team: URLs</span></a></div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="https://web-static.archive.org/_static/images/loading.gif" alt="loading"></div>
    </div>
    </div>
  </div></div></div><link rel="stylesheet" type="text/css" href="./x11vnc_files/banner-styles.css"><link rel="stylesheet" type="text/css" href="./x11vnc_files/iconochive.css"><div class="wb-autocomplete-suggestions "></div></template>
</div><div id="wm-ipp-print">The Wayback Machine - http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(725,27,25,2,"web","http://www.karlrunge.com/x11vnc/faq.html","20210304200604",1996,"https://web-static.archive.org/_static/",["https://web-static.archive.org/_static/css/banner-styles.css?v=S1zqJCYt","https://web-static.archive.org/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 
<a name="faq"></a>
<a name="faq0"></a>
<br>
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/">x11vnc Home</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-thanks">Donations</a>
<hr noshade="1" size="2">
<h4>x11vnc FAQ:</h4>
<!-- LIST_BEGIN -->
&nbsp;<br><font size="-0"><b>[Building and Starting]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xperms"><b>Q-1:</b>
<font color="#007f00">
I can't get <b>x11vnc</b> to start up. It says "<code>XOpenDisplay failed (null)</code>"
or "<code>Xlib: connection to ":0.0" refused by server  Xlib: No protocol specified</code>" and then
exits.  What do I need to do?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-build"><b>Q-2:</b>
<font color="#007f00">
I can't get <b>x11vnc</b> and/or <b>libvncserver</b> to compile.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-missing-xtest"><b>Q-3:</b>
<font color="#007f00">
I just built <b>x11vnc</b> successfully, but when I use it my 
keystrokes and mouse button clicks are ignored
&nbsp;(I am able to move the mouse though.)
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-solaris251build"><b>Q-4:</b>
<font color="#007f00">
Help, I need to run <b>x11vnc</b> on Solaris 2.5.1 (or other old Unix/Linux)
and it doesn't compile!
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-binaries"><b>Q-5:</b>
<font color="#007f00">
Where can I get a precompiled <b>x11vnc</b> binary for my Operating System?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-viewer-download"><b>Q-6:</b>
<font color="#007f00">
Where can I get a VNC Viewer binary (or source code) for the Operating System
I will be viewing from?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-cmdline-opts"><b>Q-7:</b>
<font color="#007f00">
How can I see all of <b>x11vnc</b>'s command line options and
documentation on how to use them?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-config-file"><b>Q-8:</b>
<font color="#007f00">
I don't like typing arcane command line options every time I start
<b>x11vnc</b>.  What can I do?  Is there a config file?  Or a GUI?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-gui-tray"><b>Q-9:</b>
<font color="#007f00">
How can I get the GUI to run in the System Tray, or at least be a smaller,
simpler icon?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-change-port"><b>Q-10:</b>
<font color="#007f00">
How can I get <b>x11vnc</b> to listen on a different port
besides the default VNC port (5900)?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-selinux-perms"><b>Q-11:</b>
<font color="#007f00">
Why do I get "<code>Failure autoprobing: Permission denied</code>"
when <b>x11vnc</b> tries to listen on a TCP port?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-firewalls"><b>Q-12:</b>
<font color="#007f00">
My Firewall/Router doesn't allow VNC Viewers to connect to <b>x11vnc</b>.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-firewall-out"><b>Q-13:</b>
<font color="#007f00">
Is it possible for a VNC Viewer and a VNC Server to connect to each other
even though both are behind Firewalls that block all incoming connections?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-quiet-bg"><b>Q-14:</b>
<font color="#007f00">
Can I make <b>x11vnc</b> more quiet and also go into the background
after starting up?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-sigpipe"><b>Q-15:</b>
<font color="#007f00">
Sometimes when a VNC viewer dies abruptly, <b>x11vnc</b> also dies with
the error message like: "<code>Broken pipe</code>".  I'm using the <code>-forever</code>
mode and I want <b>x11vnc</b> to keep running. 
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-tight139"><b>Q-16:</b>
<font color="#007f00">
The Windows TightVNC 1.3.9 Viewer cannot connect to <b>x11vnc</b>.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-krdcprob"><b>Q-17:</b>
<font color="#007f00">
KDE's krdc VNC viewer cannot connect to <b>x11vnc</b>.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-tru64-crash"><b>Q-18:</b>
<font color="#007f00">
When I start <b>x11vnc</b> on an Alpha Tru64 workstation the X server crashes!
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-aix-freeze"><b>Q-19:</b>
<font color="#007f00">
When running <b>x11vnc</b> on an IBM AIX workstation after a few
minutes the VNC connection freezes.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-build-customizations"><b>Q-20:</b>
<font color="#007f00">
Are there any build-time customizations possible, e.g. change defaults,
create a smaller binary, etc?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Win2VNC Related]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-win2vnc"><b>Q-21:</b>
<font color="#007f00">
I have two separate machine displays in front of me, one Windows the
other X11: can I use <b>x11vnc</b> in combination with Win2VNC
in dual-screen mode to pass the keystrokes and mouse motions to the X11 display?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-win2vnc-8bpp"><b>Q-22:</b>
<font color="#007f00">
I am running <b>Win2VNC</b> on my Windows machine and 
"<code>x11vnc -nofb</code>" on Unix to pass keyboard and
mouse to the Unix monitor.
Whenever I start <b>Win2VNC</b> it
quickly disconnects and <b>x11vnc</b> says:
<code>rfbProcessClientNormalMessage: read: Connection reset by peer</code>
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-macosx-nofb"><b>Q-23:</b>
<font color="#007f00">
Can I run "<code>x11vnc -nofb</code>" on a Mac OS X machine to
redirect mouse and keyboard input to it from Windows and X11 machines
via <b>Win2VNC</b> and <b>x2vnc</b>, respectively?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Color Issues]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-8bpp"><b>Q-24:</b>
<font color="#007f00">
The X display I run <b>x11vnc</b> on is only 8 bits per pixel (bpp)
PseudoColor (i.e. only 256 distinct colors.)  The <b>x11vnc</b> colors may
start out OK, but after a while they are incorrect in certain windows.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-overlays"><b>Q-25:</b>
<font color="#007f00">
Color problems: Why are the colors for some windows incorrect in
<b>x11vnc</b>?  BTW, my X display has nice
overlay/multi-depth visuals of different color depths: e.g. there are
both depth 8 and 24 visuals available at the same time.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-directcolor"><b>Q-26:</b>
<font color="#007f00">
I am on a high color system (depth &#8805; 24) but I seem to have colormap
problems.  They either flash or everything is very dark.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-windowid"><b>Q-27:</b>
<font color="#007f00">
How do I figure out the window id to supply to the
<code>-id windowid</code> option?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-transients-id"><b>Q-28:</b>
<font color="#007f00">
Why don't menus or other transient windows come up when I am using
the <code>-id windowid</code> option to view a single application window?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-24bpp"><b>Q-29:</b>
<font color="#007f00">
My X display is depth 24 at 24bpp (instead of the normal depth 24 at 32bpp.)
I'm having lots of color and visual problems with <b>x11vnc</b>
and/or <b>vncviewer</b>.  What's up?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Xterminals]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-noshm"><b>Q-30:</b>
<font color="#007f00">
Can I use <b>x11vnc</b> to view and interact with an Xterminal (e.g. NCD)
that is not running UNIX and so <b>x11vnc</b> cannot be run on it directly?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xterminal-xauth"><b>Q-31:</b>
<font color="#007f00">
How do I get my X permissions (MIT-MAGIC-COOKIE file) correct for a 
Unix/Linux machine acting as an Xterminal?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Sun Rays]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-sunrays"><b>Q-32:</b>
<font color="#007f00">
I'm having trouble using <b>x11vnc</b> with my Sun Ray session.
</font></a></p>
&nbsp;<br><font size="-0"><b>[Remote Control]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-stop-bg"><b>Q-33:</b>
<font color="#007f00">
How do I stop <b>x11vnc</b> once it is running in the background?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-remote_control"><b>Q-34:</b>
<font color="#007f00">
Can I change settings in <b>x11vnc</b> without having to restart it?
Can I remote control it?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Security and Permissions]</b></font><br>



<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-passwd"><b>Q-35:</b>
<font color="#007f00">
How do I create a VNC password for use with <b>x11vnc</b>?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-passwd-noecho"><b>Q-36:</b>
<font color="#007f00">
Can I make it so <code>-storepasswd</code> doesn't show my password on the 
screen?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-passwdfile"><b>Q-37:</b>
<font color="#007f00">
Can I have two passwords for VNC viewers, one for full access and
the other for view-only access to the display?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-multipasswd"><b>Q-38:</b>
<font color="#007f00">
Can I have as many full-access and view-only passwords as I like?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-unix-passwords"><b>Q-39:</b>
<font color="#007f00">
Does <b>x11vnc</b> support Unix usernames and passwords?  Can I further
limit the set of Unix usernames who can connect to the VNC desktop?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-custom-passwords"><b>Q-40:</b>
<font color="#007f00">
Can I supply an external program to provide my own custom login
method (e.g. Dynamic/One-time passwords or non-Unix (LDAP) usernames and 
passwords)?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-forever-shared"><b>Q-41:</b>
<font color="#007f00">
Why does <b>x11vnc</b> exit as soon as the VNC viewer disconnects?
And why doesn't it allow more than one VNC viewer to connect at the same time?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-allow-opt"><b>Q-42:</b>
<font color="#007f00">
Can I limit which machines incoming VNC clients can connect from? 
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-tcp_wrappers"><b>Q-43:</b>
<font color="#007f00">
How do I build <b>x11vnc/libvncserver</b> with <code>libwrap</code> (tcp_wrappers) support?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-listen-interface"><b>Q-44:</b>
<font color="#007f00">
Can I have <b>x11vnc</b> only listen on one network interface (e.g. internal
LAN) rather than having it listen on all network interfaces and relying
on <code>-allow</code> to filter unwanted connections out?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-listen-localhost"><b>Q-45:</b>
<font color="#007f00">
Now that <code>-localhost</code> implies listening only on
the loopback interface, how I can occasionally allow in a non-localhost
via the <code>-R allowonce</code> remote control command?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-input-opt"><b>Q-46:</b>
<font color="#007f00">
Can I fine tune what types of user input are allowed?  E.g. have
some users just be able to move the mouse, but not click or type
anything? 
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-accept-opt"><b>Q-47:</b>
<font color="#007f00">
Can I prompt the user at the local X display whether the incoming VNC
client should be accepted or not?  Can I decide to make some clients view-only?
How about running an arbitrary program to make the decisions?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-users-opt"><b>Q-48:</b>
<font color="#007f00">
I start <b>x11vnc</b> as root because it is launched
via <code>inetd(8)</code> or a display manager like <code>gdm(1)</code>.
Can I have <b>x11vnc</b> later switch to a different user?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-blockdpy"><b>Q-49:</b>
<font color="#007f00">
I use a screen-lock when I leave my workstation (e.g. xscreensaver or
xlock.)  When I remotely access my workstation desktop via
<b>x11vnc</b> I can unlock the desktop fine, but I am worried people
will see my activities on the physical monitor.  What can I do to
prevent this, or at least make it more difficult?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-gone-lock"><b>Q-50:</b>
<font color="#007f00">
Can I have <b>x11vnc</b> automatically lock the screen when I disconnect
the VNC viewer?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Encrypted Connections]</b></font><br>



<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssh-unix"><b>Q-51:</b>
<font color="#007f00">
How can I tunnel my connection to <b>x11vnc</b> via an encrypted
SSH channel between two Unix machines?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssh-putty"><b>Q-52:</b>
<font color="#007f00">
How can I tunnel my connection to <b>x11vnc</b> via an encrypted
SSH channel from Windows using an SSH client like Putty?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-ext"><b>Q-53:</b>
<font color="#007f00">
How can I tunnel my connection to <b>x11vnc</b> via an encrypted
SSL channel using an external tool like <code>stunnel</code>?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-int"><b>Q-54:</b>
<font color="#007f00">
Does <b>x11vnc</b> have built-in SSL tunneling? 
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-viewers"><b>Q-55:</b>
<font color="#007f00">
How do I use VNC Viewers with built-in SSL tunneling?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-java-viewer-proxy"><b>Q-56:</b>
<font color="#007f00">
How do I use the Java applet VNC Viewer with built-in SSL tunneling when going
through a Web Proxy?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-portal"><b>Q-57:</b>
<font color="#007f00">
Can Apache web server act as a gateway for users to connect via SSL
from the Internet with a Web browser to <b>x11vnc</b> running on their
workstations behind a firewall?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-ca"><b>Q-58:</b>
<font color="#007f00">
Can I create and use my own SSL Certificate Authority (CA) with <b>x11vnc</b>?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Display Managers and Services]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-service"><b>Q-59:</b>
<font color="#007f00">
How can I run <b>x11vnc</b> as a "service" that is always available?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-display-manager"><b>Q-60:</b>
<font color="#007f00">
How can I use <b>x11vnc</b> to connect to an X login screen like
<code>xdm</code>, GNOME <code>gdm</code>,
KDE <code>kdm</code>, or CDE <code>dtlogin</code>? 
(i.e. nobody is logged into an X session yet.)
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-inetd"><b>Q-61:</b>
<font color="#007f00">
Can I run <b>x11vnc</b> out of <code>inetd(8)</code>?
How about <code>xinetd(8)</code>?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-avahi"><b>Q-62:</b>
<font color="#007f00">
Can I have <b>x11vnc</b> advertise its VNC service and port via mDNS / Zeroconf
(e.g. Avahi) so VNC viewers on the local network can detect it automatically?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-userlogin"><b>Q-63:</b>
<font color="#007f00">
Can I have <b>x11vnc</b> allow a user to log in with her UNIX username and password
and then have it find her X session display on that machine and then attach to it?
How about starting an X session if one cannot be found?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-loop"><b>Q-64:</b>
<font color="#007f00">
Can I have <b>x11vnc</b> restart itself after it terminates?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-java-http"><b>Q-65:</b>
<font color="#007f00">
How do I make <b>x11vnc</b> work with the Java VNC viewer applet in a
web browser?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-reverse-connect"><b>Q-66:</b>
<font color="#007f00">
Are reverse connections (i.e. the VNC server connecting to the
VNC viewer) using "<code>vncviewer -listen</code>" and <code>vncconnect(1)</code>
supported?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-reverse-connect-proxy"><b>Q-67:</b>
<font color="#007f00">
Can reverse connections be made to go through a Web or SOCKS proxy or SSH?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-web-login"><b>Q-68:</b>
<font color="#007f00">
Can <b>x11vnc</b> provide a multi-user desktop web login service
as an Apache CGI or PHP script?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xvfb"><b>Q-69:</b>
<font color="#007f00">
Can I use <b>x11vnc</b> as a replacement for <code>Xvnc</code>? (i.e.
not for a real display, but for a virtual one I keep around.)
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-headless"><b>Q-70:</b>
<font color="#007f00">
How can I use <b>x11vnc</b> on "headless" machines?  Why might I want to?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Resource Usage and Performance]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-solshm"><b>Q-71:</b>
<font color="#007f00">
I have lots of memory, but why does <b>x11vnc</b> fail with &nbsp;&nbsp; 
<code>shmget: No space left on device</code> &nbsp;&nbsp; or &nbsp;&nbsp;
<code>Minor opcode of failed request:  1 (X_ShmAttach)</code>?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-less-resource"><b>Q-72:</b>
<font color="#007f00">
How can I make <b>x11vnc</b> use less system resources?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-more-resource"><b>Q-73:</b>
<font color="#007f00">
How can I make <b>x11vnc</b> use MORE system resources?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-slow-link"><b>Q-74:</b>
<font color="#007f00">
I use <b>x11vnc</b> over a slow link with high latency (e.g. dialup
modem or broadband), is there anything I can do to speed things up?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xdamage"><b>Q-75:</b>
<font color="#007f00">
Does <b>x11vnc</b> support the X DAMAGE Xserver extension to find
modified regions of the screen quickly and efficiently?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xdamage-opengl"><b>Q-76:</b>
<font color="#007f00">
My OpenGL application shows no screen updates unless
I supply the <code>-noxdamage</code> option to <b>x11vnc</b>.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-pointer-mode"><b>Q-77:</b>
<font color="#007f00">
When I drag windows around with the mouse or scroll up and down things
really bog down (unless I do the drag in a single, quick motion.)
Is there anything to do to improve things?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-wireframe"><b>Q-78:</b>
<font color="#007f00">
Why not do something like wireframe animations to avoid the windows
"lurching" when being moved or resized?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-scrollcopyrect"><b>Q-79:</b>
<font color="#007f00">
Can <b>x11vnc</b> try to apply heuristics to detect when a window is
scrolling its contents and use the CopyRect encoding for a speedup?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-client-caching"><b>Q-80:</b>
<font color="#007f00">
Can <b>x11vnc</b> do client-side caching of pixel data?  
I.e. so when that pixel data is needed again it does not
have to be retransmitted over the network. 
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-turbovnc"><b>Q-81:</b>
<font color="#007f00">
Does <b>x11vnc</b> support TurboVNC?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Mouse Cursor Shapes]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-cursor-shape"><b>Q-82:</b>
<font color="#007f00">
Why isn't the mouse cursor shape (the little icon shape where the
mouse pointer is) correct as I move from window to window?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xfixes-alpha"><b>Q-83:</b>
<font color="#007f00">
When using XFIXES cursorshape mode, some of the cursors look really
bad with extra black borders around the cursor and other cruft.
How can I improve their appearance?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xfixes-alpha-hacks"><b>Q-84:</b>
<font color="#007f00">
In XFIXES mode, are there any hacks to handle cursor transparency ("alpha
channel") exactly?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Mouse Pointer]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-cursor-arrow"><b>Q-85:</b>
<font color="#007f00">
Why does the mouse arrow just stay in one corner in my vncviewer, whereas
my cursor (that does move) is just a dot?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-cursor-positions"><b>Q-86:</b>
<font color="#007f00">
Can I take advantage of the TightVNC extension to the VNC protocol where
Cursor Positions Updates are sent back to all connected clients (i.e.
passive viewers can see the mouse cursor being moved around by another
viewer)?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-buttonmap-opt"><b>Q-87:</b>
<font color="#007f00">
Is it possible to swap the mouse buttons (e.g. left-handed operation),
or arbitrarily remap them?  How about mapping button clicks to 
keystrokes, e.g. to partially emulate Mouse wheel scrolling?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Keyboard Issues]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-altgr"><b>Q-88:</b>
<font color="#007f00">
How can I get my <code>AltGr</code> and <code>Shift</code> modifiers
to work between keyboards for different languages?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-greaterless"><b>Q-89:</b>
<font color="#007f00">
When I try to type a "&lt;" (i.e. less than) instead I get "&gt;" (i.e. greater than)!
Strangely, typing "&gt;" works OK!!
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-greaterless-sloppy"><b>Q-90:</b>
<font color="#007f00">
Extra Character Inserted, E.g.: When I try to type a "&lt;" (i.e. less than) instead I get "&lt;," (i.e.
an extra comma.)
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xkbmodtweak"><b>Q-91:</b>
<font color="#007f00">
I'm using an "international" keyboard (e.g. German "de", or Danish "dk")
and the <code>-modtweak</code> mode works well if the VNC viewer is run
on a Unix/Linux machine with a similar keyboard.&nbsp;&nbsp; But if I run the VNC
viewer on Unix/Linux with a different keyboard (e.g. "us") or Windows
with any keyboard, I can't type some keys like:&nbsp;&nbsp; "@", "$", "&lt;", "&gt;", etc.
How can I fix this? 
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-repeated-keys"><b>Q-92:</b>
<font color="#007f00">
When typing I sometimes get double, triple, or more of my keystrokes
repeated.  I'm sure I only typed them once, what can I do?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-repeated-keys-still"><b>Q-93:</b>
<font color="#007f00">
The <b>x11vnc</b> <code>-norepeat</code> mode is in effect, but I <em>still</em>
get repeated keystrokes!!
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-mod-stuck-down"><b>Q-94:</b>
<font color="#007f00">
After using <b>x11vnc</b> for a while, I find that I cannot type
some (or any) characters or my mouse clicks and drags no longer
have any effect, or they lead to strange effects.  What happened?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-remap-opt"><b>Q-95:</b>
<font color="#007f00">
The machine where I run <b>x11vnc</b> has an <code>AltGr</code> key, but the
local machine where I run the VNC viewer does not.  Is there a way I 
can map a local unused key to send an <code>AltGr</code>?  How about
a <code>Compose</code> key as well?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-sun-alt-meta"><b>Q-96:</b>
<font color="#007f00">
I have a Sun machine I run <b>x11vnc</b> on.  Its Sun keyboard
has just one <code>Alt</code> key labelled "Alt" and two <code>Meta</code>
keys labelled with little diamonds.  The machine where I run the
VNC viewer only has <code>Alt</code> keys.  How can I send a <code>Meta</code>
keypress?  (e.g. emacs needs this) 
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-hpux-multi-key"><b>Q-97:</b>
<font color="#007f00">
Running <b>x11vnc</b> on HP-UX I cannot type "#" I just get a "3" instead.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-remap-button-click"><b>Q-98:</b>
<font color="#007f00">
Can I map a keystroke to a mouse button click on the remote machine? 
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-remap-capslock"><b>Q-99:</b>
<font color="#007f00">
How can I get Caps_Lock to work between my VNC viewer and <b>x11vnc</b>?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Screen Related Issues and Features]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-scrollbars"><b>Q-100:</b>
<font color="#007f00">
The remote display is larger (in number of pixels) than the local display
I am running the <b>vncviewer</b> on.  I don't like the <b>vncviewer</b> scrollbars, 
what I can do? 
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-scaling"><b>Q-101:</b>
<font color="#007f00">
Does <b>x11vnc</b> support server-side framebuffer scaling?  (E.g. to
make the desktop smaller.)
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xinerama"><b>Q-102:</b>
<font color="#007f00">
Does <b>x11vnc</b> work with Xinerama? (i.e. multiple monitors joined
together to form one big, single screen.)
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-multi-screen"><b>Q-103:</b>
<font color="#007f00">
Can I use <b>x11vnc</b> on a multi-headed display that is not Xinerama
(i.e. separate screens <code>:0.0</code>, <code>:0.1</code>, ... 
for each monitor)?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-clip-screen"><b>Q-104:</b>
<font color="#007f00">
Can <b>x11vnc</b> show only a portion of the display?  (E.g. for
a special purpose application or a very large screen.)
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xrandr"><b>Q-105:</b>
<font color="#007f00">
Does <b>x11vnc</b> support the XRANDR (X Resize, Rotate and Reflection)
extension?  Whenever I rotate or resize the screen <b>x11vnc</b> 
just seems to crash.  
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-rotate"><b>Q-106:</b>
<font color="#007f00">
Independent of any XRANDR, can I have <b>x11vnc</b> rotate and/or
reflect the screen that the VNC viewers see?  (e.g. for a handheld
whose screen is rotated 90 degrees.)
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-black-screen"><b>Q-107:</b>
<font color="#007f00">
Why is the view in my VNC viewer completely black?  Or why is
everything flashing around randomly?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-linuxvc"><b>Q-108:</b>
<font color="#007f00">
I use Linux <b>Virtual Terminals</b> (VT's) to implement 'Fast User Switching'
between users' sessions (e.g. Betty is on <code>Ctrl-Alt-F7</code>,
Bobby is on <code>Ctrl-Alt-F8</code>, and Sid is on
<code>Ctrl-Alt-F1</code>: they use those keystrokes to switch between
their sessions.)&nbsp;&nbsp; How come the view in a VNC viewer connecting to
<b>x11vnc</b> is either completely black, doesn't update, or pixels messed up
unless the X session <b>x11vnc</b> is attached to is in <b>the active VT</b>?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-hidden-taskbars"><b>Q-109:</b>
<font color="#007f00">
I am using <b>x11vnc</b> where my local machine has "popup/hidden taskbars"
and the remote display where  <b>x11vnc</b> runs also has "popup/hidden
taskbars" and they interfere and fight with each other.  What can I do?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-kde-screensaver"><b>Q-110:</b>
<font color="#007f00">
Help! <b>x11vnc</b> and my KDE screensaver keep switching each other on and off every few seconds.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-beryl"><b>Q-111:</b>
<font color="#007f00">
I am running the compiz 3D window manager (or beryl, MythTv, Google Earth,
or some other OpenGL app) and I do not get screen updates in <b>x11vnc</b>.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-vmware"><b>Q-112:</b>
<font color="#007f00">
Can I use <b>x11vnc</b> to view my VMWare session remotely?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Exporting non-X11 devices via VNC]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-rawfb"><b>Q-113:</b>
<font color="#007f00">
Can non-X devices (e.g. a raw framebuffer) be viewed (and even controlled)
via VNC with <b>x11vnc</b>?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-linux-vt"><b>Q-114:</b>
<font color="#007f00">
Can I export the Linux Console (Virtual Terminals) via VNC using <b>x11vnc</b>?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-video"><b>Q-115:</b>
<font color="#007f00">
Can I export via VNC a Webcam or TV tuner framebuffer using <b>x11vnc</b>?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-qt-embedded"><b>Q-116:</b>
<font color="#007f00">
Can I connect via VNC to a Qt-embedded/Qt-enhanced/Qtopia application running on my
handheld, cell phone, or PC using the Linux console framebuffer (i.e. not X11)?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-qtmoko"><b>Q-117:</b>
<font color="#007f00">
How do I inject touch screen input into an Qt-embedded/Qt-enhanced/Qtopia cell phone
such as openmoko/qtmoko Neo Freerunner?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-no-x11"><b>Q-118:</b>
<font color="#007f00">
Now that non-X11 devices can be exported via VNC using <b>x11vnc</b>,
can I build it with no dependencies on X11 header files and libraries?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-cross-compile"><b>Q-119:</b>
<font color="#007f00">
How do I cross compile <b>x11vnc</b> for a different architecture than
my Linux i386 or amd64 PC?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-macosx"><b>Q-120:</b>
<font color="#007f00">
Does <b>x11vnc</b> support Mac OS X Aqua/Quartz displays natively
(i.e. no X11 involved)?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-reflect"><b>Q-121:</b>
<font color="#007f00">
Can <b>x11vnc</b> be used as a VNC reflector/repeater to improve
performance for the case of a large number of simultaneous VNC viewers
(e.g. classroom broadcasting or a large demo)?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-os-install"><b>Q-122:</b>
<font color="#007f00">
Can <b>x11vnc</b> be used during a Linux, Solaris, etc. system Installation
so the Installation can be done remotely?
</font></a></p>
&nbsp;<br><font size="-0"><b>[Misc: Clipboard, File Transfer/Sharing, Printing, Sound, Beeps, Thanks, etc.]</b></font><br>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-clipboard"><b>Q-123:</b>
<font color="#007f00">
Does the Clipboard/Selection get transferred between the vncviewer
and the X display? 
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-record-swf"><b>Q-124:</b>
<font color="#007f00">
Can I use <b>x11vnc</b> to record a Shock Wave Flash (or other format)
video of my desktop, e.g. to record a tutorial or demo?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-filexfer"><b>Q-125:</b>
<font color="#007f00">
Can I transfer files back and forth with <b>x11vnc</b>?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ultravnc"><b>Q-126:</b>
<font color="#007f00">
Which UltraVNC extensions are supported?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-singleclick"><b>Q-127:</b>
<font color="#007f00">
Can <b>x11vnc</b> emulate UltraVNC's Single Click helpdesk mode for Unix?  I.e. something
very simple for a naive user to initiate
a reverse vnc connection from their Unix desktop to a helpdesk operator's
VNC Viewer.
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-smb-shares"><b>Q-128:</b>
<font color="#007f00">
Can I (temporarily) mount my local (viewer-side) Windows/Samba File share
on the machine where <b>x11vnc</b> is running?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-cups"><b>Q-129:</b>
<font color="#007f00">
Can I redirect CUPS print jobs from the remote desktop where 
<b>x11vnc</b> is running to a printer on my local (viewer-side) machine?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-sound"><b>Q-130:</b>
<font color="#007f00">
How can I hear the sound (audio) from the remote applications on the desktop
I am viewing via <b>x11vnc</b>?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-beeps"><b>Q-131:</b>
<font color="#007f00">
Why don't I hear the "Beeps" in my X session (e.g. when typing <code>tput bel</code>
in an xterm)?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ipv6"><b>Q-132:</b>
<font color="#007f00">
Does <b>x11vnc</b> work with IPv6?
</font></a></p>


<p><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-thanks"><b>Q-133:</b>
<font color="#007f00">
Thanks for your program or for your help!  Can I make a donation?
</font></a></p>

<!-- LIST_END -->

<hr noshade="1" size="2">

&nbsp;<br><font size="-0"><b>[Building and Starting]</b></font><br>
<a name="faq-xperms"></a>
<a name="FAQ-1"></a>
<p><b>Q-1:</b>
<font color="#007f00">
I can't get <b>x11vnc</b> to start up. It says "<code>XOpenDisplay failed (null)</code>"
or "<code>Xlib: connection to ":0.0" refused by server  Xlib: No protocol specified</code>" and then
exits.  What do I need to do?
</font>
</p>
<p>
For the former error, you need to specify the X display to connect to
(it also needs to be on the same machine the <b>x11vnc</b> process is to run on.)
Set your <code>DISPLAY</code> environment variable (or use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-display"><code>-display</code></a> option) to specify it.  Nearly always the correct
value will be "<code>:0</code>"
(in fact, <b>x11vnc</b> will now assume <code>:0</code> if given no other information.)
</p><p>
&nbsp;<br>
For the latter error, you need to set up the X11 permissions correctly.
</p><p>
To make sure X11 permissions are the problem do this simple test:
while sitting at the <em><b>physical</b></em> X display open a terminal window
(gnome-terminal, xterm, etc.)  You should be able to run
<b>x11vnc</b> successfully <em>without any need for special steps or 
command line options</em>
in that terminal (i.e. just type "<code>x11vnc</code>".)  If that works OK then you know X11 permissions are the
only thing preventing it from working when you try to start <b>x11vnc</b>
via, say, a remote shell.
</p><p>
<em>How to Solve:</em>&nbsp; See the <code>xauth(1)</code>, <code>Xsecurity(7)</code>,
and <code>xhost(1)</code> man pages or
<a href="http://web.archive.org/web/20210304200604/http://www.tldp.org/HOWTO/Remote-X-Apps.html">this Howto</a>
for much info on X11 permissions.  For example, you may need to set your
<code>XAUTHORITY</code> environment variable (or use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-auth"><code>-auth</code></a> option) to point
to the correct MIT-MAGIC-COOKIE file
(e.g.  <code>/home/joe/.Xauthority</code> or
<code>/var/gdm/:0.Xauth</code> or <code>/var/lib/kdm/A:0-crWk72K</code>
or <code>/tmp/.gdmzndVlR</code>, etc, etc.), or simply be sure you run
<b>x11vnc</b> as the correct user (i.e. the user who is logged into the X
session you wish to view.)
</p><p>
<b><em>Note:</em></b> The MIT cookie file contains the <em><b>secret key</b></em> that
allows <b>x11vnc</b> to connect to the desired X display.
</p><p>
If, say, <code>sshd</code> has set <code>XAUTHORITY</code>
to point to a random file it has created for X forwarding that will
cause problems. (Under some circumstances even <code>su(1)</code>
and <code>telnet(1)</code> can set <code>XAUTHORITY</code>.
See also the <code>gdm</code> parameter <code>NeverPlaceCookiesOnNFS</code>
that sets <code>XAUTHORITY</code> to a random filename in <code>/tmp</code>
for the whole X session.)
</p><p>
Running <b>x11vnc</b> as root is often <b><em>not</em></b> enough: you need to know
<em>where</em> the MIT-MAGIC-COOKIE file for the desired X display is.
</p><p>
Example solution:
</p><pre>  x11vnc -display :0 -auth /var/gdm/:0.Xauth
</pre>
(this is for the display manager gdm and requires root permission
to read the gdm cookie file, see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-display-manager">
this faq</a> for other display manager cookie file names.)
<p></p><p>
Note as of Feb/2007 you can also try the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-find"><code>-find</code></a>
option instead of "<code>-display ...</code>" and see if that
finds your display and Xauthority.
</p><p>
Less safe, but to avoid figuring out where the correct <code>XAUTHORITY</code>
file is, if the person sitting at the physical X session types 
"<code>xhost +localhost</code>"
then one should be able to attach <b>x11vnc</b> to the session (from the
same machine.)  The person could then type "<code>xhost -localhost</code>"
after <b>x11vnc</b> has connected to go back to the default permissions.
Also, for some situations the "<code>-users lurk=</code>" option may soon be
of use (please read the documentation on the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-users"><code>-users</code></a> option.)
</p><p>
<br>
To test out your X11 permissions from a remote shell, set
<code>DISPLAY</code> and possibly <code>XAUTHORITY</code> (see your
shell's man page, <code>bash(1)</code>, <code>tcsh(1)</code>, on how to
set environment variables) and type <code>xdpyinfo</code> in the
same place you will be typing (or otherwise running) <b>x11vnc</b>.  If
information is printed out about the X display (screen sizes, supported
extensions, color visuals info) that means the X11 permissions
are set up properly: <code>xdpyinfo</code> successfully connected to 
<code>DISPLAY</code>!  You could also type <code>xclock</code>
and make sure no errors are reported (a clock should appear on the X display,
press Ctrl-C to stop it.)  If these work, then typing "<code>x11vnc</code>"
in the same environment should also work.
</p><p>
<b><em><font color="bisque4">Important</font></em></b>: if you cannot get
your X11 permissions so that the <code>xdpyinfo</code> or
<code>xclock</code> tests work, <b>x11vnc</b> also <i>will not
work</i> (all of these X clients must be allowed to connect to the X
server to function properly.)
</p><p>
<b><em>Firewalls:</em></b> Speaking of permissions, it should go without
saying that the host-level <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#firewalls">firewall</a> will need to be configured to allow
connections in on a port.  E.g. 5900 (default VNC port) or 22 (default
SSH port for tunnelling VNC.)  Most systems these days have firewalls
turned on by default, so you will actively have to do something to poke
a hole in the firewall at the desired port number.
See your system administration tool for Firewall settings (Yast, Firestarter, etc.)
</p><p>&nbsp;</p>

<a name="faq-build"></a>
<a name="FAQ-2"></a>
<p><b>Q-2:</b>
<font color="#007f00">
I can't get <b>x11vnc</b> and/or <b>libvncserver</b> to compile.
</font>
</p>
<p>
Make sure you have gcc (or other C compiler) and all of the required
libraries <b>and</b> the corresponding <code>-dev/-devel</code> packages
installed.  These include <code>Xorg/XFree86</code>, <code>libX11</code>,
<code>libjpeg</code>, <code>libz</code>, <code>libssl</code>, ...  and
don't forget the devs: <code>libjpeg-dev</code>, <code>libssl-dev</code>
...
</p><p>
The most common build problem that people encounter is that the necessary
X11 libraries are installed on their system however it does not have the
corresponding -dev/-devel packages installed. These dev packages include
C header files and build-time <code>.so</code> symlink.  It is a shame
the current trend in distros is to not install the dev package by default
when the the library runtime package is installed... (it diminishes the
power of open source)
</p><p>
As of Nov/2006 here is a list of libraries that <b>x11vnc</b>
usually likes to use:
</p><pre>libc.so        libX11.so       libXtst.so       libXext.so
libXfixes.so   libXdamage.so   libXinerama.so   libXrandr.so
libz.so        libjpeg.so      libpthread.so
libssl.so      libcrypto.so    libcrypt.so
</pre>
although <b>x11vnc</b> will be pretty usable with the subset:
<code>libc.so</code>, <code>libX11.so</code>, <code>libXtst.so</code>,
<code>libXext.so</code>, <code>libz.so</code>, and <code>libjpeg.so</code>.
<p></p><p>
After running the <b>libvncserver</b> <code>configure</code>,
carefully examine the output and the messages in the <code>config.log</code> file
looking for missing components.  For example, if the <code>configure</code> 
output looks like:
</p><pre>  checking how to run the C preprocessor... gcc -E
  checking for X... no
  checking for XkbSelectEvents in -lX11... no
  checking for XineramaQueryScreens in -lXinerama... no
  checking for XTestFakeKeyEvent in -lXtst... no
</pre>
or even worse:
<pre>  checking for C compiler default output file name... configure: error:
  C compiler cannot create executables
  See `config.log' for more details.
</pre>
there is quite a bit wrong with the build environment.
Hopefully simply adding <code>-dev</code> packages and/or
<code>gcc</code> or <code>make</code> will fix it. 
<p></p><p>
For Debian the list seems to be:
</p><pre>  gcc
  make
  libc6-dev
  libjpeg8-dev           (formerly libjpeg62-dev)
  libx11-dev
  x11proto-core-dev      (formerly x-dev)
  libxext-dev
  libxtst-dev
  libxdamage-dev
  libxfixes-dev
  libxrandr-dev
  libxinerama-dev
  libxss-dev             (formerly xlibs-static-dev)
  zlib1g-dev
  libssl-dev
  libavahi-client-dev
  linux-libc-dev         (only needed for linux console rawfb support)
</pre>
Note that depending on your OS version the above names may have
been changed and/or additional packages may be needed.
<p></p><p>
For Redhat the list seems to be:
</p><pre>  gcc
  make
  glibc-devel
  libjpeg-devel
  libX11-devel
  xorg-x11-proto-devel
  libXdamage-devel
  libXfixes-devel
  libXrandr-devel
  zlib-devel
  openssl-devel
  avahi-devel
  kernel-headers         (only needed for linux console rawfb support)
</pre>
<p></p><p>
For other distros or OS's the package names may not be the same but
will look similar.  Also, distros tend to rename packages as well so
the above list may be out of date.  So only use the above lists
as hints for the package names that are needed.
</p><p>
Have a look at <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/miscbuild.html">Misc. Build Problems</a> for
additional fixes.
</p><p>
Note: there is growing trend in Linux and other distros to slice up core
X11 software into more and smaller packages.  So be prepared for more
headaches compiling software...
</p><p>
<!--
<em>libssl:</em>&nbsp;
One user pointed out that if you use a precompiled binary (either one
you downloaded or built on another machine) there is a chance it
won't work because that <b>x11vnc</b> binary requires <code>libssl0.9.7</code>
but the system only has <code>libssl0.9.8</code> (which evidently is
incompatible with 0.9.7 and has a different SONAME.)  Your distro
should allow you do have both runtimes installed on your system:
<pre>
    % dpkg -l libssl0.9.7 libssl0.9.8
    ...
    ii  libssl0.9.7    0.9.7g-5ubuntu SSL shared libraries
    ii  libssl0.9.8    0.9.8a-7ubuntu SSL shared libraries
</pre>
(in fact it <em>should</em> have installed <em>both</em> by default
if it knew what it was doing.)
See <a href="faq.html#infaq_libssl-problems">here</a> too.
-->
</p><p>&nbsp;</p>

<a name="faq-missing-xtest"></a>
<a name="FAQ-3"></a>
<p><b>Q-3:</b>
<font color="#007f00">
I just built <b>x11vnc</b> successfully, but when I use it my 
keystrokes and mouse button clicks are ignored
&nbsp;(I am able to move the mouse though.)
</font>
</p>
<p>
This is most likely due to you not having a working build environment
for the XTEST client library <code>libXtst.so</code>.  The library is probably
present on your system, but the package installing the build
header file is missing.
</p><p>
If you were watching carefully while <code>configure</code> was running
you would have seen:
</p><pre>  checking for XTestFakeKeyEvent in -lXtst... no
</pre>
<p></p><p>
The solution is to add the necessary build environment package
(and the library package if that is missing too.)  On Debian
the build package is <code>libxtst-dev</code>.
Other distros/OS's may have it in another package.
</p><p>
<b>x11vnc</b> will build without support for this library (e.g. perhaps
one wants a view-only <b>x11vnc</b> on a stripped down or embedded
system...)  And at runtime it will also continue to run even if the X server
it connects to does not support XTEST.  In both cases it cannot inject
keystrokes or button clicks since XTEST is needed for that (it can 
still move the mouse pointer using the X API <code>XWarpPointer()</code>.)
</p><p>
You will see a warning message something like this at run time:
</p><pre>  20/03/2005 22:33:09 WARNING: XTEST extension not available (either missing from
  20/03/2005 22:33:09   display or client library libXtst missing at build time.)
  20/03/2005 22:33:09   MOST user input (pointer and keyboard) will be DISCARDED.
  20/03/2005 22:33:09   If display does have XTEST, be sure to build x11vnc with
  20/03/2005 22:33:09   a working libXtst build environment (e.g. libxtst-dev,
  20/03/2005 22:33:09   or other packages.)
  20/03/2005 22:33:09 No XTEST extension, switching to -xwarppointer mode for
  20/03/2005 22:33:09   pointer motion input.
</pre>
<p></p><p>
Also, as of Nov/2006 there will be a <code>configure</code> build time
warning as well:
</p><pre>  ...
  checking for XFixesGetCursorImage in -lXfixes... yes
  checking for XDamageQueryExtension in -lXdamage... yes
  configure: WARNING:
  ==========================================================================
  A working build environment for the XTEST extension was not found (libXtst).
  An x11vnc built this way will be only barely usable.  You will be able to
  move the mouse but not click or type.  There can also be deadlocks if an
  application grabs the X server.
  
  It is recommended that you install the necessary development packages
  for XTEST (perhaps it is named something like libxtst-dev) and run
  configure again.
  ==========================================================================
</pre>
<p></p><p>&nbsp;</p>

<a name="faq-solaris251build"></a>
<a name="FAQ-4"></a>
<p><b>Q-4:</b>
<font color="#007f00">
Help, I need to run <b>x11vnc</b> on Solaris 2.5.1 (or other old Unix/Linux)
and it doesn't compile!
</font>
</p>
<p>
We apologize that <b>x11vnc</b> does not build cleanly on older versions
of Solaris, Linux, etc.: very few users are on these old releases.
</p><p>
We have heard that since Dec/2004 a Solaris 2.6 built <b>x11vnc</b>
will run on Solaris Solaris 2.5 and 2.5.1 (since a workaround
for <code>XConvertCase</code> is provided.)
</p><p>
In any event, here is a workaround for Solaris 2.5.1 (and perhaps
earlier and perhaps non-Solaris):
</p><p>
First use the environment settings (<code>CPPFLAGS</code>,
<code>LDFLAGS</code>, etc.)
in the above <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#solarisbuilding">Solaris build script</a>
to run the <code>configure</code> command.  That should succeed without
failure.  Then you have to hand edit the autogenerated
<code>rfb/rfbconfig.h</code> file in the source tree, and just
<em>before</em> the last <code>#endif</code>
at the bottom of that file insert these workaround lines:
</p><pre>struct timeval _tmp_usleep_tv;
#define usleep(x) \
    _tmp_usleep_tv.tv_sec  = (x) / 1000000; \
    _tmp_usleep_tv.tv_usec = (x) % 1000000; \
    select(0, NULL, NULL, NULL, &amp;_tmp_usleep_tv); 
int gethostname(char *name, int namelen);
long random();
int srandom(unsigned int seed);
#undef LIBVNCSERVER_HAVE_LIBPTHREAD
#define SHUT_RDWR 2
typedef unsigned int in_addr_t;
#define snprintf(a, n, args...) sprintf((a), ## args) 
</pre>
<p></p><p>
Then run <code>make</code> with the Solaris build script environment,
everything should compile without problems, and the resulting
<b>x11vnc</b> binary should work OK.
If some non-x11vnc related programs fail (e.g. test programs) and
the <b>x11vnc</b> binary is not created try "<code>make -k</code>"
to have it keep going.
Similar sorts of kludges in <code>rfb/rfbconfig.h</code>
can be done on other older OS (Solaris, Linux, ...) releases.
</p><p>
Here are some notes for similar steps that need to be done
to build on <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_sunos4.html">SunOS 4.x</a>
</p><p>
Please let us know if you had to use the above workaround (and whether
it worked or not.)  If there is enough demand we will try to push
clean compilations back to earlier Solaris, Linux, etc, releases.
</p><p>&nbsp;</p>

<a name="faq-binaries"></a>
<a name="FAQ-5"></a>
<p><b>Q-5:</b>
<font color="#007f00">
Where can I get a precompiled <b>x11vnc</b> binary for my Operating System?
</font>
</p>
<p>
Hopefully the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#building">build steps</a> above and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-build">FAQ</a> provide enough info for a painless compile for
most environments.
Please report problems with the <b>x11vnc</b> configure, make, etc. on your system
(if your system is known to compile other GNU packages successfully.)
</p><p>
There are precompiled <b>x11vnc</b> binaries built by other
groups that are available at the following locations:
</p><pre>    Slackware:      (.tgz)  <a href="http://web.archive.org/web/20210304200604/http://www.linuxpackages.net/search_view.php?by=name&amp;name=x11vnc">http://www.linuxpackages.net/</a>
    SuSE:           (.rpm)  <a href="http://web.archive.org/web/20210304200604/http://software.opensuse.org/search?baseproject=openSUSE%3A11.2&amp;p=1&amp;q=x11vnc">http:/software.opensuse.org/</a>
    Gentoo:         (info)  <a href="http://web.archive.org/web/20210304200604/http://en.gentoo-wiki.com/wiki/X11VNC">http://gentoo-wiki.com/</a> and <a href="http://web.archive.org/web/20210304200604/http://gentoo-portage.com/x11-misc/x11vnc">http://gentoo-portage.com/</a>
    FreeBSD:        (.tbz)  <a href="http://web.archive.org/web/20210304200604/http://www.freebsd.org/cgi/ports.cgi?query=x11vnc&amp;stype=all">http://www.freebsd.org/</a>
                            <a href="http://web.archive.org/web/20210304200604/http://www.freshports.org/net/x11vnc">http://www.freshports.org/net/x11vnc</a>
    NetBSD:         (src)   <a href="http://web.archive.org/web/20210304200604/http://pkgsrc.se/x11/x11vnc">http://pkgsrc.se/x11/x11vnc</a>
    OpenBSD:        (.tgz)  <a href="http://web.archive.org/web/20210304200604/http://openports.se/x11/x11vnc">http://openports.se/</a>
    Arch Linux:     (.tgz)  <a href="http://web.archive.org/web/20210304200604/http://www.archlinux.org/packages/search/?q=x11vnc">http://www.archlinux.org/</a>
    Nokia 770       (.deb)  <a href="http://web.archive.org/web/20210304200604/http://mike.saunby.googlepages.com/">http://mike.saunby.googlepages.com/x11vncfornokia7702</a>
    Sharp Zaurus            <a href="http://web.archive.org/web/20210304200604/http://www.focv.com/ipkg/">http://www.focv.com/</a>
    Debian:         (.deb)  <a href="http://web.archive.org/web/20210304200604/http://packages.debian.org/x11vnc">http://packages.debian.org/x11vnc</a>
    Redhat/Fedora:  (.rpm)  <a href="http://web.archive.org/web/20210304200604/http://packages.sw.be/x11vnc/">http://packages.sw.be/x11vnc RPMforge</a>
                            <a href="http://web.archive.org/web/20210304200604/http://dag.wieers.com/rpm/packages/x11vnc/">http://dag.wieers.com/rpm/packages/x11vnc/</a> (N.B.: unmaintained after 0.9.3)
    Solaris:        (pkg)   <a href="http://web.archive.org/web/20210304200604/http://www.sunfreeware.com/">http://www.sunfreeware.com/</a>
</pre>
<p></p><p>
If the above binaries don't work and building <b>x11vnc</b> on
your OS fails (and all else fails!) you can try one of 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/bins">My Collection of <b>x11vnc</b> Binaries</a> for various OS's and
<b>x11vnc</b> releases.
</p><p>
As a general note, the <b>x11vnc</b> program is simple enough you don't
really need to install a package: the binary will in most cases work as
is and from any location (as long as your system libraries are not too
old, etc.)
So, for Linux distributions that are not one of the above, the
<b>x11vnc</b> binary from the above packages has a good chance of working.
You can "install" it by just copying the <b>x11vnc</b> binary to the
desired directory in your <code>PATH</code>.
Tip on extracting files from a Debian package: extract the archive via
a command like: "<code>ar x x11vnc_0.6-2_i386.deb</code>" and then you
can find the binary in the resulting <code>data.tar.gz</code> tar file.
Also, <code>rpm2cpio(1)</code> is useful in extracting files from rpm packages.
</p><p>
If you use a standalone binary like this and <em>also</em> want <b>x11vnc</b> to serve up the Java VNC Viewer jar file
(either SSL enabled or regular one), then you will need to extract
the <code>classes</code> subdirectory from the source tarball and point <b>x11vnc</b>
to it via the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-httpdir"><code>-httpdir</code></a> option.
E.g.:
</p><pre>    x11vnc -httpdir /path/to/x11vnc-0.9.9/classes/ssl ...
</pre>
<p></p><p>&nbsp;</p>

<a name="faq-viewer-download"></a>
<a name="FAQ-6"></a>
<p><b>Q-6:</b>
<font color="#007f00">
Where can I get a VNC Viewer binary (or source code) for the Operating System
I will be viewing from?
</font>
</p>
<p>
To obtain VNC viewers for the viewing side (Windows, Mac OS, or Unix) try here:
</p><ul>
	<li><a href="http://web.archive.org/web/20210304200604/http://www.tightvnc.com/download.html">http://www.tightvnc.com/download.html</a>
	</li><li><a href="http://web.archive.org/web/20210304200604/http://www.realvnc.com/products/free/4.1/download.html">http://www.realvnc.com/download-free.html</a>
	</li><li><a href="http://web.archive.org/web/20210304200604/http://sourceforge.net/projects/cotvnc/">http://sourceforge.net/projects/cotvnc/</a>
	</li><li><a href="http://web.archive.org/web/20210304200604/http://www.ultravnc.com/">http://www.ultravnc.com/</a>
	</li><li><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Our Enhanced TightVNC Viewer (SSVNC)</a>
        <br>&nbsp;
	<br><img src="./x11vnc_files/ssvnc.gif">
</li></ul>
<p></p><p>&nbsp;</p>

<a name="faq-cmdline-opts"></a>
<a name="FAQ-7"></a>
<p><b>Q-7:</b>
<font color="#007f00">
How can I see all of <b>x11vnc</b>'s command line options and
documentation on how to use them?
</font>
</p>
<p>
Run:&nbsp;&nbsp;<code>x11vnc -opts</code>&nbsp;&nbsp;
to list just the option names or
run:&nbsp;&nbsp;<code>x11vnc -help</code>&nbsp;&nbsp;
for long descriptions about each option.
The output is listed <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html">here</a> as well.
Yes, <b>x11vnc</b> does have a lot of options, doesn't it...
</p><p>&nbsp;</p>

<a name="faq-config-file"></a>
<a name="FAQ-8"></a>
<p><b>Q-8:</b>
<font color="#007f00">
I don't like typing arcane command line options every time I start
<b>x11vnc</b>.  What can I do?  Is there a config file?  Or a GUI?
</font>
</p>
<p>
You could create a shell script that calls <b>x11vnc</b> with your options:
</p><pre>#!/bin/sh
#
# filename: X11vnc  (i.e. not "x11vnc")
# It resides in a directory in $PATH. "chmod 755 X11vnc" has been run on it.
#
x11vnc -wait 50 -localhost -rfbauth $HOME/.vnc/passwd -display :0 $*
</pre>
a similar thing can be done via aliases in your shell (bash, tcsh, csh, etc..)
<p></p><p>
Or as of Jun/2004 you
can use the simple <code>$HOME/.x11vncrc</code> config file support.
If that file exists, each line is taken as a command line option.  E.g.
the above would be:
</p><pre># this is a comment in my ~/.x11vncrc file
wait 50        # this is a comment to the end of the line.
-localhost     # note: the leading "-" is optional.
rfbauth  /home/fred/.vnc/passwd
display :0
</pre>
<p></p><p>
As of Dec/2004 there is now a simple
Tcl/Tk GUI based on the remote-control functionality ("<code>-R</code>")
that was added.  The <code>/usr/bin/wish</code> program is needed for operation.
The gui is not particularly user-friendly, it just provides a point and
click mode to set all the many <b>x11vnc</b> parameters  and obtain
help on them.  It is also very useful for testing.  See the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-gui"><code>-gui</code></a> option for more info.  Examples:
"<code>x11vnc ... -gui</code>" and "<code>x11vnc ... -gui other:0</code>"
in the latter case the gui is displayed on <code>other:0</code>, <em>not</em>
the X display <b>x11vnc</b> is polling. 
There is also a "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-gui-tray"><code>-gui tray</code></a>"
system tray mode.
</p><p>
<img src="./x11vnc_files/tkx11vnc.gif">
</p><p>
NOTE: You may need to install the "wish" or "tk" or "tk8.4" package for
the gui mode to work (the package name depends on your OS/distro.)  The
tcl/tk "<code>wish</code>" interpreter is used.  In
debian (and so ubuntu too) one would run "<code>apt-get install tk</code>"
or perhaps "<code>apt-get install tk8.4</code>" </p><p>&nbsp;</p>

<a name="faq-gui-tray"></a>
<a name="FAQ-9"></a>
<p><b>Q-9:</b>
<font color="#007f00">
How can I get the GUI to run in the System Tray, or at least be a smaller,
simpler icon?
</font>
</p>
<p>
As of Jul/2005 the gui can run in 
a more friendly small icon mode "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-gui"><code>-gui icon</code></a>" or in the
system tray: "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-gui"><code>-gui tray</code></a>".  It has balloon status, a simple menu,
and a Properities dialog.  The full, complicated, gui is only available under "Advanced".
Other improvements were added as well.  Try "Misc -&gt; simple_gui" for
a gui with fewer esoteric menu items.
</p><p>
If the gui fails to embed itself in the system
tray, do a retry via "Window View -&gt; icon"
followed by "Window View -&gt; tray" with the popup menu.
</p><p>
For inexperienced users starting up <b>x11vnc</b> and the GUI while
sitting at the physical X display (not remotely), using 
something like "<code>x11vnc -display :0 -gui tray=setpass</code>"
might be something for them that they are accustomed to in a Desktop
environment (it prompts for an initial password, etc.)
This is a basic "Share My Desktop" usage mode.
</p><p>
As of Nov/2008 in <b>x11vnc</b> 0.9.6 there is a desktop menu item
(x11vnc.desktop) that runs this command:
</p><pre>   x11vnc -gui tray=setpass -rfbport PROMPT -logfile %HOME/.x11vnc.log.%VNCDISPLAY
</pre>
which also prompts for which VNC port to use and a couple other parameters.
<p></p><p>
</p><p>&nbsp;</p>

<a name="faq-change-port"></a>
<a name="FAQ-10"></a>
<p><b>Q-10:</b>
<font color="#007f00">
How can I get <b>x11vnc</b> to listen on a different port
besides the default VNC port (5900)?
</font>
</p>
<p>
Use something like, e.g., "<code>x11vnc -rfbport 5901</code>"
to force it to use port 5901 (this is VNC display <code>:1</code>.)
If something else is using that port <b>x11vnc</b> will exit
immediately.  If you do not supply the <code>-rfbport</code>
option, it will autoprobe starting at 5900 and work its way up to 5999
looking for a free port to listen on.  In that case, watch for the
<code>PORT=59xx</code> line to see which port it found, then subtract
5900 from it for the VNC display number to enter into the VNC Viewer(s).
</p><p>
The "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-N"><code>-N</code></a>" option
will try to match the VNC display number to the X display
(e.g. X11 DISPLAY of :5 (port 6005) will have VNC display :5 (port 5905).)
</p><p>
Also see the "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-autoport"><code>-autoport n</code></a>" option
to indicated at which value the auto probing should start at.
</p><p>&nbsp;</p>

<a name="faq-selinux-perms"></a>
<a name="FAQ-11"></a>
<p><b>Q-11:</b>
<font color="#007f00">
Why do I get "<code>Failure autoprobing: Permission denied</code>"
when <b>x11vnc</b> tries to listen on a TCP port?
</font>
</p>
<p>
Perhaps your system is running SELINUX security and its default
rules deny listening on the VNC port (or similar port.)  We
often see this on Redhat E-Linux, Fedora, and Centos systems:
</p><pre>30/12/2011 05:48:25 Autoprobing TCP port
30/12/2011 05:48:25 Failure autoprobing: Permission denied
30/12/2011 05:48:25
30/12/2011 05:48:25 Xinerama is present and active (e.g. multi-head).
30/12/2011 05:48:25 fb read rate: 46 MB/sec
30/12/2011 05:48:25 Error: could not obtain listening port.
</pre>
The solution is to configure your SELINUX rules to allow this.
Or disable SELINUX if you don't need it.
<p></p><p>&nbsp;</p>

<a name="faq-firewalls"></a>
<a name="FAQ-12"></a>
<p><b>Q-12:</b>
<font color="#007f00">
My Firewall/Router doesn't allow VNC Viewers to connect to <b>x11vnc</b>.
</font>
</p>
<p>
See the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#firewalls">Firewalls/Routers discussion</a>.
</p><p>&nbsp;</p>

<a name="faq-firewall-out"></a>
<a name="FAQ-13"></a>
<p><b>Q-13:</b>
<font color="#007f00">
Is it possible for a VNC Viewer and a VNC Server to connect to each other
even though both are behind Firewalls that block all incoming connections?
</font>
</p>
<p>
This is very difficult or impossible to do unless a third machine, reachable
by both, is used as a relay.  So we assume a third machine is somehow
being used as a relay.
</p><p>
(<em>Update:</em> It may be possible to do "NAT-2-NAT" without a relay machine by
using a UDP tunnel such as <a href="http://web.archive.org/web/20210304200604/http://samy.pl/pwnat/">http://samy.pl/pwnat/</a>.
All that is required is that both NAT firewalls allow in UDP packets
from an IP address to which a UDP packet has recently been sent to.
If you try it out let us know how it went.)
</p><p>
In the following discussion, we will suppose port 5950 is being used on
the relay machine as the VNC port for the rendezvous.
</p><p>
A way to rendezvous is to have the VNC Server start a 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-reverse-connect"> reverse connection</a> to the relay machine:
</p><pre>   x11vnc -connect third-machine.net:5950 ...
</pre>
and the VNC viewer forward connects as usual:
<pre>   vncviewer third-machine.net:50
</pre>
Or maybe two ports would be involved, e.g. the viewer goes to display :51
(5951.)  It depends on the relay software being used.
<p></p><p>
What software to run on third-machine?  A TCP relay of some sort could
be used...  Try a google search on "tcp relay" or "ip relay".  However,
note that this isn't a simple redirection because it hooks up <em>two
incoming</em> connections.
You can look at our UltraVNC repeater implementation
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ultravnc_repeater.pl"><code>ultravnc_repeater.pl</code></a>
for ideas and possibly to customize.
</p><p>
Also, if you are not the admin of third-machine you'd have to convince
the owner to allow you to install this software (and he would likely
need to open his server's firewall to allow the port through.)
</p><p>
It is recommended that <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#ssl-tunnel">SSL</a> is used for
encryption (e.g.  "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl SAVE</code></a>")
when going over the internet.
</p><p>
We have a prototype for performing a rendezvous via a Web Server acting as
the relay machine.  Download the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/vncxfer">vncxfer CGI script</a>
and see the instructions at the top.
</p><p>
Once that CGI script is set up  on the website, both users go to, say,
<code>http://somesite.com/vncxfer</code> (or maybe a "<code>/cgi-bin</code>" directory
or "<code>.cgi</code>" suffix must be used.)  Previously, both have agreed
on the same session name (say by phone or email) , e.g. "5cows", and
put that into the entry form on the vncxfer starting page (hopefully
separated by a few seconds, so the relay helper can fully start up at the first request.)
</p><p>
The page returned tells them the hostname and port number and possible
command to use for forward (VNC Viewer) and reverse (VNC Server,
i.e. x11vnc) connections as described above.
</p><p>
Also since Oct/2007, <b>x11vnc</b> can connect directly (no web browser), like this:
</p><pre>   x11vnc ... -connect localhost:0 -proxy 'http://somesite.com/vncxfer?session=5cows&amp;'
</pre>
<p></p><p>
Unfortunately the prototype requires that the Web server's firewall allow in the port
(e.g. 5950) used for the rendezvous.  Most web servers are not configured to do
this, so you would need to ask the admin to do this for you.  Nearly all free webspace sites,
e.g. www.zendurl.com, will not allow your CGI script to be an open relay like this.
(If you find one that does allow this, let me know!)
</p><p>
Maybe someday a clever trick will be thought up to relax the listening port 
requirement (e.g. use HTTP/CGI itself for the transfer... it is difficult to
emulate a full-duplex TCP connection with them.)
</p><p>
See also the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#firewalls">Firewalls/Routers discussion</a>
and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-reverse-connect-proxy">Reverse Connection Proxy discussion</a>.
</p><p>
</p><p>&nbsp;</p>
<em><b>SSH method:</b></em>
If both users (i.e. one on Viewer-side and the other on <b>x11vnc</b> server side) have
SSH access to a common machine on the internet (or otherwise mutually reachable), then
SSH plumbing can be used to solve this problem.
The users create SSH tunnels going through the SSH login machine.
<p></p><p>
Instead of assuming port 5900 is free on the SSH machine, we will assume both users agreed
to use 5933. This will illustrate how to use a different port for the redir.  It could
be any port, what matters is that both parties refer to the same one.
</p><p>
Set up the Tunnel from the VNC Server side:
</p><pre>   ssh -t -R 5933:localhost:5900 user@third-machine.net
</pre>
Set up the Tunnel from the VNC Viewer side:
<pre>   ssh -t -L 5900:localhost:5933 user@third-machine.net
</pre>
<p></p><p>
Run Server on the VNC Server side:
</p><pre>   x11vnc -rfbport 5900 -localhost ...
</pre>
Run Viewer on the VNC Viewer side:
<pre>   vncviewer -encodings "copyrect tight zrle hextile" localhost:0
</pre>
(we assume the old-style <code>-encodings</code> option needs to be
used.  See <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#tunnelling">here</a> for details.)
<p></p><p>
If the SSH machine has been configured (see <code>sshd_config(5)</code>)
with the option <code>GatewayPorts=yes</code>, then the tunnel set up
by the VNC Server will be reachable directly by the VNC viewer
(as long as the SSH machine's firewall does not block the port, 5933 in this example.)  So in
that case the Viewer side does <em>not</em> need to run any <code>ssh</code>
command, but rather only runs:
</p><pre>   vncviewer third-machine.net:33
</pre>
In this case we recommend <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#ssl-tunnel">SSL</a> be used for encryption.
<p></p><p>
The creation of both tunnels can be automated.  As of Oct/2007 the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssh"><code>-ssh</code></a> x11vnc option is
available and so only this command needs to be run on the VNC Server side: 
</p><pre>   x11vnc -ssh user@third-machine.net:33 ...
</pre>
(the SSH passphrase may need to be supplied.)
<p></p><p>
To automate on the VNC Viewer side, the user 
can use the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a> by:
</p><ul>
	<li>Clicking on 'Use SSH'</li>
	<li>Entering <code>user@third-machine.net:33</code> into 'VNC Host:Display' entry box</li>
	<li>Clicking on 'Connect'</li>
</ul>
As above, if the SSH <code>GatewayPorts=yes</code> setting is configured the Viewer side
doesn't need to create a SSH tunnel.  In SSVNC the Viewer user could instead select
'Use SSL' and then, e.g., on the Server side supply "<code>-ssl SAVE</code>" to x11vnc.
Then end-to-end SSL encryption would be used (in addition to the SSH encryption on the
Server-side leg.)
<p></p><p>&nbsp;</p>

<a name="faq-quiet-bg"></a>
<a name="FAQ-14"></a>
<p><b>Q-14:</b>
<font color="#007f00">
Can I make <b>x11vnc</b> more quiet and also go into the background
after starting up?
</font>
</p>
<p>
Use the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-q,"><code>-q</code></a> and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-bg"><code>-bg</code></a> options, respectively.
&nbsp;(also: <code>-quiet</code> is an alias for <code>-q</code>)
</p><p>
Note that under <code>-bg</code> the stderr messages will be lost
unless you use the 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-o"><code>-o logfile</code></a>" option.
</p><p>&nbsp;</p>

<a name="faq-sigpipe"></a>
<a name="FAQ-15"></a>
<p><b>Q-15:</b>
<font color="#007f00">
Sometimes when a VNC viewer dies abruptly, <b>x11vnc</b> also dies with
the error message like: "<code>Broken pipe</code>".  I'm using the <code>-forever</code>
mode and I want <b>x11vnc</b> to keep running. 
</font>
</p>
<p>
As of Jan/2004 the <code>SIGPIPE</code>
signal is ignored.  So if a viewer client terminates abruptly, <b>libvncserver</b>
will notice on the next I/O operation and will close the connection and
continue on.
</p><p>
Up until of Apr/2004 the above fix only works for BSD signal systems
(Linux, FreeBSD, ...)  For SYSV systems there is a workaround in 
place since about Jun/2004.
</p><p>&nbsp;</p>

<a name="faq-tight139"></a>
<a name="FAQ-16"></a>
<p><b>Q-16:</b>
<font color="#007f00">
The Windows TightVNC 1.3.9 Viewer cannot connect to <b>x11vnc</b>.
</font>
</p>
<p>
This appears to be fixed in <b>x11vnc</b> version 0.9 and later.
If you need to use an earlier version of <b>x11vnc</b>, try using
the "<code>-rfbversion 3.7</code>" option.
In general sometimes one can get a misbehaving viewer to work
by supplying rfb versions 3.7 or 3.3.
</p><p>&nbsp;</p>

<a name="faq-krdcprob"></a>
<a name="FAQ-17"></a>
<p><b>Q-17:</b>
<font color="#007f00">
KDE's krdc VNC viewer cannot connect to <b>x11vnc</b>.
</font>
</p>
<p>
This has been fixed in <b>x11vnc</b> version 0.8.4.  More info
<a href="http://web.archive.org/web/20210304200604/http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=389750">here</a>,
<a href="http://web.archive.org/web/20210304200604/http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=399408">here</a>,
and <a href="http://web.archive.org/web/20210304200604/http://bugs.kde.org/show_bug.cgi?id=136924">here</a>.
</p><p>&nbsp;</p>

<a name="faq-tru64-crash"></a>
<a name="FAQ-18"></a>
<p><b>Q-18:</b>
<font color="#007f00">
When I start <b>x11vnc</b> on an Alpha Tru64 workstation the X server crashes!
</font>
</p>
<p>
This is a bug in the X server obviously; an X client should
never be able to crash it.
</p><p>
The problem seems to be with
the RECORD X extension and so a workaround is to use the "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noxrecord"><code>-noxrecord</code></a>"
<b>x11vnc</b> command line option.
</p><p>&nbsp;</p>

<a name="faq-aix-freeze"></a>
<a name="FAQ-19"></a>
<p><b>Q-19:</b>
<font color="#007f00">
When running <b>x11vnc</b> on an IBM AIX workstation after a few
minutes the VNC connection freezes.
</font>
</p>
<p>
One user reports when running <b>x11vnc</b> on AIX 5.3 in his
CDE session after a few minutes or seconds <b>x11vnc</b> will
"freeze" (no more updates being sent, etc.)
The freezing appeared to be worse for versions later than 0.9.2.
</p><p>
The problem seems to be with
the RECORD X extension on AIX and so a workaround is to use the "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noxrecord"><code>-noxrecord</code></a>"
<b>x11vnc</b> command line option.  The user found no freezes
occurred when using that option.
</p><p>&nbsp;</p>

<a name="faq-build-customizations"></a>
<a name="FAQ-20"></a>
<p><b>Q-20:</b>
<font color="#007f00">
Are there any build-time customizations possible, e.g. change defaults,
create a smaller binary, etc?
</font>
</p>
<p>
There are some options.
They are enabled by adding something like <code>-Dxxxx=1</code>
to the <code>CPPFLAGS</code> environment variable before running
<code>configure</code> (see the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#solarisbuilding">build notes</a>
for general background.)
</p><pre>/*
 * Mar/2006
 * Build-time customization via CPPFLAGS.
 *
 * Summary of options to include in CPPFLAGS for custom builds:
 *
 * -DVNCSHARED  to have the vnc display shared by default.
 * -DFOREVER  to have -forever on by default.
 * -DNOREPEAT=0  to have -repeat on by default.
 * -DADDKEYSYMS=0  to have -noadd_keysyms the default.
 *
 * -DREMOTE_DEFAULT=0  to disable remote-control on by default (-yesremote.)
 * -DREMOTE_CONTROL=0  to disable remote-control mechanism completely.
 * -DEXTERNAL_COMMANDS=0  to disable the running of all external commands.
 * -DFILEXFER=0  disable filexfer.
 *
 * -DHARDWIRE_PASSWD=...      hardwired passwords, quoting necessary.
 * -DHARDWIRE_VIEWPASSWD=...
 * -DNOPW=1                   make -nopw the default (skip warning)
 * -DUSEPW=1                  make -usepw the default
 * -DPASSWD_REQUIRED=1        exit unless a password is supplied.
 * -DPASSWD_UNLESS_NOPW=1     exit unless a password is supplied and no -nopw.
 *
 * -DWIREFRAME=0  to have -nowireframe as the default.
 * -DWIREFRAME_COPYRECT=0  to have -nowirecopyrect as the default.
 * -DWIREFRAME_PARMS=...   set default -wirecopyrect parameters.
 * -DSCROLL_COPYRECT=0     to have -noscrollcopyrect as the default.
 * -DSCROLL_COPYRECT_PARMS=...  set default -scrollcopyrect parameters.
 * -DSCALING_COPYRECT=0
 * -DXDAMAGE=0    to have -noxdamage as the default.
 * -DSKIPDUPS=0   to have -noskip_dups as the default or vice versa.
 *
 * -DPOINTER_MODE_DEFAULT={0,1,2,3,4}  set default -pointer_mode.
 * -DBOLDLY_CLOSE_DISPLAY=0  to not close X DISPLAY under -rawfb.
 * -DSMALL_FOOTPRINT=1  for smaller binary size (no help, no gui, etc) 
 *                      use 2 or 3 for even smaller footprint.
 * -DNOGUI  do not include the gui tkx11vnc.
 * -DPOLL_8TO24_DELAY=N  
 * -DDEBUG_XEVENTS=1  enable printout for X events.
 *
 * Set these in CPPFLAGS before running configure. E.g.:
 *
 *   % env CPPFLAGS="-DFOREVER -DREMOTE_CONTROL=0" ./configure
 *   % make
 */
</pre>
If other things (e.g. "<code>-I ...</code>") are needed in <code>CPPFLAGS</code> 
add them as well.  
<p></p><p>
On some systems is seems you need to set <code>LC_ALL=C</code>
for configure to work properly...
</p><p>
Be careful the following two variables: <code>HARDWIRE_PASSWD</code>
and <code>HARDWIRE_VIEWPASSWD</code>.  If set (remember to include
the double quotes around the string), they will be used as default values
for the <code>-passwd</code> and <code>-viewpasswd</code> options.
Of course the strings will exist unobscured in the <b>x11vnc</b> binary: it
better not be readable by unintendeds.  Perhaps this is of use
in remote access for an embedded application, etc...
</p><p>
Let us know if more build-time customizations would be useful.
</p><p>

&nbsp;<br><font size="-0"><b>[Win2VNC Related]</b></font><br>
<a name="faq-win2vnc"></a>
<a name="FAQ-21"></a>
</p><p><b>Q-21:</b>
<font color="#007f00">
I have two separate machine displays in front of me, one Windows the
other X11: can I use <b>x11vnc</b> in combination with Win2VNC
in dual-screen mode to pass the keystrokes and mouse motions to the X11 display?
</font>
</p>
<p>
Yes, for best response start up <b>x11vnc</b> with the 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nofb"><code>-nofb</code></a>" option
(disables framebuffer polling, and does other optimizations)
on the secondary display (X11) machine.
Then start up <b>Win2VNC</b> on the primary display (Windows)
referring it to the secondary display.
</p><p>
This will also work X11 to X11 using
<a href="http://web.archive.org/web/20210304200604/http://fredrik.hubbe.net/x2vnc.html">x2vnc</a>,
however you would probably just want to avoid VNC and use <b>x2x</b> for that. 
</p><p>
For reference, here are some links to Win2VNC-like programs for
multiple monitor setups:
</p><ul>
<li><a href="http://web.archive.org/web/20210304200604/http://www.hubbe.net/~hubbe/win2vnc.html">Original Win2VNC</a></li>
<li><a href="http://web.archive.org/web/20210304200604/http://www.deboer.gmxhome.de/">Enhanced Win2VNC</a> (broken?) and <a href="http://web.archive.org/web/20210304200604/http://sourceforge.net/projects/win2vnc/">sourceforge link</a></li>
<li><a href="http://web.archive.org/web/20210304200604/http://fredrik.hubbe.net/x2vnc.html">x2vnc</a></li>
<li><a href="http://web.archive.org/web/20210304200604/http://freshmeat.net/projects/x2x/">x2x</a></li>
<li><a href="http://web.archive.org/web/20210304200604/http://zapek.com/?page_id=26">zvnc</a> (MorphOS)</li>
</ul>
All of them will work with <b>x11vnc</b> (except <b>x2x</b> where it is
not needed.)
<p></p><p>&nbsp;</p>

<a name="faq-win2vnc-8bpp"></a>
<a name="FAQ-22"></a>
<p><b>Q-22:</b>
<font color="#007f00">
I am running <b>Win2VNC</b> on my Windows machine and 
"<code>x11vnc -nofb</code>" on Unix to pass keyboard and
mouse to the Unix monitor.
Whenever I start <b>Win2VNC</b> it
quickly disconnects and <b>x11vnc</b> says:
<code>rfbProcessClientNormalMessage: read: Connection reset by peer</code>
</font>
</p>
<p>
Is the default visual of the X display you run <b>x11vnc</b> on low
color (e.g. 8 bit per pixel PseudoColor)? (you can run
<code>xdpyinfo</code> to check, look in the "screen" section.)
There seems to be a bug in <b>Win2VNC</b> in that it cannot deal
correctly with colormaps (PseudoColor is the most common example of a
visual with a colormap.)
</p>
<p>If so, there are a couple options.  <b>1)</b> Can you set the
default visual on your display to be depth 24 TrueColor?  Sun machines
often have 8+24 overlay/multi-depth visuals, and you can make the
default visual depth 24 TrueColor (see <code>fbconfig(1)</code> and
<code>Xsun(1)</code>.)  <b>2)</b> As of Feb/2004 <b>x11vnc</b> has the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-visual"><code>-visual</code></a> option to allow you to <b><em>force</em></b> the
framebuffer visual to whatever you want (this usually messes up the
colors unless you are very clever.)  In this case, the option provides a
convenient workaround for the <b>Win2VNC</b> bug:
</p><pre>  x11vnc -nofb -visual TrueColor -display :0 ...
</pre>
So the visual will be set to 8bpp TrueColor and <b>Win2VNC</b> can
handle this.  Since <b>Win2VNC</b> does not use the framebuffer
data there should be no problems in doing this.
<p></p>

<a name="faq-macosx-nofb"></a>
<a name="FAQ-23"></a>
<p><b>Q-23:</b>
<font color="#007f00">
Can I run "<code>x11vnc -nofb</code>" on a Mac OS X machine to
redirect mouse and keyboard input to it from Windows and X11 machines
via <b>Win2VNC</b> and <b>x2vnc</b>, respectively?
</font>
</p>
<p>
Yes, as of Nov/2006 <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-macosx">you can</a>.
There may be a trick or two you'll need to do to get the Clipboard
exchange between the machines to work.
</p><p>&nbsp;</p>

&nbsp;<br><font size="-0"><b>[Color Issues]</b></font><br>
<a name="faq-8bpp"></a>
<a name="FAQ-24"></a>
<p><b>Q-24:</b>
<font color="#007f00">
The X display I run <b>x11vnc</b> on is only 8 bits per pixel (bpp)
PseudoColor (i.e. only 256 distinct colors.)  The <b>x11vnc</b> colors may
start out OK, but after a while they are incorrect in certain windows.
</font>
</p>
<p>
Use the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-flashcmap"><code>-flashcmap</code></a> option to have <b>x11vnc</b> watch for
changes in the colormap, and propagate those changes back to connected
clients.  This can be slow (since the whole screen must be updated over
the network whenever the colormap changes.)
This flashing colormap behavior often happens if an application
installs its own private colormap when the mouse is in its window.
"<code>netscape -install</code>" is a well-known historical example of
this.  Consider reconfiguring the system to 16 bpp or depth 24 TrueColor
if at all possible.
</p><p>
Also note the option 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-8to24"><code>-8to24</code></a> 
(Jan/2006) can often remove the need for flashing the colormap.
Everything is dynamically transformed to depth 24 at 32 bpp using the
colormaps.  There may be painting errors however (see the following FAQ
for tips on reducing and correcting them.)
</p><p>
In some rare cases (SCO unixware) the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-notruecolor"><code>-notruecolor</code></a> option
has corrected colors on 8bpp displays.  The red, green, and blue masks
were non-zero in 8bpp PseudoColor on an obscure setup, and this option
corrected the problems.
</p><p>&nbsp;</p>

<a name="faq-overlays"></a>
<a name="FAQ-25"></a>
<p><b>Q-25:</b>
<font color="#007f00">
Color problems: Why are the colors for some windows incorrect in
<b>x11vnc</b>?  BTW, my X display has nice
overlay/multi-depth visuals of different color depths: e.g. there are
both depth 8 and 24 visuals available at the same time.
</font>
</p>
<p>
You may want to review the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-8bpp">previous question</a>
regarding 8 bpp PseudoColor.
</p><p>
On some hardware (Sun/SPARC and SGI), the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-overlay"><code>-overlay</code></a> option
discussed a couple paragraphs down may solve this for you (you may
want to skip to it directly.)  On other hardware the less robust
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-8to24"><code>-8to24</code></a> option
may help (also discussed below.)
</p><p>
Run <code>xdpyinfo(1)</code> to see what the
default visual is and what the depths of the other visuals are.  Does
the default visual have a depth of 8 but there are other visuals of
depth 24?  If it does, can you possibly re-configure your X server to
make a depth 24 visual the default?  If you can do it, this will save
you a lot of grief WRT colors and
<b>x11vnc</b> (and for general usage too!) Here is how I do this on an
old Sparcstation 20 running Solaris 9 with SX graphics
</p><pre>  xinit -- -dev /dev/fb defclass TrueColor defdepth 24
</pre>
and it works nicely (note: to log into console from the dtlogin window,
select "Options -&gt; Command Line Login", then login and enter the
above command.)  See the <code>-dev</code> section of the <code>Xsun(1)</code>
manpage for a description of the above arguments.  If you have root
permission, a more permanent and convenient thing to do is to record
the arguments in a line like:
<pre>  :0  Local local_uid@console root /usr/openwin/bin/Xsun -dev /dev/fb defclass TrueColor defdepth 24
</pre>
in <code>/etc/dt/config/Xservers</code>  (copy <code>/usr/dt/config/Xservers</code>.)
Also look at the <code>fbconfig(1)</code> and related manpages
(e.g. <code>ffbconfig, m64config, pgxconfig, SUNWjfb_config, etc ...</code>) for
hardware framebuffer settings that may achieve the same effect.
<p></p><p>
In general for non-Sun machines, look at the "<code>-cc class</code>"
and related options in your X server manpage (perhaps
<code>Xserver(1)</code>), it may allow modifying the default visual
(e.g. "<code>-cc 4</code>",
see <code>&lt;X11/X.h&gt;</code> for the visual class numbers.)
On XFree86 some video card drivers (e.g. Matrox <code>mga</code>)
have settings like <code>Option "Overlay" "24,8"</code> to support
multi-depth overlays.  For these, use the "<code>-cc 4</code>" X server
command line option to get a depth 24 default visual.
</p><p>
&nbsp;<br>
<a name="infaq_the-overlay-mode"></a>
<b><em>The <code>-overlay</code> mode:</em></b>
Another option is if the system with overlay visuals is a Sun system
running Solaris or SGI running IRIX you can use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-overlay"><code>-overlay</code></a> <b>x11vnc</b>
option (Aug/2004) to have
<b>x11vnc</b> use the Solaris <code>XReadScreen(3X11)</code> function
to poll the "true view" of the whole screen at depth 24 TrueColor.
<code>XReadDisplay(3X11)</code> is used on IRIX.  This is useful for
Legacy applications (older versions of Cadence CAD apps are mentioned
by <b>x11vnc</b> users) that require the default depth be 8bpp, or the
app will use a 8bpp visual even if depth 24 visuals are available, and
so the default depth workaround described in the previous paragraph is
not sufficient for these apps.
</p><p>
It seems that Xorg is working toward supporting <code>XReadDisplay(3X11)</code>
as part of the RENDER extension work.  When it does support it and provides
a library API <b>x11vnc</b> will be modified to take advantage of the
feature to support <code>-overlay</code> on Linux, *BSD, etc.
Until then see the <code>-8to24</code> mode below.
</p><p>
<em>Misc. notes on <code>-overlay</code> mode:</em> An amusing
by-product of <code>-overlay</code> mode is that the mouse cursor shape is
correct!  (i.e. XFIXES is not needed.)  The <code>-overlay</code> mode may be somewhat slower than
normal mode due to the extra framebuffer manipulations that must be
performed.  Also, on Solaris there is a bug in that for some popup
menus, the windows they overlap will have painting errors (flashing colors)
while the popup is up (a workaround is
to disable SaveUnders by passing <code>-su</code> to <code>Xsun</code>,
e.g. in your <code>/etc/dt/config/Xservers</code> file.)
</p><p>
&nbsp;<br>
<a name="infaq_the-8to24-mode"></a>
<b><em>The <code>-8to24</code> mode:</em></b>
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-8to24"><code>-8to24</code></a> <b>x11vnc</b>
option (Jan/2006) is a kludge to try to dynamically rewrite the pixel
values so that the 8bpp part of the screen is mapped onto depth 24 TrueColor.
This is less robust than the <code>-overlay</code> mode because it is
done by <b>x11vnc</b> outside of the X server.  So only use it on OS's
that do not support <code>-overlay</code>.  The <code>-8to24</code>
mode will work if the default visual is depth 24 or depth 8.  It
scans for any windows within 3 levels of the root window that are 8bpp
(i.e. legacy application), or in general ones that are not using the
default visual.  For the windows it finds it uses <code>XGetSubImage()</code>
to retrieve the pixels values and uses the correct indexed colormap to
create a depth 24 TrueColor view of the whole screen.  This depth 24, 32bpp
view is exported via VNC.
</p><p>
Even on pure 8bpp displays it can be used as an alternative to
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-flashcmap"><code>-flashcmap</code></a>
to avoid color flashing completely.
</p><p>
This scheme is approximate and can often lead to painting errors.
You can manually correct most painting errors by pressing 3 
<code>Alt_L</code>'s in a row, or by using something like:
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-fixscreen"><code>-fixscreen V=3.0</code></a>
to automatically refresh the screen every 3 seconds.
Also <code>-fixscreen 8=3.0</code> has been added to just refresh
the non-default visual parts of the screen.
</p><p>
In general the scheme uses many resources and may give rise to sluggish
behavior.  If multiple windows are using different 8bpp indexed colormaps
all but one window may need to be iconified for the colors to be correct.
There are a number of tunable parameters to try to adjust performance
and painting accuracy.  The option <code>-8to24 nogetimage</code>
can give a nice speedup if the default depth 24 X server supports 
hiding the 8bpp bits in bits 25-32 of the framebuffer data.
On very slow machines <code>-8to24 poll=0.2,cachewin=5.0</code>
gives an useful speedup.
See the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-8to24"><code>-8to24</code></a>
help description for information on tunable parameters, etc.
</p><p>
&nbsp;<br>
Colors still not working correctly?  Run <code>xwininfo</code> on the
application with the
incorrect colors to verify that the depth of its visual is different
from the default visual depth (gotten from <code>xdpyinfo</code>.)
One possible workaround in this case is to use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-id"><code>-id</code></a> option to point <b>x11vnc</b>
at the application window itself.  If the application is complicated
(lots of toplevel windows and popup menus) this may not be acceptable,
and may even crash <b>x11vnc</b> (but not the application.)
See also <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-appshare"><code>-appshare</code></a>.
</p><p>
It is theoretically possible to solve this problem in general (see
<code>xwd(1)</code> for example), but it does not seem trivial or
sufficiently fast for <b>x11vnc</b> to be able to do so in real time.
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-8to24"><code>-8to24</code></a> method
does this approximately and is somewhat usable.
Fortunately the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-overlay"><code>-overlay</code></a> option
works for Solaris machines
with overlay visuals where most of this problem occurs.
</p><p>&nbsp;</p>

<a name="faq-directcolor"></a>
<a name="FAQ-26"></a>
<p><b>Q-26:</b>
<font color="#007f00">
I am on a high color system (depth &#8805; 24) but I seem to have colormap
problems.  They either flash or everything is very dark.
</font>
</p>
<p>
This can happen if the default Visual (use <code>xdpyinfo</code> to list them)
is DirectColor instead of TrueColor.  These are both usually used in high
color modes, but whereas TrueColor uses static ramps for the Red, Green, and
Blue components, DirectColor has arbitrary colormaps for the Red, Green,
and Blue Components.  Currently <b>x11vnc</b> cannot decode these colormaps
and treats them just like TrueColor.
</p><p>
The only workaround so far is to restart the X server with the "<code>-cc 4</code>" 
option to force TrueColor as the default visual (DirectColor is "<code>-cc 5</code>";
see <code>/usr/include/X11/X.h</code>.)  The only place we have seen this is with
the virtual framebuffer server <code>Xvfb</code> on Xorg 7.2.  So in that case you
probably should restart it with something like this: "<code>Xvfb :1 -cc 4 -screen 0 1280x1024x24</code>".
It should be possible for <b>x11vnc</b> to handle DirectColor, but this hasn't
been implemented due to its rare usage.
</p><p>
You may also see this problem on an X display with a TrueColor default visual
where an application chooses a DirectColor visual for its window(s). It 
seems the application also needs to install its own colormap for the visual
for the colors to be messed up in <b>x11vnc</b>.  One can make <code>xwud</code>
do this for example.
</p><p>&nbsp;</p>

<a name="faq-windowid"></a>
<a name="FAQ-27"></a>
<p><b>Q-27:</b>
<font color="#007f00">
How do I figure out the window id to supply to the
<code>-id windowid</code> option?
</font>
</p>
<p>
Run the <code>xwininfo</code> program in a terminal.  It will ask you to
click on the desired application window.  After clicking, it will print
out much information, including the window id (e.g. <code>0x6000010</code>.)  Also, the visual and depth
of the window printed out is often useful in debugging <b>x11vnc</b> 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-overlays">color problems</a>.
</p><p>
Also, as of Dec/2004 you can use
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-id"><code>-id pick</code></a>"
to have <b>x11vnc</b> run <code>xwininfo(1)</code>
for you and after you click the window it extracts the windowid.  Besides
"<code>pick</code>" there is also "<code>id:root</code>" to allow you
to go back to root window when doing remote-control.
</p><p>&nbsp;</p>

<a name="faq-transients-id"></a>
<a name="FAQ-28"></a>
<p><b>Q-28:</b>
<font color="#007f00">
Why don't menus or other transient windows come up when I am using
the <code>-id windowid</code> option to view a single application window?
</font>
</p>
<p>
This is related to the behavior of the <code>XGetImage(3X11)</code>
and <code>XShmGetImage()</code> interfaces regarding backingstore, saveunders,
etc.  The way the image is retrieved depends on some aspects of how
the X server maintains the display image data and whether other windows
are clipping or obscuring it.  See the <code>XGetImage(3X11)</code>
man page for more details.  If you disable BackingStore and SaveUnders
in the X server you should be able to see these transient windows.
</p><p>
If things are not working and you still want to do the single window
polling, try the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-sid"><code>-sid windowid</code></a>
option ("shifted" windowid.)
</p><p>
<em><b>Update</b>:</em> as of Nov/2009 in the 0.9.9 <b>x11vnc</b> development tarball,
there is an experimental Application Sharing mode that improves
upon the <code>-id/-sid</code> single window sharing: 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-appshare"><code>-appshare</code></a>
(run "<code>x11vnc -appshare -help</code>" for more info.)
It is still very primitive and approximate, but at least it displays
multiple top-level windows.
</p><p>&nbsp;</p>

<a name="faq-24bpp"></a>
<a name="FAQ-29"></a>
<p><b>Q-29:</b>
<font color="#007f00">
My X display is depth 24 at 24bpp (instead of the normal depth 24 at 32bpp.)
I'm having lots of color and visual problems with <b>x11vnc</b>
and/or <b>vncviewer</b>.  What's up?
</font>
</p>
<p>
First off, depth 24 at 24bpp (bpp=bits-per-pixel) is fairly uncommon
and can cause problems in general.  It also can be slower than depth 24
at 32bpp.  You might want to switch to 32bpp (for XFree86 see the
"<code>-fbbpp 32</code>", <code>DefaultFbBpp</code>, <code>FbBpp</code>
and related options.)  Perhaps you have 24bpp
because the video memory of the machine is low and the screen wouldn't
fit in video RAM at 32bpp.  For this case depth 16 at 16bpp might be an
acceptable option.  Recently (2012) it seems that some Xen virtual
system setups have the X server running at 24bpp.  You should reconfigure
it to use 32bpp or 16bpp.
</p><p></p>
In any event <b>x11vnc</b> should handle depth 24 at 24bpp (although
performance may be slower, and you may need to use the ZRLE encoding
instead of Tight.)  There are some caveats involving the viewer
however:
<p></p>
The RealVNC Unix viewer cannot handle 24bpp from the server, it will say:
"<code>main:  setPF: not 8, 16 or 32 bpp?</code>" and exit.
I have not checked the RealVNC Windows viewer.
<p></p>
So you need to use the TightVNC Unix viewer.  However there are some
problems with that too.  It seems <code>libvncserver</code> does not
do 24bpp correctly with the Tight encoding.  The colors and screen ultimately
get messed up.  So you have to use a
different encoding with the TightVNC <b>vncviewer</b>, try "zlib",
"hextile", or one of the other encodings 
(e.g. <code>vncviewer -encodings "zlib hextile" ...</code>.)
I have not checked the TightVNC or UltraVNC Windows viewers.
<p></p>
It appears the older RealVNC Unix viewers (e.g. 3.3.3 and 3.3.7) 
can handle 24bpp from the server, so you may want to use those.
They evidently request 32 bpp and <code>libvncserver</code> obliges.
<p></p>
<em><b>Update</b>:</em> as of Apr/2006 you can use the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-24to32"><code>-24to32</code></a>
option to have <b>x11vnc</b> dynamically transform the 24bpp pixel data
to 32bpp.  This extra transformation could slow things down further however.
<p></p>
Now coming the opposite direction if you are running the <b><i>vncviewer</i></b>
on the 24bpp display, TightVNC will fail with 
"<code>Can't cope with 24 bits-per-pixel.  Sorry.</code>"
and RealVNC will fail with
"<code>main:  Error: couldn't find suitable pixmap format</code>"
so evidently you cannot use 24bpp for the vncviewers to work
on that X display.
<p></p>
Note, however, that the Unix viewer in the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a> project
<em>can</em> handle local 24bpp X displays.  It does this by requesting a
16bpp pixel format (or 8bpp if the -bgr233 option has been supplied)
from the VNC server, and translates that to 24bpp locally.
<p></p>
SSVNC can also handle 24bpp remote displays if the VNC server is x11vnc.
<p></p>

&nbsp;<br><font size="-0"><b>[Xterminals]</b></font><br>
<a name="faq-noshm"></a>
<a name="FAQ-30"></a>
<p><b>Q-30:</b>
<font color="#007f00">
Can I use <b>x11vnc</b> to view and interact with an Xterminal (e.g. NCD)
that is not running UNIX and so <b>x11vnc</b> cannot be run on it directly?
</font>
</p>
<p>
You can, but it will likely be very wasteful of network bandwidth since
you will be <em>polling the X display over the network</em> as opposed to
over the local hardware.  To do this, run <b>x11vnc</b> on a UNIX machine as close
as possible network-wise (e.g. same switch) to the Xterminal machine.  Use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-display"><code>-display</code></a> option
to point the display to that of the Xterminal
(you'll of course need basic X11 permission to do that) and finally supply the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noshm"><code>-noshm</code></a> option (this enables the polling over the network.)
</p><p>
If the Xterminal's X display is open to the network for connections, you might
use something like "<code>-display xterm123:0</code>".  If you are trying to
do this via an SSH tunnel (assuming you can actually ssh into the Xterminal)
it will be a little tricky (either use the ssh "<code>-R</code>" option
or consider ssh-ing in the other direction.)  In all cases the X11 permissions
need to allow the connection.
</p><p>
The response will likely be sluggish (maybe only one "frame" per second.)
This mode is not recommended except for "quick checks" of hard to get to
X servers.  Use something like "<code>-wait 150</code>" to cut down on 
the polling rate.  You may also need 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-flipbyteorder"><code>-flipbyteorder</code></a>
if the colors get messed up due to endian byte order differences.
</p>

<a name="faq-xterminal-xauth"></a>
<a name="FAQ-31"></a>
<p><b>Q-31:</b>
<font color="#007f00">
How do I get my X permissions (MIT-MAGIC-COOKIE file) correct for a 
Unix/Linux machine acting as an Xterminal?
</font>
</p>
<p>
If the X display machine is a traditional Xterminal (where the X server process
runs on the Xterminal box, but all of the X client applications (firefox, etc)
run on a central server (aka "terminal server")), you will need
to <em>log into</em> the Xterminal machine (i.e. get a
shell running there) and then start the <b>x11vnc</b> program.  If the Xterminal
Linux/Unix machine is stripped down (e.g. no users besides root) that
may be difficult.
</p><p>
The next problem is the login Display Manager (e.g. gdm, kdm), and hence
the MIT-MAGIC-COOKIE auth files, are on the central server and not on
the Xterminal box where the X server and <b>x11vnc</b> processes are.
</p><p>
So unless X permissions are completely turned off (e.g. "<code>xhost +</code>"),
to run the <b>x11vnc</b> process on the Xterminal box
the MIT-MAGIC-COOKIE auth file data (<code>XAUTHORITY</code>
or <code>$HOME/.Xauthority</code>) must be accessible by or copied to
the Xterminal.  If <code>$HOME/.Xauthority</code> is
exported via NFS (this is insecure of course, but has been going on for
decades), then <b>x11vnc</b> can simply pick it up via NFS (you may need
to use the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-auth"><code>-auth</code></a> option
to point to the correct file.)  Other options include copying
the auth file using <code>scp</code>, or something like:
</p><pre>  central-server&gt;  xauth nextract - xterm123:0 | ssh xterm123 xauth nmerge -
</pre>
and then, say, ssh from central-server to xterm123 to start <b>x11vnc</b>.
Here "xterm123" refers to the computer acting as the Xterminal
and "central-server" is the terminal server.
You can use "<code>xauth -f /path/to/cookie-file list</code>" to examine
the contents of the cookie(s) in a file "<code>/path/to/cookie-file</code>".
See the <code>xauth(1)</code> manpage for more details.
<p></p><p>
If the display <em>name</em> in the cookie file needs to be changed
between the two hosts, see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_xauth_pain">this note</a> on the
"<code>xauth add ...</code>" command.
</p><p>
A less secure option is to run something like 
"<code>xhost +127.0.0.1</code>" while sitting at the Xterminal box to
allow cookie-free local access for <b>x11vnc</b>.
You can run "<code>xhost -127.0.0.1</code>" after <b>x11vnc</b>
connects if you want to go back to the original permissions.
</p><p>
If the Xterminal is really stripped down and doesn't have any user
accounts, NFS, etc. you'll need to contact your system administrator
to set something up.  It can be done!!!&nbsp; Some Xterminal projects
have actually enabled "run locally" facilities for the running of an
occasional app more efficiently locally on the Xterminal box
(e.g. <code>realplayer</code>.)
</p><p>
Not recommended, but as a last resort, you could have <b>x11vnc</b>
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-noshm"> poll the Xterminal Display over the network</a>.
For this you would run a "<code>x11vnc -noshm ...</code>" process <em>on</em>
the central-server (and hope the network admin doesn't get angry...)
</p><p>
<a name="infaq_xauth_pain"></a>
<br>
Note: use of Display Manager (<code>gdm</code>, <code>kdm</code>, ...)
auth cookie files (i.e. from <code>/var/...</code>,&nbsp; <code>/tmp/...</code>, or elsewhere) may
require modification via <code>xauth(1)</code> to correctly include the
display <b>x11vnc</b> refers to (e.g.
"<code>xauth -f cookie-file add :0 . 45be51ae2ce9dfbacd882ab3ef8e96b1</code>",
where the "<code>45be51...</code>" cookie value was found from an "<code>xauth -f /path/to/original/cookie-file  list</code>")
or other reasons.  See <code>xauth(1)</code> manpage for full details
on how to transfer an MIT-MAGIC-COOKIE between machines and displays.
</p><p>
<br>
<em>VNCviewer performance on Xterminals:</em>&nbsp;&nbsp;This isn't related to
<b>x11vnc</b> on Xterminals, but we mention it here anyway because of the
similar issues.
If you are on an Xterminal and want to use <code>vncviewer</code>
to connect to a VNC server somewhere, then performance would be
best if you ran the <em>viewer</em> on the Xterminal box. 
Otherwise, (i.e. running the viewer process on the central-server) all
of the <code>vncviewer</code> screen drawing is done more inefficiently
over the network.  Something to consider, especially on a busy network.
(BTW, this has all of the above
permission, etc, problems: <em>both</em> <code> vncviewer</code> and <b>x11vnc</b>
are X client apps desired to be run on the Xterminal box.)
</p>

&nbsp;<br><font size="-0"><b>[Sun Rays]</b></font><br>
<a name="faq-sunrays"></a>
<a name="FAQ-32"></a>
<p><b>Q-32:</b>
<font color="#007f00">
I'm having trouble using <b>x11vnc</b> with my Sun Ray session.
</font>
</p>
<p>
The <a href="http://web.archive.org/web/20210304200604/http://www.sun.com/sunray/index.html">Sun Ray technology</a>
is a bit like "VNC done in hardware" (the Sun Ray terminal device, DTU, playing
the role of the vncviewer.)  <em><b>Completely</b></em> independent of that,
the SunRay user's session is still an X server that speaks the X11
protocol and so <b>x11vnc</b> simply talks to the X server part to
export the SunRay desktop to any place in the world (i.e. not only to a Sun
Ray terminal device), creating a sort of "Soft Ray".  Please see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/sunray.html">this discussion of Sun Ray issues</a> for
solutions to problems.
</p><p>
Also see the <a href="http://web.archive.org/web/20210304200604/http://wiki.sun-rays.org/index.php/Remote_Control_Toolkit">Sun Ray Remote Control Toolkit</a>
that uses <b>x11vnc</b>.
</p>

&nbsp;<br><font size="-0"><b>[Remote Control]</b></font><br>
<a name="faq-stop-bg"></a>
<a name="FAQ-33"></a>
<p><b>Q-33:</b>
<font color="#007f00">
How do I stop <b>x11vnc</b> once it is running in the background?
</font>
</p>
<p>
As of Dec/2004 there is a
remote control feature.  It can change a huge number of parameters
on the fly: see the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remote"><code>-remote</code></a>
and 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-query"><code>-query</code></a> options.
To shut down the running <b>x11vnc</b> server just
type "<code>x11vnc -R stop</code>".  To disconnect all clients
do "<code>x11vnc -R disconnect:all</code>", etc.
</p><p>
If the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-forever"><code>-forever</code></a> option has not been supplied, <b>x11vnc</b>
will automatically exit after the first client disconnects.
In general if you cannot use the remote control, then you will have
to kill the <b>x11vnc</b> process This can be done via: "<code>kill
NNNNN</code>" (where <code>NNNNN</code> is the <b>x11vnc</b> process id
number found from <code>ps(1)</code>), or "<code>pkill x11vnc</code>",
or "<code>killall x11vnc</code>" (Linux only.)
</p><p>
If you have not put <b>x11vnc</b> in the background via the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-bg"><code>-bg</code></a> option or shell <code>&amp;</code> operator,
then simply press <code>Ctrl-C</code> in the shell where <b>x11vnc</b> is
running to stop it.  
</p><p>
<em>Potential Gotcha:</em> If somehow your Keypress of <code>Ctrl-C</code> went
<em>through</em> <b>x11vnc</b> to the Xserver that then delivered it to
<b>x11vnc</b> it is possible one or both of the <code>Ctrl</code> or
<code>C</code> keys will be left stuck in the pressed down state
in the Xserver.
Tapping the stuck key (either via a new <b>x11vnc</b> or at the physical
console) will release it from the stuck state.  If the keyboard seems
to be acting strangely it is often fixed by tapping <code>Ctrl</code>,
<code>Shift</code>, and <code>Alt</code>.  Alternatively, the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-clear_mods"><code>-clear_mods</code></a> option
and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-clear_keys"><code>-clear_keys</code></a> option can be
used to release pressed keys at startup and exit.
The option <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-clear_all"><code>-clear_all</code></a> will
also try to unset Caps_Lock, Num_Lock, etc.
</p><p>&nbsp;</p>

<a name="faq-remote_control"></a>
<a name="FAQ-34"></a>
<p><b>Q-34:</b>
<font color="#007f00">
Can I change settings in <b>x11vnc</b> without having to restart it?
Can I remote control it?
</font>
</p>
<p>
Look at the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remote"><code>-remote</code></a> (an alias is <code>-R</code>)
and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-query"><code>-query</code></a> (an alias is <code>-Q</code>)
options added in Dec/2004.  They allow 
nearly everything to be changed dynamically and settings to be
queried.  Examples:
"<code>x11vnc -R shared</code>", 
"<code>x11vnc -R forever</code>",
"<code>x11vnc -R scale:3/4</code>",
"<code>x11vnc -Q modtweak</code>",
"<code>x11vnc -R stop</code>",
"<code>x11vnc -R disconnect:all</code>", etc..
</p><p>
These commands do not start a <b>x11vnc</b> server, but rather
communicate with one that is already running.  The X display
(<code>X11VNC_REMOTE</code> property) is used as the communication
channel, so the X permissions and <code>DISPLAY</code> must be
set up correctly for communication to be possible.
</p><p>
If no X server is involved (i.e. rawfb mode) then a file
may be used as an alternative communication channel, via, say
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-connect">"<code>-connect /path/to/somefile</code>"</a> 
(both the x11vnc server and the remote control x11vnc processes
specify the same "<code>-connect</code>" file.)
</p><p>
There is also a simple Tcl/Tk <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-config-file">gui</a> based
on this remote control mechanism.  See the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-gui"><code>-gui</code></a> option for more info.
You will need to have Tcl/Tk (i.e. <code>/usr/bin/wish</code>) installed
for it to work.  It can also run in the system tray: "<code>-gui tray</code>"
or as a standalone small icon window: "<code>-gui icon</code>".
Use "<code>-gui tray=setpass</code>" for a naive user "Share My Desktop"
mode.
</p>

&nbsp;<br><font size="-0"><b>[Security and Permissions]</b></font><br>

<a name="faq-passwd"></a>
<a name="FAQ-35"></a>
<p><b>Q-35:</b>
<font color="#007f00">
How do I create a VNC password for use with <b>x11vnc</b>?
</font>
</p>
<p>
You may already have one in <code>$HOME/.vnc/passwd</code> if you have
used, say, the <code>vncserver</code> program from the regular RealVNC or
TightVNC packages (i.e. launching the <code>Xvnc</code> server.)
Otherwise, you could use the <code>vncpasswd(1)</code> program from those
packages.
</p><p>
As of Jun/2004 <b>x11vnc</b> supports the
<code>-storepasswd "pass" "file"</code> <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-storepasswd">option</a>, which is
the same functionality of <code>storepasswd</code>.  Be sure to
quote the <code>"pass"</code> if it contains shell meta characters, spaces, etc.
Example:
</p><pre>  x11vnc -storepasswd 'sword*fish' $HOME/myvncpasswd
</pre>
<p></p><p>
You then use the password via the <b>x11vnc</b> option:
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rfbauth"><code>-rfbauth $HOME/myvncpasswd</code></a>"
</p><p>
As of Jan/2006 if you do not supply any arguments:
</p><pre>  x11vnc -storepasswd
</pre>
you will be prompted for a password to save to <code>~/.vnc/passwd</code>
(your keystrokes when entering the password will not be echoed to the screen.)
If you supply one argument, e.g. "<code>x11vnc -storepasswd ~/.mypass</code>",
the password you are prompted for will be stored in that file.
<p></p><p>
<b>x11vnc</b> also has the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-passwdfile"><code>-passwdfile</code></a>
and <code>-passwd/-viewpasswd</code> plain text
(i.e. not obscured like the <code>-rfbauth</code> VNC passwords)
password options.
</p><p>
You can use the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-usepw"><code>-usepw</code></a>
option to automatically use any password file you have in
<code>~/.vnc/passwd</code> or <code>~/.vnc/passwdfile</code>
(the latter is used with the <code>-passwdfile</code> option.)
</p><p>
</p><pre>  x11vnc -usepw -display :0 ...
</pre>
If neither file exists you are prompted to store a password in
<code>~/.vnc/passwd</code>.  If a password file cannot be found or
created <b>x11vnc</b> exits immediately.
An admin may want to set it up this way for users who do not know better.
<p></p><p>&nbsp;</p>

<a name="faq-passwd-noecho"></a>
<a name="FAQ-36"></a>
<p><b>Q-36:</b>
<font color="#007f00">
Can I make it so <code>-storepasswd</code> doesn't show my password on the 
screen?
</font>
</p>
<p>
You can use the <code>vncpasswd</code> program from RealVNC or TightVNC
mentioned above.  As of Jan/2006 the <code>-storepasswd</code> option
without any arguments will not echo your password as you type it and
save the file to <code>~/.vnc/passwd</code>:
</p><pre>  # x11vnc -storepasswd
  Enter VNC password: 
  Verify password:    
  Write password to /home/myname/.vnc/passwd?  [y]/n 
  Password written to: /home/myname/.vnc/passwd
</pre>
You can also give it an alternate filename,
e.g. "<code>x11vnc -storepasswd ~/.mypass</code>"
<p></p><p>
</p><p>&nbsp;</p>

<a name="faq-passwdfile"></a>
<a name="FAQ-37"></a>
<p><b>Q-37:</b>
<font color="#007f00">
Can I have two passwords for VNC viewers, one for full access and
the other for view-only access to the display?
</font>
</p>
<p>
Yes, as of May/2004 there is the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-viewpasswd"><code>-viewpasswd</code></a> option to supply the view-only password.  Note
the full-access password option <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-passwd"><code>-passwd</code></a> must be supplied
at the same time.  E.g.: <code>-passwd sword -viewpasswd fish</code>.
</p><p>
To avoid specifying the passwords on the command line (where they could be
observed via the <code>ps(1)</code> command by any user) you can use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-passwdfile"><code>-passwdfile</code></a> option to specify a file containing
plain text passwords.  Presumably this file is readable only
by you, and ideally it is located on the machine <b>x11vnc</b> is
run on (to avoid being snooped on over the network.)  
The first line of this file is the full-access password.  If there is
a second line in the file and it is non-blank, it is taken as the view-only password.
(use "<code>__EMPTY__</code>" to supply an empty one.)
</p><p>
View-only passwords currently do not work for the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rfbauth"><code>-rfbauth</code></a> password option (standard VNC password storing mechanism.)
FWIW, note that although the output (usually placed in
<code>$HOME/.vnc/passwd</code>) by the <code>vncpasswd</code> or
<code>storepasswd</code> programs (or from <code>x11vnc -storepasswd</code>)
looks encrypted they are really just
obscured to avoid "casual" password stealing.  It takes almost no
skill to figure out how to extract the plain text passwords
from <code>$HOME/.vnc/passwd</code> since it is very straight-forward
to work out what to do from the VNC source code.
</p><p>&nbsp;</p>

<a name="faq-multipasswd"></a>
<a name="FAQ-38"></a>
<p><b>Q-38:</b>
<font color="#007f00">
Can I have as many full-access and view-only passwords as I like?
</font>
</p>
<p>
Yes, as of Jan/2006 in the <b>libvncserver</b> CVS the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-passwdfile"><code>-passwdfile</code></a> option 
has been extended to handle as many passwords as you like.  You put the
view-only passwords after a line <code>__BEGIN_VIEWONLY__</code>.
</p>
<p>
You can also easily annotate and comment out passwords in the file. You
can have <b>x11vnc</b> re-read the file dynamically when it is modified.
</p><p>&nbsp;</p>

<a name="faq-unix-passwords"></a>
<a name="FAQ-39"></a>
<p><b>Q-39:</b>
<font color="#007f00">
Does <b>x11vnc</b> support Unix usernames and passwords?  Can I further
limit the set of Unix usernames who can connect to the VNC desktop?
</font>
</p>
<b><em>Update:</em></b> as of Feb/2006 <b>x11vnc</b> has the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-unixpw"><code>-unixpw</code></a> option that
does this outside of the VNC protocol and <code>libvncserver</code>.
The standard <code>su(1)</code> program is used to validate the user's password.
A familiar "login:" and "Password:" dialog is presented to the user on
a black screen inside the vncviewer.  The connection is dropped if the
user fails to supply the correct password in 3 tries or does not send
one before a 25 second timeout.  Existing clients are view-only during
this period.  A list of allowed Unix usernames may also be supplied along
with per-user settings.
<p></p><p>
There is also the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-unixpw_nis"><code>-unixpw_nis</code></a> 
option for non-shadow-password (typically NIS environments, hence the name)
systems where the traditional <code>getpwnam()</code> and <code>crypt()</code>
functions are used instead of <code>su(1)</code>.  The encrypted user passwords must be accessible to
the user running <b>x11vnc</b> in <code>-unixpw_nis</code> mode, otherwise
the logins will always fail even when the correct password is supplied.
See <code>ypcat(1)</code> and <code>shadow(5)</code>.
</p><p>
Two settings are enforced in the <code>-unixpw</code> and <code>-unixpw_nis</code>
modes to provide extra security:
the 1) 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-localhost"><code>-localhost</code></a> and 2)
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-stunnel"><code>-stunnel</code></a>
or <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a> options.
Without these one might send the Unix username and password data in clear text
over the network which is a very bad idea.  They can be relaxed if you
want to provide encryption other than <code>stunnel</code>
or <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a>
(the
constraint is automatically relaxed if <code>SSH_CONNECTION</code> is set and
indicates you have ssh-ed in, however the <code>-localhost</code> requirement
is still enforced.)
</p><p>
The two <code>-unixpw</code> modes have been tested on Linux, Solaris,
Mac OS X, HP-UX, AIX, Tru64,
FreeBSD, OpenBSD, and NetBSD.   Additional testing is appreciated.
For the last 4 it appears that <code>su(1)</code>
will not prompt for a password if su-ing to <b>oneself</b>.  Since <b>x11vnc</b>
requires a password prompt from su, <b>x11vnc</b> forces those logins to fail even when the
correct password is supplied.  On *BSD it appears this can be corrected
by removing the <code>pam_self.so</code> entry in <code>/etc/pam.d/su</code>.
</p><p>
&nbsp;<br>
<b><em>Previous older discussion (prior to the -unixpw option):</em></b>
</p><p>
Until the VNC protocol and <code>libvncserver</code> support this
things will be approximate at best.
</p><p>
One approximate method involves starting <b>x11vnc</b> with the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-localhost"><code>-localhost</code></a> option.  This basically requires the viewer
user to log into the workstation where <b>x11vnc</b> is running via
their Unix username and password, and then somehow set up a port redirection
of his <code>vncviewer</code> connection to make it appear to emanate from the
local machine.  As discussed above, <code>ssh</code> is useful for this:
"<code>ssh -L 5900:localhost:5900 user@hostname ...</code>"
See the <code>ssh</code> wrapper scripts mentioned 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#tunnelling">elsewhere</a> on this page.
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-ext">stunnel</a> does this as well.
</p><p>
Of course a malicious user could allow other users to get in through his
channel, but that is a problem with every method.  Another thing to 
watch out for is a malicious user on the <i><b>viewer</b></i> side (where
<code>ssh</code> is running) trying to sneak in through the
<code>ssh</code> port redirection there.
</p><p>
Regarding limiting the set of Unix usernames who can connect, the
traditional way would be to further require a VNC password to supplied
(<code>-rfbauth</code>, <code>-passwd</code>, etc) and only tell the
people allowed in what the VNC password is.  
A scheme that avoids a second password
involves using the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-accept"><code>-accept</code></a> option that runs a program to
examine the connection information to determine <em>which</em> user is
connecting from the local machine.  That may be difficult to do, but,
for example, the program could use the <code>ident</code> service on the
local machine (normally <code>ident</code> should not be trusted over the
network, but on the local machine it should be accurate: otherwise root
has been compromised and so there are more serious problems! Unfortunately
recent Linux distros seem to provide a random string (MD5 hash?) instead
of the username.)
An example script passed in via <code>-accept scriptname</code> that
deduces the Unix username and limits who can be accepted might look
something like this:
</p><pre>#!/bin/sh
if [ "$RFB_CLIENT_IP" != "127.0.0.1" -o "$RFB_SERVER_IP" != "127.0.0.1" ]; then
	exit 1	# something fishy... reject it.
fi
user=`echo "$RFB_CLIENT_PORT, $RFB_SERVER_PORT" | nc -w 1 $RFB_CLIENT_IP 113 \
	| grep 'USERID.*UNIX' | head -n 1 | sed -e 's/[\r ]//g' | awk -F: '{print $4}'`

for okuser in fred barney wilma betty 
do
	if [ "X$user" = "X$okuser" ]; then
		exit 0	# accept it
	fi
done
exit 1	# reject it
</pre>
For this to work with <code>ssh</code> port redirection, the
<code>ssh</code> option <code>UsePrivilegeSeparation</code> must
be enabled otherwise the userid will always be "root".
<p></p><p>
Here is a similar example based on Linux <code>netstat(1)</code> output:
</p><pre>#!/bin/sh
#
# accept_local_netstat:  x11vnc -accept command to accept a local
# vncviewer connection from acceptable users.  Linux netstat -nte is used.

PATH=/bin:/usr/bin:$PATH; export PATH;	# set to get system utils

allowed="`id -u fred`";			# add more user numbers if desired.

# check required settings
ok=1
if [ "X$allowed" = "X" ]; then
	ok=0;	# something wrong with allowed list
fi
if [ "X$RFB_CLIENT_IP" != "X127.0.0.1" -o "X$RFB_SERVER_IP" != "X127.0.0.1" ]; then
	ok=0;	# connection not over localhost
fi
if [ "$RFB_CLIENT_PORT" -le 0 -o "$RFB_SERVER_PORT" -le 0 ]; then
	ok=0;	# something wrong with tcp port numbers
fi
if [ "$ok" = 0 ]; then
	echo "$0: invalid setting:" 1&gt;&amp;2
	env | grep ^RFB | sort 1&gt;&amp;2
	exit 1
fi

# Linux netstat -nte:
# Proto Recv-Q Send-Q Local Address           Foreign Address         State       User       Inode      
# 0     0      0      RFB_CLIENT              RFB_SERVER           ESTABLISHED    nnnn       ....
#
user=`netstat -nte | grep ESTABLISHED \
	| grep " $RFB_CLIENT_IP:$RFB_CLIENT_PORT  *$RFB_SERVER_IP:$RFB_SERVER_PORT "`

echo "netstat match: $user" 1&gt;&amp;2
user=`echo "$user" | head -n 1 | sed -e 's/^.*ESTABLISHED/ /' | awk '{print $1}'`

ok=0
for u in $allowed
do
	if [ "X$user" = "X$u" ]; then
		ok=1
		break
	fi
done

if [ "X$ok" = "X1" ]; then
	echo "$0: user accepted: '$user'" 1&gt;&amp;2
	exit 0
else
	echo "$0: user '$user' invalid:" 1&gt;&amp;2
	echo "$0: allowed: $allowed" 1&gt;&amp;2
	env | grep ^RFB | sort 1&gt;&amp;2
	exit 1
fi
</pre>
<p></p><p>&nbsp;</p>

<a name="faq-custom-passwords"></a>
<a name="FAQ-40"></a>
<p><b>Q-40:</b>
<font color="#007f00">
Can I supply an external program to provide my own custom login
method (e.g. Dynamic/One-time passwords or non-Unix (LDAP) usernames and 
passwords)?
</font>
</p>
Yes, there are several possibilities.  For background see the FAQ on the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-accept-opt"><code>-accept</code></a>
where an external program may be run to decide if a VNC client should
be allowed to try to connect and log in.  If the program (or local user
prompted by a popup) answers "yes", then <code>-accept</code> proceeds
to the normal VNC and <b>x11vnc</b> authentication methods, otherwise
the connection is dropped.
<p></p><p>
To provide more direct coupling to the VNC client's username and/or supplied
password the following options were added in Sep/2006:
</p><ul>
<li>
<code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-unixpw_cmd">-unixpw_cmd</a> <em>command</em></code>
</li>
<li>
<code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-passwdfile">-passwdfile</a> cmd:<em>command</em></code>
</li><li>
<code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-passwdfile">-passwdfile</a> custom:<em>command</em></code>
</li>
</ul>
In each case "<code><em>command</em></code>" is an external command run 
by <b>x11vnc</b>.  You supply it.  For example, it may couple to your
LDAP system or other servers you set up.
<p></p><p>
For <code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-unixpw_cmd">-unixpw_cmd</a></code>
the normal <code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-unixpw">-unixpw</a></code>
Login: and Password: prompts are supplied to the VNC viewer and the strings the client returns
are then piped into "<code><em>command</em></code>" as the first
two lines of its standard input.  If the command returns success, i.e. <code>exit(0)</code>,
the VNC client is accepted, otherwise it is rejected.
</p><p>
For "<code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-passwdfile">-passwdfile</a> cmd:<em>command</em></code>"
the command is run and it returns a password list (like a password file, 
see the <code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-passwdfile">-passwdfile</a> read:<em>filename</em></code>
mode.)  Perhaps a dynamic, one-time password is retrieved from a server this way.
</p><p>
For "<code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-passwdfile">-passwdfile</a> custom:<em>command</em></code>"
one gets complete control over the VNC challenge-response dialog with
the VNC client. <b>x11vnc</b> sends out a string of random bytes (16
by the VNC spec) and the client returns the same number of bytes in a
way the server can verify only the authorized user could have created.
The VNC protocol specifies DES encryption with a password.
If you are willing to modify the VNC viewers, you can have it be
anything you want, perhaps a less crackable MD5 hash scheme or one-time pad.
Your program will read from its standard input the size of the
challenge-response followed by a newline, then the challenge bytes
followed by the response bytes.
If your command then returns success, i.e. <code>exit(0)</code>,
the VNC client is accepted, otherwise it is rejected.
</p><p>
In all cases the "<code>RFB_*</code>" environment variables are set as under
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-accept-opt"><code>-accept</code></a>.
These variables can provide useful information for the externally supplied
program to use.
</p><p>&nbsp;</p>

<a name="faq-forever-shared"></a>
<a name="FAQ-41"></a>
<p><b>Q-41:</b>
<font color="#007f00">
Why does <b>x11vnc</b> exit as soon as the VNC viewer disconnects?
And why doesn't it allow more than one VNC viewer to connect at the same time?
</font>
</p>
<p>
These defaults are simple safety measures to avoid someone unknowingly
leaving his X11 desktop exposed (to the internet, say) for long periods
of time.  Use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-forever"><code>-forever</code></a> option (aka <code>-many</code>)
to have <b>x11vnc</b>
wait for more connections after the first client disconnects.
Use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-shared"><code>-shared</code></a> option to have <b>x11vnc</b> allow
multiple clients to connect simultaneously.
</p><p>
Recommended additional safety measures include using <code>ssh</code>
(<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#tunnelling">see above</a>), stunnel,
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a>,
or a VPN to authenticate and encrypt the viewer connections or to
at least use the <code>-rfbauth passwd-file</code> <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-passwd">option</a>
to use VNC password protection (or <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-passwdfile"><code>-passwdfile</code></a>)
It is up to <em>YOU</em> to apply these security measures, they will not
be done for you automatically.
</p><p>&nbsp;</p>

<a name="faq-allow-opt"></a>
<a name="FAQ-42"></a>
<p><b>Q-42:</b>
<font color="#007f00">
Can I limit which machines incoming VNC clients can connect from? 
</font>
</p>
<p>
Yes, look at the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-allow"><code>-allow</code></a> 
and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-localhost"><code>-localhost</code></a> options
to limit connections by hostname or IP address.
E.g.
</p><pre>  x11vnc -allow 192.168.0.1,192.168.0.2
</pre>
for those two hosts or
<pre>  x11vnc -allow 192.168.0.
</pre> for a subnet.  For individual hosts you can use the hostname
instead of the IP number, e.g.: "<code>-allow snoopy</code>",
and "<code>-allow darkstar,wombat</code>".
Note that <code>-localhost</code> achieves the same thing as "<code>-allow 127.0.0.1</code>"
<p></p><p>
For more control, build
<b>libvncserver</b> with <code>libwrap</code> support
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-tcp_wrappers">(tcp_wrappers)</a>
and then use <code>/etc/hosts.allow</code>  See <code>hosts_access(5)</code>
for complete details.
</p><p>&nbsp;</p>

<a name="faq-tcp_wrappers"></a>
<a name="FAQ-43"></a>
<p><b>Q-43:</b>
<font color="#007f00">
How do I build <b>x11vnc/libvncserver</b> with <code>libwrap</code> (tcp_wrappers) support?
</font>
</p>
<p>
Here is one way to pass this information to the <code>configure</code>
script:
</p><pre>  env CPPFLAGS=-DUSE_LIBWRAP LDFLAGS=-lwrap ./configure
</pre>
then run <code>make</code> as usual.  This requires
<code>libwrap</code> and its development package (<code>tcpd.h</code>)
to be installed on the build machine.  If additional <code>CPPFLAGS</code>
or <code>LDFLAGS</code> options are needed supply them as well
using quotes.
<p></p><p>
The resulting <b>x11vnc</b> then uses libwrap/tcp_wrappers for connections.
The service name you will use in <code>/etc/hosts.allow</code> and
<code>/etc/hosts.deny</code> is "<code>vnc</code>", e.g.:
</p><pre>  vnc: 192.168.100.3 .example.com
</pre>
Note that if you run <b>x11vnc</b> out of <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-inetd">inetd</a>
you do not need to build <b>x11vnc</b> with <code>libwrap</code>
support because the <code>/usr/sbin/tcpd</code> reference in
<code>/etc/inetd.conf</code> handles the tcp_wrappers stuff.
Note that the name that inetd/xinetd uses for the <code>/etc/hosts.allow</code>
and etc. checking will not be "<code>vnc</code>" but will be perhaps
the basename of the program or a name specified in the inetd/xinetd
configuration.  So this name will likely be "<code>x11vnc</code>", but you
probably can configure it to be anything you want.
<p></p><p>&nbsp;</p>

<a name="faq-listen-interface"></a>
<a name="FAQ-44"></a>
<p><b>Q-44:</b>
<font color="#007f00">
Can I have <b>x11vnc</b> only listen on one network interface (e.g. internal
LAN) rather than having it listen on all network interfaces and relying
on <code>-allow</code> to filter unwanted connections out?
</font>
</p>
<p>
As of Mar/2005 there is the
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-listen"><code>-listen ipaddr</code></a>"
option that enables this.  For <code>ipaddr</code> either supply the
desired network interface's IP address (or use a hostname that resolves
to it) or use the string "<code>localhost</code>".  For additional
filtering simultaneously use the  
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-allow"><code>-allow host1,...</code></a>"
option to allow only specific hosts in.
</p>
<p>
This option is useful if you want to insure that no one can even begin
a dialog with <b>x11vnc</b> from untrusted network interfaces
(e.g. <code>ppp0</code>.)
The option
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-localhost"><code>-localhost</code></a>
now implies "<code>-listen localhost</code>" since that is what most people
expect it to do.
</p><p>&nbsp;</p>

<a name="faq-listen-localhost"></a>
<a name="FAQ-45"></a>
<p><b>Q-45:</b>
<font color="#007f00">
Now that <code>-localhost</code> implies listening only on
the loopback interface, how I can occasionally allow in a non-localhost
via the <code>-R allowonce</code> remote control command?
</font>
</p>
<p>
To do this specify
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-allow"><code>-allow localhost</code></a>".
Unlike
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-localhost"><code>-localhost</code></a>
this will leave <b>x11vnc</b> listening on all interfaces (but
of course only allowing in local connections, e.g. ssh
redirs.) Then you can
later run "<code>x11vnc -R allowonce:somehost</code>" or use to gui
to permit a one-shot connection from a remote host.
<!--
</p>
<p>
Note that if you do a lot of changing of the listening interface
(<a href="x11vnc_opts.html#opt-listen"><code>-listen</code></a>
option) via remote control or gui, you may need to also manually
adjust the
<a href="x11vnc_opts.html#opt-allow"><code>-allow</code></a>
list if you unexpectedly get into a state where the allow list cannot
match any hosts that would be coming in on the listening interface.
If you just toggle 
<a href="x11vnc_opts.html#opt-localhost"><code>-localhost</code></a>
on and off <b>x11vnc</b> should see to it that you never get into
such a state.
-->
</p><p>&nbsp;</p>

<a name="faq-input-opt"></a>
<a name="FAQ-46"></a>
<p><b>Q-46:</b>
<font color="#007f00">
Can I fine tune what types of user input are allowed?  E.g. have
some users just be able to move the mouse, but not click or type
anything? 
</font>
</p>
<p>
As of Feb/2005, the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-input"><code>-input</code></a> option allows you to do this.
"K", "M", "B", "C", and "F" stand for Keystroke, Mouse-motion, Button-clicks,
Clipboard, and File-Transfer, respectively.
The setting: "<code>-input M</code>" makes attached viewers only
able to move the mouse.  "<code>-input KMBC,M</code>" lets normal
clients do everything and enables view-only clients to move the mouse.
</p><p>
These settings can also be applied on a per-viewer basis via
the remote control mechanism or the GUI.
E.g. <code>x11vnc -R input:hostname:M</code>
</p><p>&nbsp;</p>

<a name="faq-accept-opt"></a>
<a name="FAQ-47"></a>
<p><b>Q-47:</b>
<font color="#007f00">
Can I prompt the user at the local X display whether the incoming VNC
client should be accepted or not?  Can I decide to make some clients view-only?
How about running an arbitrary program to make the decisions?
</font>
</p>
<p>
Yes, look at the 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-accept"><code>-accept command</code></a>" option, it allows you to
specify an external command that is run for each new client. (use
quotes around the command if it contains spaces, etc.)
If the external command returns 0 (success) the client is accepted, otherwise
with any other return code the client is rejected.  See below how to
also accept clients view-only.
</p><p>
The external command will have the <code>RFB_CLIENT_IP</code>
environment variable set to the client's numerical IP address,
<code>RFB_CLIENT_PORT</code> its port number.  Similarly for
<code>RFB_SERVER_IP</code> and <code>RFB_SERVER_PORT</code> to allow
identification of the tcp virtual circuit.
<code>DISPLAY</code>
will be set to that of the X11 display being polled.  Also,
<code>RFB_X11VNC_PID</code> is set to the <b>x11vnc</b> process id
(e.g. in case you decided to kill it), <code>RFB_CLIENT_ID</code> will
be an id number, and <code>RFB_CLIENT_COUNT</code> the number of other
clients currently connected.  <code>RFB_MODE</code> will be "accept".
</p><p>
<b><em>Built-in Popup Window:</em></b>
As a special case, "<code>-accept popup</code>" will instruct
<b>x11vnc</b> to create its own simple popup window.  To accept the
client press "y" or click mouse on the "Yes" button.  To reject the
client press "n" or click mouse on the "No" button.  To accept the
client View-only, press "v" or click mouse on the "View" button.
If the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-viewonly"><code>-viewonly</code></a> option has been supplied, the "View"
action will not be present: the whole display is view only in that case.
</p><p>
The popup window times out after 120 seconds, to change this behavior
use "<code>-accept popup:N</code>" where <code>N</code> is the number of
seconds (use 0 for no timeout.)  More tricks: "<code>-accept popupmouse</code>"
will only take mouse click responses, while "<code>-accept popupkey</code>"
will only take keystroke responses (<code>popup</code> takes both.)
After any of the 3 popup keywords you can supply a position of the
window: <code>+N+M</code>, (the default is to center the window)
e.g. <code>-accept popupmouse+10+10</code>.
</p><p>
Also as a special case "<code>-accept xmessage</code>" will run the 
<code>xmessage(1)</code> program to prompt the user whether the client
should be accepted or not.  This requires that you have <code>xmessage</code>
installed and available via <code>PATH</code>.  In case it is not
already on your system, the <code>xmessage</code> program is
available at <a href="http://web.archive.org/web/20210304200604/ftp://ftp.x.org/">ftp://ftp.x.org/</a>
<br>(End of <em>Built-in Popup Window:</em>)
</p><p>
To include view-only decisions for the external commands, prefix the
command something like this:  <code>"yes:0,no:*,view:3 mycommand ..."</code>
This associates the three actions: yes(accept), no(reject), and 
view(accept-view-only), with the numerical return
(i.e. <code>exit()</code>) codes. Use "*" instead of a number to set the
default action (e.g. in case the external command returns an unexpected
return code.)
</p><p>
Here is an example <code>-accept</code> script called <code>accept_or_lock</code>.
It uses <code>xmessage</code> and <code>xlock</code> (replace with your
screen lock command, maybe it is "<code>xscreensaver-command -lock</code>",
or <code>kdesktop_lock</code>, or "<code>dtaction LockDisplay</code>".)
It will prompt the user at the X display whether
to accept, reject, or accept view-only the client, but if the prompt
times out after 60 seconds the screen is locked and the VNC client is
<b><em>accepted</em></b>.  This allows the remote access when no one is at the
display.
</p><pre>#!/bin/sh
#
# accept_or_lock: prompt user at X display whether to accept an incoming
#                 VNC connection.  If timeout expires, screen is locked 
#                 and the VNC viewer is accepted (allows remote access
#                 when no one is sitting at the display.)
#                 
# usage: x11vnc ... -forever -accept 'yes:0,no:*,view:4 accept_or_lock'
#
xmessage -buttons yes:2,no:3,view-only:4 -center \
         -timeout 60 "x11vnc: accept connection from $RFB_CLIENT_IP?"
rc=$?
if [ $rc = 0 ]; then
        xlock &amp; # or "xlock -mode blank" for no animations.
        sleep 5
        exit 0
elif [ $rc = 2 ]; then
        exit 0
elif [ $rc = 4 ]; then
        exit 4
fi
exit 1
</pre>
Stefan Radman has written a nice <code>dtksh</code>
script <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/dtVncPopup">dtVncPopup</a> for use in CDE environments
to do the same sort of thing.
Information on how to use it is found at the top of the file.
He encourages you to provide feedback to him to help improve the script.
<p></p><p>
Note that in all cases <b>x11vnc</b> will block while the external
command or popup is being run, so attached clients will not receive
screen updates, etc during this period.
</p><p>
To run a command when a client disconnects, use the 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-gone"><code>-gone command</code></a>" option.
This is for the user's convenience only: the return code of the
command is not interpreted by <b>x11vnc</b>.  The same environment
variables are set as in "<code>-accept command</code>" (except that
<code>RFB_MODE</code> will be "gone".)
</p><p>
As of Jan/2006 the
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-afteraccept"><code>-afteraccept command</code></a>" option
will run the command only after the VNC client has been accepted
and authenticated.  Like <code>-gone</code> the return code is not interpreted.
<code>RFB_MODE</code> will be "afteraccept".)
</p><p>&nbsp;</p>

<a name="faq-users-opt"></a>
<a name="FAQ-48"></a>
<p><b>Q-48:</b>
<font color="#007f00">
I start <b>x11vnc</b> as root because it is launched
via <code>inetd(8)</code> or a display manager like <code>gdm(1)</code>.
Can I have <b>x11vnc</b> later switch to a different user?
</font>
</p>
<p>
As of Feb/2005 <b>x11vnc</b> has the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-users"><code>-users</code></a> option that
allows things like this.  Please read the documentation on it
(also in the <code>x11vnc -help</code> output) carefully for features and
caveats.  It's use can often <em>decrease</em> security unless care is
taken.
</p><p>
BTW, a nice use of it is "<code>-users +nobody</code>" that switches
to the Unix user <code>nobody</code> right after connections to the X
display are established.
</p><p>
In any event, while running <b>x11vnc</b> as root, remember it comes with no warranty ;-).
</p><p>&nbsp;</p>

<a name="faq-blockdpy"></a>
<a name="FAQ-49"></a>
<p><b>Q-49:</b>
<font color="#007f00">
I use a screen-lock when I leave my workstation (e.g. xscreensaver or
xlock.)  When I remotely access my workstation desktop via
<b>x11vnc</b> I can unlock the desktop fine, but I am worried people
will see my activities on the physical monitor.  What can I do to
prevent this, or at least make it more difficult?
</font>
</p>
<p>
Probably most work environments would respect your privacy if you
powered off the monitor.  Also remember if people have physical access
to your workstation they basically can do anything they want with it
(e.g. install a backdoor for later use, etc.)
</p><p>
In any event, as of Jun/2004 there is an experimental utility to make
it more difficult for nosey people to see your <b>x11vnc</b>
activities.  The source for it is 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/blockdpy.c">blockdpy.c</a> The
idea behind it is simple (but obviously not bulletproof): when a VNC
client attaches to <b>x11vnc</b> put the display monitor in the DPMS
"off" state, if the DPMS state ever changes immediately start up the
screen-lock program.  The <b>x11vnc</b> user will notice something
is happening and think about what to do next (while the screen is
in a locked state.)  
</p><p>
This works (or at least has a chance of working) because if the
intruder moves the mouse or presses a key on the keyboard, the monitor
wakes up out of the DPMS off state, and this induces the screen lock 
program to activate as soon as possible.  Of course there are cracks
in this, the eavesdropper could detach your monitor and insert
a non-DPMS one, and there are race conditions.  As mentioned above
this is not bulletproof.  A really robust solution would likely
require X server and perhaps even video hardware support.
</p><p>
The <code>blockdpy</code> utility is launched by the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-accept"><code>-accept</code></a> option and
told to exit via the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-gone"><code>-gone</code></a> option 
(the vnc client user should obviously re-lock the screen before
disconnecting!)  Instructions can be found in the source code for the
utility at the above link. Roughly it is something like this:
</p><pre>  x11vnc ... -accept "blockdpy -bg -f $HOME/.bdpy" -gone "touch $HOME/.bdpy"
</pre>
but please read the top of the file.
<p></p><p>
<em><b>Update:</b></em> As of Feb/2007 there is some builtin support for
this: 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-forcedpms"><code>-forcedpms</code></a>
and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-clientdpms"><code>-clientdpms</code></a>
however, they are probably less robust than the above <code>blockdpy.c</code>
scheme, since if the person floods the physical machine with mouse or pointer
input he can usually see flashes of the screen before the monitor is
powered off again.
See also the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-grabkbd"><code>-grabkbd</code></a>,
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-grabptr"><code>-grabptr</code></a>,
and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-grabptr"><code>-grabalways</code></a>
options.
</p><p>&nbsp;</p>

<a name="faq-gone-lock"></a>
<a name="FAQ-50"></a>
<p><b>Q-50:</b>
<font color="#007f00">
Can I have <b>x11vnc</b> automatically lock the screen when I disconnect
the VNC viewer?
</font>
</p>
<p>
Yes, a user mentions he uses the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-gone"><code>-gone</code></a> option under CDE to run
a screen lock program:
</p><pre>  x11vnc -display :0 -forever -gone 'dtaction LockDisplay'
</pre>
Other possibilities are:
<pre>  x11vnc -display :0 -forever -gone 'xscreensaver-command -lock'
  x11vnc -display :0 -forever -gone 'kdesktop_lock'
  x11vnc -display :0 -forever -gone 'xlock &amp;'
  x11vnc -display :0 -forever -gone 'xlock -mode blank &amp;'
</pre>
<p></p>
<p>
Here is a scheme using the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-afteraccept"><code>-afteraccept</code></a> option
(in version 0.8) to unlock the screen after the first valid VNC login and to 
lock the screen after the last valid VNC login disconnects:
</p><pre>  x11vnc -display :0 -forever -shared -afteraccept ./myxlocker -gone ./myxlocker
</pre>
Where the script <code>./myxlocker</code> is:
<pre>#!/bin/sh

#/usr/bin/env | grep RFB_ | sort        # for viewing RFB_* settings.

if [ "X$RFB_MODE" = "Xafteraccept" ]; then
        if [ "X$RFB_STATE" = "XNORMAL" ]; then  # require valid login
                if [ "X$RFB_CLIENT_COUNT" = "X1" ]; then
                        killall xlock	# Linux only.
                fi
        fi
elif [ "X$RFB_MODE" = "Xgone" ]; then
        if [ "X$RFB_STATE" = "XNORMAL" ]; then  # require valid login
                if [ "X$RFB_CLIENT_COUNT" = "X0" ]; then
                        xlock -mode blank &amp;
                fi
        fi
fi
</pre>
<p></p>
<p>
Note the <code>xlock</code> option "<code>-mode blank</code>" to
avoid animations.
</p><p>
There is a problem if you have <b>x11vnc</b> running this way
in <code>-forever</code> mode and you hit Ctrl-C to stop it.
The <code>xlock</code> (or other program) will get killed too.  To work
around this make a little script called <code>setpgrp</code> that looks like:
</p><pre>#!/usr/bin/perl
setpgrp(0, 0);
exec @ARGV;
</pre>
then use <code>-gone "setpgrp xlock &amp;"</code>, etc.
<p></p>

&nbsp;<br><font size="-0"><b>[Encrypted Connections]</b></font><br>

<a name="faq-ssh-unix"></a>
<a name="FAQ-51"></a>
<p><b>Q-51:</b>
<font color="#007f00">
How can I tunnel my connection to <b>x11vnc</b> via an encrypted
SSH channel between two Unix machines?
</font>
</p>
<p>
See the description earlier on this page on
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#tunnelling">how to tunnel VNC via SSH from Unix to Unix</a>.
A number of ways are described along with some issues you may encounter.
</p><p>
Other secure encrypted methods exists, e.g. <code>stunnel</code>,
<code>IPSEC</code>, various VPNs, etc.
</p><p>
See also the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a> page
where much of this is now automated.
</p><p>&nbsp;</p>

<a name="faq-ssh-putty"></a>
<a name="FAQ-52"></a>
<p><b>Q-52:</b>
<font color="#007f00">
How can I tunnel my connection to <b>x11vnc</b> via an encrypted
SSH channel from Windows using an SSH client like Putty?
</font>
</p>
<p>
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#tunnelling">Above we described how to tunnel VNC via SSH
from Unix to Unix</a>, you may want to review it.  To do this from
Windows using Putty it would go something like this:
</p><ul>
	<li>In the Putty dialog window under <i>'Session'</i> enter the
	hostname or IP number of the Unix machine with display to be viewed.
	</li>
	<li>Make sure the SSH protocol is selected and the server port is correct.
	</li>
	<li>Under <i>'Connections/SSH/Tunnels'</i> Add a Local connection
	with <i>'Source port:&nbsp;&nbsp;5900'</i> and
	<i>'Destination:&nbsp;&nbsp;localhost:5900'</i>
	</li>
	<li>Log into the remote machine by pressing <i>'Open'</i> and 
	supplying username, password, etc.
	</li>
	<li>In that SSH shell, start up <b>x11vnc</b> by typing the
	command: <code>x11vnc -display :0</code> plus any other desired
	options (e.g. <code>-localhost</code>.)
	</li>
	<li>Finally, start up your VNC Viewer in Windows and enter
	<i>'localhost:0'</i> as the VNC server.
	</li>
</ul>
You can keep all of the settings in a Putty 'Saved Session'. 
Also, once everything is working, you can consider putting
<code>x11vnc -display :0</code> (plus other cmdline options)
in the <i>'Remote command'</i> Putty setting under
<i>'Connections/SSH'</i>.
<p></p><p>
See also the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a> page
where much of this is now automated via the Putty <code>plink</code> utility.
</p><p>
For extra protection feel free to run <b>x11vnc</b> with the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-localhost"><code>-localhost</code></a>
and
<code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rfbauth">-rfbauth</a>/<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-passwdfile">-passwdfile</a></code> options.
</p><p>
If the machine you SSH into via Putty is not the same machine with the
X display you wish to view (e.g.  your company provides incoming SSH
access to a gateway machine), then you
need to change the above Putty dialog setting to: <i>'Destination: <b>otherhost</b>:5900'</i>,
Once logged in, you'll need to do a second login (<code>ssh</code> or
<code>rsh</code>) to the workstation machine 'otherhost' and then start
up <b>x11vnc</b> on it.
This can also be automated by <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/chainingssh.html#gateway_double_ssh">Chaining SSH's</a>.
</p><p>
As discussed <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#tunnelling">above</a> another option is to
first start the VNC viewer in "listen" mode, and then launch <b>x11vnc</b>
with the 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-connect"><code>-connect localhost</code></a>" option
to establish the reverse
connection.  In this case a Remote port redirection (not Local) is needed for
port 5500 instead of 5900 (i.e. <i>'Source port:&nbsp;&nbsp;5500'</i>
and <i>'Destination:&nbsp;&nbsp;localhost:5500'</i> for a Remote connection.)
</p><p>&nbsp;</p>

<a name="faq-ssl-tunnel-ext"></a>
<a name="FAQ-53"></a>
<p><b>Q-53:</b>
<font color="#007f00">
How can I tunnel my connection to <b>x11vnc</b> via an encrypted
SSL channel using an external tool like <code>stunnel</code>?
</font>
</p>
<p>
It is possible to use a "lighter weight" encryption setup than SSH or IPSEC.
SSL tunnels such as <a href="http://web.archive.org/web/20210304200604/http://stunnel.mirt.net/">stunnel</a>
(also <a href="http://web.archive.org/web/20210304200604/http://www.stunnel.org/">stunnel.org</a>)
provide an encrypted channel without the need for Unix users, passwords, and
key passphrases required for <code>ssh</code> 
(and at the other extreme SSL can also provide a <em>complete</em> signed certificate chain of trust.)
On the other hand, since SSH is usually installed <em>everywhere</em>
and firewalls often let its port through, <code>ssh</code> is frequently the
path of least resistance (it also nicely manages public keys for you.)
</p><p>
<em><b>Update</b>:</em> As of Feb/2006 <b>x11vnc</b> has the options 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a>, 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-stunnel"><code>-stunnel</code></a>, and 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-sslverify"><code>-sslverify</code></a> 
to provide integrated SSL schemes.  They are discussed
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-int"> in the Next FAQ</a>
(you probably want to skip to it now.)
</p><p>
We include these non-built-in method descriptions below for historical
reference.  They are handy because can be used to create SSL tunnels to
any VNC (or other type of) server.
</p><p>&nbsp;
</p><p>
Here are some basic examples using <a href="http://web.archive.org/web/20210304200604/http://stunnel.mirt.net/">stunnel</a>
but the general idea for any SSL tunnel utility is the same:
</p><ul>
<li>
Start up <b>x11vnc</b> and constrain it to listen on localhost.
</li>
<li>
Then start up the SSL tunnel running on the same machine to forward
incoming connections to that <b>x11vnc</b>.  
</li>
<li>
Set up and run a similar SSL tunnel for the <em>outgoing</em> connection
on the VNC viewer machine pointing it to the SSL/x11vnc server.
</li>
<li>
Optionally, set up server (or even client) public/private keys for use
in authenticating one side to the other.
</li>
<li>
Finally, start the VNC Viewer and tell it to connect to the local port (e.g.
a vnc display <code>localhost:0</code>) where its outgoing SSL tunnel is
listening.
</li>
</ul>
<p></p><p>
We'll first use the <code>stunnel</code> version 3 syntax since it is the
most concise and Unixy.
</p><p>
Start up <b>x11vnc</b> listening on port 5900:
</p><pre>  x11vnc -display :0 -rfbport 5900 -localhost -bg -passwdfile ~/mypass
</pre>
Then start <code>stunnel</code> (version 3, not 4) with this command:
<pre>  stunnel -d 5901 -r 5900 -p /path/to/stunnel.pem
</pre>
The above two commands are run on host "<code>far-away.east</code>".   
The <code>stunnel.pem</code> is the self-signed PEM file certificate created when
<code>stunnel</code> is built.  One can also create certificates
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl.html">signed by Certificate Authorities</a> or
self-signed if desired using the <b>x11vnc</b> utilities described there.
<p></p><p>
<a name="infaq_viewer-side-stunnel"></a>
<b><em>SSL Viewers</em></b>:&nbsp; Next, on the <b>VNC viewer side</b> we need an SSL tunnel to encrypt the outgoing
connection.  The nice thing is <em>any</em> SSL tunnel can be used because the
protocol is a standard.
For this example we'll also use <code>stunnel</code> on the viewer side
on Unix.  First start up the client-side <code>stunnel</code> (version 3, not 4):
</p><pre>  stunnel -c -d localhost:5902 -r far-away.east:5901
</pre>
Then point the viewer to the local tunnel on port 5902:
<pre>  vncviewer -encodings "copyrect tight zrle hextile" localhost:2
</pre>
That's it.&nbsp;
Note that the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#ss_vncviewer">ss_vncviewer</a> script can
automate this easily, and so can the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a>
package.
<p></p><p>
Be sure to use a VNC password because unlike <code>ssh</code>
by default the encrypted SSL channel provides no authentication (only privacy.)
With some extra configuration one could also set up certificates to
provide authentication of either or both sides as well (and hence avoid
man-in-the-middle attacks.)  See the stunnel and openssl documentation
and also <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl.html">the key management section</a> for details.
</p><p>
<a name="infaq_stunnel-conf">
<code>stunnel</code> has also been ported to Windows, and there are likely
others to choose from for that OS.
Much info for using it on Windows can be found at the stunnel site
and in this </a><a href="http://web.archive.org/web/20210304200604/http://www.securityfocus.com/infocus/1677">article</a>
The article also shows the detailed steps to set up all the authentication certificates.
(for both server and clients, see also the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl.html">x11vnc utilities</a> that do this.)
The default Windows client setup (no certs) is simpler and only 4 files are needed
in a folder: <code>stunnel.exe, stunnel.conf, libssl32.dll, libeay32.dll</code>.
We used an <code>stunnel.conf</code> containing:
</p><pre># stunnel.conf:
client = yes
options = ALL
[myvncssl]
accept = localhost:5902
connect = far-away.east:5901
</pre>
then double click on the <code>stunnel.exe</code> icon to launch it
(followed by pointing the VNC viewer to localhost:2).
<p></p><p>
&nbsp; 
</p><p>
<em>stunnel inetd-like mode:</em>
</p><p>
As an aside, if you don't like the little "gap" of unencrypted TCP traffic (and a
localhost listening socket) on the local machine between stunnel and <b>x11vnc</b>
it can actually be closed by having <code>stunnel</code> start up
<b>x11vnc</b> in
<a name="infaq_stunnel-inetd">
</a><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-inetd"><code>-inetd</code></a> mode:
</p><pre>  stunnel -p /path/to/stunnel.pem -P none -d 5900 -l ./x11vnc_sh
</pre>
Where the script <code>x11vnc_sh</code> starts up <b>x11vnc</b>:
<pre>#!/bin/sh
x11vnc -q -inetd -display :0 -passwdfile ~/mypass
</pre>
Note that this creates a separate <b>x11vnc</b> process for each incoming
connection (as any inetd x11vnc usage would), but for the case of normally
just one viewer at a time it should not be a big problem.
<p></p><p>
&nbsp; 
</p><p>
<em>stunnel 4 syntax:</em>
</p><p>
Somewhat sadly, the <code>stunnel</code> version 4 syntax is not so
amenable to the command line or scripts.  You need to create a
config file with the parameters.  E.g.:
</p><pre>  stunnel x11vnc.cfg
</pre>
Where the file <code>x11vnc.cfg</code> contains:
<pre>foreground = yes
pid =
cert = /path/to/stunnel.pem
[x11vnc_stunnel]
accept  = 5901
connect = 5900
</pre>
One nice thing about version 4 is often the PEM file does not need to be
specified because <code>stunnel</code> finds it in its installed area.
One other gotcha the PEM file is usually only readable by root (it
has the private key afterall), so you'll need to relax the permissions
or make a copy that the user running x11vnc/stunnel can read.
<p></p><p>
&nbsp; 
</p><p>
<a name="infaq_ssl-vnc-viewers"></a>
<em>SSL VNC Viewers:</em>
</p><p>
Regarding VNC viewers that "natively" do SSL unfortunately there do not
seem to be many. The 
<a href="http://web.archive.org/web/20210304200604/http://sc.uvnc.com/javaviewer/index.html">SingleClick UltraVNC Java Viewer</a>
is SSL and is compatible with <b>x11vnc</b>'s
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a> option and stunnel.)
Commercial versions of VNC seem to have some SSL-like encryption built
in, but we haven't tried those either and they probably wouldn't work
since their (proprietary) SSL-like negotiation is likely embedded in
the VNC protocol unlike our case where it is external.
</p><p>
<em>Note:</em> as of Mar/2006 <code>libvncserver/x11vnc</code>
provides a 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-viewers">SSL-enabled Java applet</a>
that can be served up via the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-httpdir"><code>-httpdir</code></a> or 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-http"><code>-http</code></a> options when
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a> is enabled.
It will also be served via HTTPS via either the VNC port (e.g. 
<code>https://host:5900/</code>) or a 2nd port via the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-https"><code>-https</code></a> option.
</p><p>
In general current SSL VNC solutions are not particularly
"seemless".  But it can be done, and with a wrapper script on the viewer
side and the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-stunnel"><code>-stunnel</code></a>
or <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a>
option on the server side it works well and is convenient.  Here is a simple
script <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#ss_vncviewer">ss_vncviewer</a> that automates running
<code>stunnel</code> on the VNC viewer side on Unix a little more carefully
than the commands printed above. (One could probably do a similar thing
with a <code>.BAT</code> file on Windows in the stunnel folder.)
</p><p>
<em><b>Update</b> Jul/2006:</em> we now provide an 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a>
package that starts up STUNNEL automatically along with some other features.
All binaries (<code>stunnel</code>, <code>vncviewer</code>, and some utilities)
are provided in the package.  It works on Unix, Mac OS X, and Windows.
</p><p>
</p><p>&nbsp;</p>

<a name="faq-ssl-tunnel-int"></a>
<a name="FAQ-54"></a>
<p><b>Q-54:</b>
<font color="#007f00">
Does <b>x11vnc</b> have built-in SSL tunneling? 
</font>
</p>
<p>
You can read about non-built-in methods
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-ext"> in the Previous FAQ</a> for background.
</p><p>
SSL tunnels provide an encrypted channel without the need for Unix
users, passwords, and key passphrases required for <code>ssh</code>
(and at the other extreme SSL can also provide a complete signed certificate chain of trust.)
On the other hand, since SSH is usually installed <em>everywhere</em>
and firewalls often let its port through, <code>ssh</code> is frequently the
path of least resistance.
</p><p>

<em>Built-in SSL x11vnc options:</em>
</p><p>
As of Feb/2006 the <b>x11vnc</b> <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a> option automates
the SSL tunnel creation on the <b>x11vnc</b> server side.  An <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-viewers">SSL-enabled Java Viewer applet</a> is also
provided that can be served via <code>HTTP</code> or <code>HTTPS</code>
to automate SSL on the client side.
</p><p>
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a> mode
uses the 
<a href="http://web.archive.org/web/20210304200604/http://www.openssl.org/">www.openssl.org</a> library if
available at build time.
</p><p>
The mode requires an SSL certificate and key (i.e. <code>.pem</code>
file.)  These are usually created via the <code>openssl(1)</code> program
(in fact in for "<code>-ssl</code>" (same as "<code>-ssl SAVE</code>") it will run <code>openssl</code>
for you automatically.)  So the SSL is not completely "built-in" since
this external tool needs to be installed, but at least <b>x11vnc</b>
runs it for you automatically.
</p><p>
An <code>-ssl</code> example:
</p><pre>  x11vnc -display :0 -ssl -passwdfile ~/mypass
</pre>
You'll get output like this:
<pre>  09/04/2006 19:27:35 Creating a self-signed PEM certificate...
  09/04/2006 19:27:35 
  ...

  The SSL VNC desktop is:  far-away.east:0
  PORT=5900
  SSLPORT=5900
</pre>
In this case <code>openssl(1)</code> was used to create a PEM automatically.
It will prompt you if you want to protect it with with a passphrase.
Use "<code>-ssl SAVE_NOPROMPT</code>" to not be prompted.  
Use "<code>-ssl TMP</code>" to create a temporary self-signed cert that
will be discarded when x11vnc exits.
<p></p><p>
<em><b>Update</b>:</em> As of Nov/2008 <b>x11vnc</b> also supports the 
<a href="http://web.archive.org/web/20210304200604/http://sourceforge.net/projects/vencrypt/">VeNCrypt</a> SSL/TLS 
tunnel extension to the VNC protocol.  The older ANONTLS method (vino) is also
supported.  This support is on by default when the <code>-ssl</code> option
is in use and can be fine-tuned using these options:
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-vencrypt"><code>-vencrypt</code></a>,
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-anontls"><code>-anontls</code></a>,
and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-sslonly"><code>-sslonly</code></a>.
</p><p>
The normal <b>x11vnc</b> <code>-ssl</code> operation is somewhat like a URL method
<code>vncs://hostname</code> if <code>vnc://hostname</code> indicates
a standard <em>unencrypted</em> VNC connection.  Just as <code>https://hostname</code>
is an SSL encrypted version of <code>http://hostname</code>.  The entire
VNC session goes through the SSL tunnel.  VeNCrypt, on the other hand,
switches to SSL/TLS early in the VNC protocol handshake.
<b>x11vnc</b> 0.9.6 supports both simultaneously when <code>-ssl</code> is active.
</p><p>
&nbsp;<br>
<em><b>SSL VNC Viewers:</b></em>.  
Viewer-side will need to use SSL as well.  See the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-viewers">next FAQ</a> and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_ssl-vnc-viewers">here</a> for SSL enabled VNC <b>Viewers</b>,
including SSVNC, to connect to the above <b>x11vnc</b> via SSL.
</p><p>&nbsp;</p>
As seen above,
the PEM (privacy enhanced mail) file does not need to be supplied if
the <code>openssl(1)</code> command is available in <code>PATH</code>,
in that case a self-signed, certificate good the current and subsequent 
<b>x11vnc</b> sessions is created (this may take a while on very
slow machines.)
<p></p><p>
In general,
the PEM file contains both the Certificate (i.e. public key) and
the Private Key.  Because of the latter, the file should be protected
from being read by untrusted users.  The best way to do this is 
to encrypt the key with a passphrase (note however this requires supplying
the passphrase each time <b>x11vnc</b> is started up.)
</p><p>
See the discussion on <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl.html">x11vnc Key Management</a>
for some utilities provided for creating and managing
certificates and keys and even for creating your own Certificate Authority (CA)
for signing VNC server and client certificates.
This may be done by importing the certificate into Web Browser or Java plugin keystores,
or pointing <code>stunnel</code> to it. 
The wrapper script <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#ss_vncviewer">ss_vncviewer</a> provides an
example on unix (see the <code>-verify</code> option.)
</p><p>
Here are some notes on the simpler default (non-CA) operation. To
have <b>x11vnc</b> save the generated certificate and key, use the
"<code>SAVE</code>" keyword like this:
</p><pre>  x11vnc -ssl SAVE -display :0 ...
</pre>
(this is the same as the default: "<code>-ssl</code>".)
This way it will be saved in the default directory <code>~/.vnc/certs/</code>
as <code>server.crt</code> (the certificate only) and <code>server.pem</code>
(both certificate and private key.)  This opens up the possibility of
copying the <code>server.crt</code> to machines where the VNC Viewer will
be run to enable authenticating the <b>x11vnc</b> SSL VNC server to the clients.
When authentication takes place this way (or via the more sophisticated
CA signing described <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl.html">here</a>),
then Man-In-The-Middle-Attacks are prevented.  Otherwise, the SSL
encryption only provides protection against passive network traffic
"sniffing" (i.e. you are not protected against M-I-T-M attacks.)  Nowadays,
most people seem mostly concerned mainly about passive sniffing (and the default
<b>x11vnc</b> SSL mode protects against it.)
Note that there are hacker tools like dsniff/webmitm and cain that implement SSL Man-In-The-Middle attacks.
They rely on the client not bothering to check the cert.
<p></p><p>&nbsp;</p>
One can test to some degree that SSL is working after starting <b>x11vnc</b>
with the <code>-stunnel</code> or <code>-ssl</code> option.
From another machine one can
use the <code>openssl</code> command something like this:
<pre> openssl s_client -debug -msg -showcerts -connect far-away.east:5900
</pre>
After all of the debugging output and informational messages you'll
see the string "<code>RFB 003.008</code>" that came from <b>x11vnc</b>.
Pointing a web browser connecting to:
<code>https://far-away.east:5900/</code> and then viewing the SSL 
certificate information about the connection in the panels will also work.
<p></p><p>
Note: If you serve up the SSL enabled Java VNC Viewer via something like:
</p><pre> x11vnc -ssl -httpdir /usr/local/share/x11vnc/classes/ssl
</pre>
(or just the <code>-http</code> option), you can test it out completely
using that, including using <code>https</code> to download it into
the browser and connect to <b>x11vnc</b>.

<p></p><p>&nbsp;</p>
<em><b>The older <code>-stunnel</code> option:</b></em>
Before the <code>-ssl</code> option there was a convenience option
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-stunnel"><code>-stunnel</code></a>
that would start an external SSL tunnel for you using <code>stunnel</code>.
The <code>-ssl</code> method is the preferred way, but for historical
reference we keep the <code>-stunnel</code> info here.
<p></p><p>
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-stunnel"><code>-stunnel</code></a> 
mode requires the
<a href="http://web.archive.org/web/20210304200604/http://stunnel.mirt.net/">stunnel.mirt.net</a> command
<code>stunnel(8)</code> to be installed on the system.
</p><p>
Some <code>-stunnel</code> examples:
</p><pre>  x11vnc -display :0 -stunnel /path/to/stunnel.pem -passwdfile ~/mypass

  x11vnc -display :0 -stunnel SAVE ...
</pre>
You'll get output like this:
<pre>  The VNC desktop is:      localhost:50
  The SSL VNC desktop is:  far-away.east:0
  PORT=5950
  SSLPORT=5900
</pre>
That indicates stunnel is listening on port 5900 for incoming SSL-wrapped
VNC connections from viewers.
<b>x11vnc</b> is listening for <em>local</em> connections on port 5950 in this case
(remote viewers cannot connect to it directly.)
For <code>-stunnel</code> to work the stunnel command must be installed
on the machine and available in <code>PATH</code> (note stunnel is often
installed in <code>sbin</code> directories rather than <code>bin</code>.)
Note that the default "<code>-stunnel</code>" by itself creates a temporary
cert (as in "<code>-ssl TMP</code>".)

<p></p><p>&nbsp;</p>

<a name="faq-ssl-tunnel-viewers"></a>
<a name="FAQ-55"></a>
<p><b>Q-55:</b>
<font color="#007f00">
How do I use VNC Viewers with built-in SSL tunneling?
</font>
</p>
<p>
<b><em>Notes on using "native" VNC Viewers with SSL:</em></b>
</p><p>
There aren't any native VNC Viewers that do SSL (ask your VNC viewer
developer to add the feature.)  So a tunnel must be setup that you
point the VNC Viewer to.  This is often STUNNEL.  You can do this <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_viewer-side-stunnel">manually</a>, or use
the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#ss_vncviewer">ss_vncviewer</a> script on Unix, or
our <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a> package
on Unix, Windows, or MacOSX.  See the next section for
Java Web browser SSL VNC Viewers (you only need a Java-enabled Web browser
for it to work.)

</p><p>
<b><em>Notes on the SSL enabled Java VNC Viewer provided in x11vnc</em></b>
<code>classes/ssl/VncViewer.jar</code>:
</p><p>
A Java applet VNC Viewer allows you to connect to a VNC Server
from a Java-enabled Web browser.
</p><p>
The SSL enabled Java VNC Viewer (<code>VncViewer.jar</code>) in
the <b>x11vnc</b> package supports
<em>only</em> SSL based connections by default.
<!--
(set the applet parameter <code>disableSSL=yes</code> in index.vnc to override.)
-->
As mentioned above the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-httpdir"><code>-httpdir</code></a> 
can be used to specify the path to <code>.../classes/ssl</code>.
A typical location might be <code>/usr/local/share/x11vnc/classes/ssl</code>.
Or <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-http"><code>-http</code></a> 
can be used to try to have it find the directory automatically.
</p><p>
Also note that the <a href="http://web.archive.org/web/20210304200604/http://sc.uvnc.com/javaviewer/index.html">SingleClick UltraVNC
Java Viewer</a> is compatible with <b>x11vnc</b>'s <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a> SSL mode.
(We tested it this way: "<code>java -cp ./VncViewer.jar VncViewer HOST far-away.east PORT 5900 USESSL 1 TRUSTALL 1</code>")
</p><p>
The Java viewer uses SSL to communicate securely with <b>x11vnc</b>.
Note that the applet can <em><b>optionally also</b></em> be downloaded into your
web browser via <code>HTTPS</code> (which is <code>HTTP</code> over <code>SSL</code>.)
This way the HTML page and the Java applet itself are <em>also</em> delivered securely with SSL
(as opposed to only the VNC traffic being encrypted with SSL.)
</p><p>
For this case the output will be something like this:
</p><pre>  x11vnc -ssl SAVE -http 
  ...
  The SSL VNC desktop is:  far-away.east:0
  Java SSL viewer URL:     https://far-away.east:5900/
  Java SSL viewer URL:     http://far-away.east:5800/
  PORT=5900
  SSLPORT=5900
</pre>
Indicating the two URLs (the first one encrypted, the second not) one could
point the web browser at to get the VNC viewer applet.
E.g. put this
<pre>   http://far-away.east:5800/
</pre>
or:
<pre>   https://far-away.east:5900/
</pre>
into your Java-enabled Web browser.
<p></p><p>
Note that KDE's Konqueror web browser seems to have problems
with https Java applets, so you'll have to use the http/5800 with it
(if you get https/5900 working let us know how you did it.)
</p><p>
If you are using a router/firewall with port-redirection, and you
are redirecting ports other than the default ones (5800, 5900) listed above
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_ssl-router-redir">see here</a>.
</p><p>
The <code>https</code> service provided thru the actual VNC
port (5900 in the above example) can occasionally be slow or unreliable
(it has to read some input and try to guess if the connection
is VNC or HTTP.)
If it is unreliable for you and you still want to serve the Java applet via
<code>https</code>, use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-https"><code>-https</code></a> option
to get an additional port dedicated to <code>https</code>
(its URL will also be printed in the output.)
</p><p>
Another possibility is to add the <code>GET</code> applet parameter:
</p><pre>  https://far-away.east:5900/?GET=1
</pre>
This will have the VNC Viewer send a special HTTP GET string
"<code>GET /request.https.vnc.connection HTTP/1.0</code>" that 
<b>x11vnc</b> will notice more quickly as a request for a VNC
connection.  Otherwise it must wait for a timeout to expire
before it assumes a VNC connection.
<p></p><p>
You may also use "<code>urlPrefix=somestring</code>" to have
<code>/somestring</code> prepended to <code>/request.https.vnc.connection</code>".
Perhaps you are using a web server <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-portal">proxy
scheme</a> to enter a firewall or otherwise have rules applied to the URL.
If you need to have any slashes "<code>/</code>" in "somestring" use
"<code>_2F_</code>" (a deficiency in libvncserver prevents using
the more natural "<code>%2F</code>".)
</p><p>
You apply multiple applet parameters in the regular URL way, e.g.:
</p><pre>  https://far-away.east:5900/?GET=1&amp;urlPrefix=mysubdir&amp;...
</pre>
<p></p><p>
All of the <b>x11vnc</b> Java Viewer applet parameters are 
described in the file <code>classes/ssl/README</code>
</p><p>
&nbsp;</p><p>
<a name="infaq_first-time-https"></a>
<em><b>Tips on Getting the SSL Java Applet Working the First Time:</b></em>&nbsp;
Unfortunately, it can be a little tricky getting the SSL VNC Java Viewer working with
<b>x11vnc</b>.  Here are some tips to getting working the first
time (afterwards you can incrementally customize with more complex settings.)
</p><ul>
<li><b>First try it on the LAN:</b>  Do <b>NOT</b> try to have it work
the first time going through firewalls, Web proxies, home
router port redirections, or Apache portal.  Just try a direct connection
over your LAN first (if you only have 1 machine and no LAN,
just do a direct connection to the same machine: <code>localhost</code>.) 
If the LAN machine you run x11vnc on has its own host-level
firewall (most linux machine come with that on by default), disable
it or at least let tcp ports 5800-6000 through. 
</li>
<li><b>First try HTTP to download the Java Applet:</b>  x11vnc
can serve both the Java Applet jar file and VNC out of the same port (both
tunneled through SSL, see below.) But it can lead to timing and
other problems. So first try HTTP instead of HTTPS to download the
Applet jar file (<code>VncViewer.jar</code>.)  That is to say try
<code>http://hostname:5800</code> in your web browser first before trying
<code>https://hostname:5900</code>. <b>x11vnc</b> will print out
the ports and URLs it is using, so use the HTTP one it prints out.
</li>
<li><b>Always Restart the Browser:</b> If you are having failures
and have to repeatedly retry things <b>ALWAYS</b> restart the browser
(i.e. completely exit it and then start a new browser process) each time.
Otherwise as you are changing things the browser may "remember"
failed applet downloads, etc. and just add to the confusion and irreproducibility.
If you see it trying to download
<code>VncViewer.class</code> (instead of <code>VncViewer.jar</code>)
you know it is really confused and needs to be restarted.
</li>
<li><b>Step Lively:</b> If you get Browser or Java VM or VNC Viewer applet dialog
boxes saying things like "Do you want to trust this certificate?"
or "The hostname does not match the one on the certificate", etc.
just go through them as quickly as possible.
<b>x11vnc</b> cannot wait forever for each SSL connection, and
so if you dawdle too long inspecting the certs, etc it can lead
to problems.  Get it working first before taking your time to
read the details in the dialogs, etc.
</li>
<li><b>No inetd, Please:</b> Even if you intend to deploy via
<code>inetd</code> or <code>xinetd</code> eventually, 
get that working <b>later</b> (and remember do not use something like
"<code>-ssl TMP</code>" that creates a new temporary SSL certificate
for every new socket connection.)
</li>
<li><b>Nothing Fancy:</b> Do not try fancy stuff like
<code>-svc</code>,
<code>-create</code>,
<code>-unixpw</code>,
"<code>-users unixpw=</code>",
"<code>-users sslpeer=</code>",
<code>-sslverify</code>, etc.
Just get the simplest connection working first and then 
incrementally add what you need.
</li>
</ul>
So the recommended test command lines are:
<pre>   x11vnc -ssl SAVE -http
   x11vnc -ssl SAVE -httpdir /path/to/x11vnc/classes/ssl
</pre>
Use the latter if <b>x11vnc</b> cannot automatically
find the <code>classes/ssl</code> directory (this what the
<code>-http</code> option instructs it to do.)
Then point your browser to the HTTP (not HTTPS) URL
it prints out.
<p></p><p>
Following the above guidelines, did it work?  If so,
Congratulations!! you created an SSL encrypted connection
between the SSL Java applet running in your web browser and
<b>x11vnc</b>.  The fact that you used HTTP instead of
HTTPS to download the applet is not the end of the world
(some users do it this way), the main thing is that the
<em><b>VNC</b></em> traffic is encrypted with SSL.
If you are having trouble even with the above baseline
test case feel free to contact me (please send the
<em>Full</em> x11vnc output, not just part of it;
the complete x11vnc command line; the URL(s) entered in the browser;
the full Java Console output; and anything else you can think of.)
</p><p>
Next, you can add the features you want one by one testing it still
works each time.  I suggest first turning on the HTTPS applet download
(<code>https://hostname:5900</code>) if that is what you intend to use.
That one gives the most trouble because of the ambiguity of passing two
different protocols (HTTP and VNC) through the same SSL service
port.
</p><p>
Next, turn on <code>inetd</code> if you intend to
use that (this can be tricky too, be sure to use <code>-oa logfile</code>
and inspect it carefully if there are problems.)  If you are going to use non-standard
ports (e.g. "<code>-rfbport 443</code>" as root), work on that next.
Then enable the firewall, router port redirection
channel (you will somehow need to be outside to do that, maybe
test that through another VNC session.)
</p><p>
Then, if you plan to use them, enable "fancy stuff" like
"<code>-svc</code>" or "<code>-unixpw</code>", etc, etc.
Be sure to add a password either "<code>-rfbauth</code>" or
"<code>-unixpw</code>" or both.  If you need to have the web browser
use a corporate
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-java-viewer-proxy">Web Proxy</a> (i.e. it cannot connect
directly) work on that last.
Ditto for the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-portal">Apache portal</a>.

</p><p>
&nbsp;</p><p>
<a name="infaq_ssl-router-redir"></a>
<b><em>Router/Firewall port redirs:</em></b>&nbsp;
If you are doing port redirection at your <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#firewalls">router</a> to an internal machine
running <b>x11vnc</b> AND the internet facing port is different from the
internal machine's VNC port, you will need to apply the <code>PORT</code>
applet parameter to indicate to the applet the Internet facing port
number (otherwise by default the internal machine's port, say 5900, is
sent and that of course is rejected at the firewall/router.)  For example:
</p><pre>  https://far-away.east:443/?GET=1&amp;PORT=443
</pre>
So in this example the user configures his router to redirect connections
to port 443 on his Internet side to, say, port 5900 on the internal
machine running <b>x11vnc</b>.  See also the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-httpsredir"><code>-httpsredir</code></a>
option that will try to automate this for you.
<p></p><p>
To configure your router to do port redirection, see its instructions.
Typically, from the inside you point a web browser to a special URL
(e.g. http://192.168.1.1) and you get a web interface to configure it.
Look for something like "Port Redirection" or "Port Forwarding", probably
under "Advanced" or something like that.  If you have a Linux or Unix
system acting as your firewall/router, see its firewall configuration.
</p><p>
You can also use <b>x11vnc</b> options
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rfbport"><code>-rfbport NNNNN</code></a> 
and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-httpport"><code>-httpport NNNNN</code></a> 
to match the ports that your firewall will be redirecting to the machine
where <b>x11vnc</b> is run.
</p><p>
&nbsp;</p><p>
<b><em>Tedious Dialogs:</em></b>
If you do serve the SSL enabled Java viewer via <code>https</code>
be prepared for quite a number of "are you sure you trust this
site?" dialogs:
</p><ul>
<li>
First from the Web browser that cannot verify the self-signed certificate
when it downloads <code>index.vnc</code>.
</li>
<li>
From the Web browser again noting that the common name on the certificate
does not match the hostname of the remote machine.
</li>
<li>
Next from the Java VM that cannot verify the self-signed certificate
when it downloads <code>VncViewer.jar</code>.
</li>
<li>
And also from the Java VM again noting that the common name on the
certificate does not match the hostname of the remote machine.
</li>
<li>
Finally from the Java VncViewer applet itself saying it cannot verify the
certificate! (or a popup asking you if you want to see the certificate.)
</li>
</ul>
Note that sometimes if you pause too long at one of the above dialogs
then <b>x11vnc</b> may exceed a timeout and assume the current
socket connection is VNC instead of the HTTPS it actually
is (but since you have paused too long at the dialog the
GET request comes too late.)  Often hitting Reload and going
through the dialogs more quickly will let you connect.  
<b>The Java VM dialogs are the most important ones to NOT linger at</b>.
If you see in the <b>x11vnc</b> output a request for <code>VncViewer.class</code>
instead of <code>VncViewer.jar</code> it is too late... you <b>will</b>
need to completely restart the Web browser to get it to try for the
jar again.
You can use the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-https"><code>-https</code></a>
option if you want a dedicated port for HTTPS connections instead of
sharing the VNC port.
<p></p><p>
To see example <b>x11vnc</b> output for a successful
<code>https://host:5900/</code> connection with the Java Applet
see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl-output.html">This Page</a>.
And here is a newer example <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/java_console_direct.html">including the Java Console output</a>.
</p><p>
All of the <b>x11vnc</b> Java Viewer applet parameters are 
described in the file <code>classes/ssl/README</code>
</p><p>
&nbsp;</p><p>
<a name="infaq_ss_vncviewer">
</a><a name="ss_vncviewer">
<b><em>Notes on the VNC Viewer ss_vncviewer wrapper script:</em></b>
</a></p><p><a name="ss_vncviewer">
If you want to use a native VNC Viewer with the SSL enabled <b>x11vnc</b>
you will need to run an external SSL tunnel on the Viewer side.
There do not seem to be any native SSL VNC Viewers outside of our
<b>x11vnc</b> and </a><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">SSVNC</a> packages.
The basic ideas of doing this were discussed <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-ext">for external
tunnel utilities here</a>.
</p><p>
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ss_vncviewer">ss_vncviewer</a> script provided with
<b>x11vnc</b> and SSVNC can set up the <code>stunnel</code> tunnel
automatically on unix as long as the <code>stunnel</code> command
is installed on the Viewer machine and available in PATH (and
<code>vncviewer</code> too of course.)  Note that on a Debian based
system you will need to install the package <code>stunnel4</code>
not <code>stunnel</code>.  You can set the environment variables
<code>STUNNEL</code> and <code>VNCVIEWERCMD</code> to point to the
correct programs if you want to override the defaults.
</p><p>
Here are some examples:
</p><pre>  1)  ss_vncviewer far-away.east:0
  
  2)  ss_vncviewer far-away.east:0 -encodings "copyrect tight zrle hextile"
  
  3)  ss_vncviewer -verify ./server.crt far-away.east:0
  
  4)  ss_vncviewer -mycert ./client.pem far-away.east:0
 
  5)  ss_vncviewer -proxy far-away.east:8080 myworkstation:0
</pre>
The first one is the default mode and accepts the <b>x11vnc</b>
certificate without question.
The second one is as the first, but adds the <code>-encodings</code>
options to the <code>vncviewer</code> command line.
<p></p><p>
The third one requires that the <b>x11vnc</b> server authenticate
itself to the client against the certificate in the file <code>./server.crt</code>
(e.g. one created by "<code>x11vnc -ssl SAVE</code>" and safely copied to the
VNC viewer machine.)
</p><p>
The fourth one is for VNC Viewer authentication, it
uses <code>./client.pem</code> to authenticate itself to <b>x11vnc</b>.
One can supply both <code>-verify</code> and <code>-mycert</code>
simultaneously.
</p><p>
The fifth one shows that Web proxies can be used if that is the 
only way to get out of the firewall.  If the "double proxy"
situation arises separate the two by commas.  See <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl-portal.html">
this page</a> for more information on how Web proxies come into play.
</p><p>
If one uses a Certificate Authority (CA) scheme described 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl.html">here</a>, the wrapper script would use the CA cert
instead of the server cert:
</p><pre>  3')  ss_vncviewer -verify ./cacert.crt far-away.east:0
</pre>
<p></p><p>
<em><b>Update</b> Jul/2006:</em> we now provide an 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a>
package that starts up STUNNEL automatically along with some other features.
All binaries (<code>stunnel</code>, <code>vncviewer</code>, and some utilities)
are provided in the package.  It works on Unix, Mac OS X, and Windows.
</p><p>&nbsp;</p>

<a name="faq-ssl-java-viewer-proxy"></a>
<a name="FAQ-56"></a>
<p><b>Q-56:</b>
<font color="#007f00">
How do I use the Java applet VNC Viewer with built-in SSL tunneling when going
through a Web Proxy?
</font>
</p>
<b><em>The SSL enabled Java VNC Viewer and firewall Proxies</em></b>:
<p></p><p>
SSL and HTTPS aside, there is a general problem with Firewall Proxies and
Java Applets that open sockets.  The applet is downloaded successfully
(through the browser) using HTTP and the proxy, but when the applet tries
to reconnect to the originating host (the only one allowed by security)
it does not use the proxy channel.  So it cannot reconnect to the server
the applet came from!
</p><p>
We have found a convenient workaround: in the directory where
<code>VncViewer.jar</code> resides there is a digitally
<em><b>signed</b></em> version of the same applet called
<code>SignedVncViewer.jar</code>.  Since the applet is digitally signed,
there will be an additional dialog from the Java VM plugin asking you
if you want to trust the applet fully.
</p><p>
You should say "Yes". If you do, the applet will be run in a mode where
it can try to determine the firewall proxy host name and port (it will
ask you for them if it cannot find them.)  This way it can connect
<em>directly</em> to the Proxy and then request the <code>CONNECT</code>
method to be redirected to the originating host (the <b>x11vnc</b> VNC
Server.)  SSL is then layered over this socket.
</p><p>
To do this you should use the <code>proxy.vnc</code> HTML file like via
this URL in your browser:
</p><pre>  https://yourmachine.com:5900/proxy.vnc
</pre>
(instead of the unsigned one in <code>https://yourmachine.com:5900/</code>
that gives the default <code>index.vnc</code>)
<p></p><p>
</p>
<b><em>Proxies that limit <code>CONNECT</code> to ports 443 and 563</em></b>:
<p></p><p>
Things become trickier if the Web proxy <b>restricts</b> which <code>CONNECT</code>
ports can be redirected to.  For security, some (most?) proxies only allow
port 443 (HTTPS) and 563 (SNEWS) by default.  In this case, the only
thing to do is run <b>x11vnc</b> on that low port, e.g. "<code>-rfbport
443</code>", (or use a port redirection on, say, a firewall or router
port 443 to the internal machine.)
</p><p>
If you do such a redirection to an internal machine <em>and</em> <b>x11vnc</b>
is not listening on port 443, you will probably need to edit
<code>proxy.vnc</code>.  Suppose the SSL <b>x11vnc</b> server was
listening on port 5901. You should change the line in <code>proxy.vnc</code>
from:
</p><pre>  &lt;param name=PORT value=$PORT&gt;
</pre>
to:
<pre>  &lt;param name=PORT value=443&gt;
</pre>
Since otherwise <code>$PORT</code> will be expanded to 5901 by
<b>x11vnc</b> and the viewer applet will fail to connect to that port on the
firewall.
<p></p><p>
Another way to achieve the same thing is to use the applet <code>PORT</code>
parameter:
</p><pre>  https://yourmachine.com/proxy.vnc?PORT=443
</pre>
this is cleaner because it avoids editing the file, but requires
more parameters in the URL.
See also the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-httpsredir"><code>-httpsredir</code></a>
<b>x11vnc</b> option that will try to automate this for you.
To use the GET
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-viewers">trick discussed above</a>, do:
<pre>  https://yourmachine.com/proxy.vnc?GET=1&amp;PORT=443
</pre>
<p></p><p>
All of the <b>x11vnc</b> Java Viewer applet parameters are 
described in the file <code>classes/ssl/README</code>
</p><p>
Here is an example of Java Console and x11vnc output for the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/java_console_proxy.html">Web proxy case</a>.
</p><p>
&nbsp;<br>
Note that both the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#ss_vncviewer">ss_vncviewer</a> stunnel
Unix wrapper script
and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a>
can use Web proxies as well even though they do not involve a Web browser.
</p><p>&nbsp; </p><p>

<a name="faq-ssl-portal"></a>
<a name="FAQ-57"></a>
</p><p><b>Q-57:</b>
<font color="#007f00">
Can Apache web server act as a gateway for users to connect via SSL
from the Internet with a Web browser to <b>x11vnc</b> running on their
workstations behind a firewall?
</font>
</p>
Yes. You will need to configure apache to forward these connections.
It is discussed <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl-portal.html">here</a>.  This SSL VNC portal provides a
clean alternative to the traditional method where the user uses SSH
to log in through the gateway to create the encrypted port redirection
to <b>x11vnc</b> running on her desktop.
<p></p><p>
Also see the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-web-login">desktop.cgi</a> CGI script method
that achieves much of what this Apache VNC SSL portal method does (as long
as desktop.cgi's 'port redirection' mode is enabled.)
</p><p>&nbsp; </p><p>

<a name="faq-ssl-ca"></a>
<a name="FAQ-58"></a>
</p><p><b>Q-58:</b>
<font color="#007f00">
Can I create and use my own SSL Certificate Authority (CA) with <b>x11vnc</b>?
</font>
</p>
Yes, see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl.html">this page</a> for how to do this and
the utility commands <b>x11vnc</b> provides to create and manage
many types of certificates and private keys.
<p></p><p>&nbsp; </p><p>


&nbsp;<br><font size="-0"><b>[Display Managers and Services]</b></font><br>
<a name="faq-service"></a>
<a name="FAQ-59"></a>
</p><p><b>Q-59:</b>
<font color="#007f00">
How can I run <b>x11vnc</b> as a "service" that is always available?
</font>
</p>
<p>
There are a number of ways to do this.  The primary thing you need to
decide is whether you want <b>x11vnc</b> to connect to the X session on
the machine 1) regardless of who (or if anyone) has the X session, or 2)
only if a certain user has the X session.  Because X sessions are
protected by X permissions (MIT-MAGIC-COOKIE files <code>XAUTHORITY</code>
and <code>$HOME/.Xauthority</code>) the automatically started
<b>x11vnc</b> will of course need to have sufficient permissions to
connect to the X display.
</p><p>
Here are some ideas:
</p><ul>
	<li>Use the description under "Continuously" in the
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_display-manager-continuously">FAQ on <b>x11vnc</b> and Display Managers</a></li>
	<li>Use the description in the
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-inetd">FAQ on <b>x11vnc</b> and <code>inetd(8)</code></a></li>
	<li>Use the description in the
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-userlogin">FAQ on Unix user logins and <code>inetd(8)</code></a></li>
	<li>Start <b>x11vnc</b> from your <code>$HOME/.xsession</code> (or
	<code>$HOME/.xinitrc</code> or autostart script or ...)</li>
	<li>Although less reliable, see the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_x11vnc_loop">x11vnc_loop</a>
	<code>rc.local</code> hack below.
</li></ul>
The display manager scheme will not be specific to which user has the X
session unless a test is specifically put into the display startup
script (often named <code>Xsetup</code>.)  The <code>inetd(8)</code> scheme may or
may not be specific to which user has the X session (and it may not be able
to do all users via the <code>XAUTHORITY</code> permission issues.)
<p></p><p>
The <code>.xsession</code>/<code>.xinitrc</code> scheme is obviously
is specific to a particular user and only when they are logged into X.
If you do not know what a <code>$HOME/.xsession</code> script is or
how to use one, perhaps your desktop has a "session startup commands"
configuration option.  The command to be run in the <code>.xsession</code>
or <code>.xinitrc</code> file may look like this:
</p><pre>x11vnc -logfile $HOME/.x11vnc.log -rfbauth $HOME/.vnc/passwd -forever -bg
</pre>
plus any other options you desire.
<p></p><p>
Depending on your desktop and/or OS/distribution the automatically run
X startup scripts (traditionally <code>.xsession</code>/<code>.xinitrc</code>)
may have to be in a different directory or have a different basename.
One user recommends the description under 'Running Scripts Automatically' at
<a href="http://web.archive.org/web/20210304200604/http://club.mandriva.com/xwiki/bin/view/KB/XwinXset">this link</a>.
</p><p>
<b><em>Firewalls:</em></b> note all methods will require the host-level
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#firewalls">firewall</a> to be configured to allow connections in on a port.
E.g. 5900 (default VNC port) or 22 (default SSH port for tunnelling VNC.)
Most systems these days have firewalls turned on by default, so you
will actively have to do something to poke a hole in the firewall at
the desired port number.
See your system administration tool for Firewall settings (Yast, Firestarter, etc.)
</p><p>&nbsp;</p>

<a name="faq-display-manager"></a>
<a name="FAQ-60"></a>
<p><b>Q-60:</b>
<font color="#007f00">
How can I use <b>x11vnc</b> to connect to an X login screen like
<code>xdm</code>, GNOME <code>gdm</code>,
KDE <code>kdm</code>, or CDE <code>dtlogin</code>? 
(i.e. nobody is logged into an X session yet.)
</font>
</p>
<p>
We describe two scenarios here.  The first is called '<b>One time only</b>'
meaning you just need to do it quickly once and don't want to repeat;
and the second is called '<b>Continuously</b>' meaning you want the access
to be available after every reboot and after every desktop logout.
</p><hr noshade="1" size="2">
<b>One time only:</b>
&nbsp;&nbsp;If the X login screen is running and you just want to connect
to it once (i.e. a one-shot): 
<p></p>
<p>
It is usually possible to do this by just adjusting the
<code>XAUTHORITY</code> environment variable to point to the correct MIT-COOKIE
auth file while running <b>x11vnc</b> as <b>root</b>, e.g. for the gnome
display manager, GDM:
</p><pre>  x11vnc -auth /var/gdm/:0.Xauth -display :0
</pre>
(the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-auth"><code>-auth</code></a> option sets 
the <code>XAUTHORITY</code> variable for you.)
<p></p><p>
There will be a similar thing to do for <code>xdm</code> using
however a different auth directory path (perhaps something like
<code>/var/lib/xdm/authdir/authfiles/A:0-XQvaJk</code>) for the
<code>xdm</code> greeter or <code>/var/lib/kdm/A:0-crWk72</code> (or
<code>/var/run/xauth/A:0-qQPftr</code>, etc. etc) for the <code>kdm</code>
greeter.  Of course, the random characters in the file basename will vary
and you will need to use the actual filename on your system.
Read your system docs to find out where the display manager cookie files
are kept.
</p><p>
<b>Trick:</b> sometimes <code>ps(1)</code> can reveal the X server process
<code>-auth</code> argument (e.g. "<code>ps wwaux | grep auth</code>")
and hence the path to the auth file.
</p><p>
x11vnc <em>must</em> be run as root for this because the
<code>/var/gdm/:0.Xauth</code>, <code>/var/lib/kdm/A:0-crWk72</code>,
etc. auth files are only readable by root.  If you do not want to run
x11vnc as root, you can copy (as root or sudo) the auth file to some
location and make it readable by your userid.  Then run x11vnc as your
userid with <code>-auth</code> pointed to the copied file.
</p><p>
<em><b>Update</b> Dec/2009:</em> use "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-auth"><code>-auth guess</code></a>"
to have <b>x11vnc</b> try to guess the location of the auth file for you.
</p><p>
You next connect to <b>x11vnc</b> with a VNC viewer, give your username
and password to the X login prompt to start your session.
</p><p>
<a name="infaq_gdm"></a>
<em><b>Note:</b></em>&nbsp; GDM: <code>gdm</code> seems to have an annoying setting that causes
<b>x11vnc</b> (and any other X clients) to be killed after the 
user logs in.  Setting <code>KillInitClients=false</code>
in the <code>[daemon]</code> section
of <code>/etc/X11/gdm/gdm.conf</code> (or <code>/etc/gdm/gdm.conf</code>, etc.) avoids this.
Otherwise, just restart <b>x11vnc</b> and then reconnect your viewer.
Other display managers (kdm, etc) may also have a similar problem.
One user reports having to alter "<code>gdm.conf-custom</code>" as well.
</p><p>
<em><b>Note:</b></em>&nbsp; Solaris: For <code>dtlogin</code> in addition to the above sort of trick (BTW, the
auth file should be in <code>/var/dt</code>), you'll
also need to add something like <code>Dtlogin*grabServer:False</code>
to the <code>Xconfig</code> file (<code>/etc/dt/config/Xconfig</code>
or <code>/usr/dt/config/Xconfig</code> on Solaris, see 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_dtlogin_solaris">the example</a>
at the end of this FAQ.)  Then restart <code>dtlogin</code>,
e.g.: <code>/etc/init.d/dtlogin stop; /etc/init.d/dtlogin start</code>
or reboot.
</p><p>
<em><b>Update</b> Nov/2008:</em>
Regarding GDM KillInitClients: see the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-reopen"><code>-reopen</code></a> option
for another possible workaround.
</p><p>
<em><b>Update</b> Oct/2009:</em>
Regarding GDM KillInitClients: starting with x11vnc 0.9.9 it will
try to apply heuristics to detect if a window manager is not running
(i.e. whether the Display Manager Greeter Login panel is still up.)
If it thinks the display manager login is still up it will delay creating
windows or using XFIXES.  The former is what GDM uses to kill the
initial clients, use of the latter can cause a different problem: an Xorg
server crash.  So with 0.9.9 and later it should all work without needing
to set <code>KillInitClients=false</code> (which is a good because
recent GDM, v2.24, has removed this option) or use <code>-noxfixes</code>.
To disable the heuristics and delaying set
<code>X11VNC_AVOID_WINDOWS=never</code>; to set the delay time explicitly
use, e.g., <code>X11VNC_AVOID_WINDOWS=120</code> (delays for 120 seconds
after the VNC connection; you have that long to log in.)
</p>
&nbsp;<br>
<hr noshade="1" size="2">
<a name="infaq_display-manager-continuously"></a>
<p><b>Continuously:</b>
&nbsp;&nbsp;Have <b>x11vnc</b> reattach each time the X server 
is restarted (i.e. after each logout and reboot):
</p><p>
To make <b>x11vnc</b> always attached to the X server
including the login screen you will need to add a command to a
display manager startup script.
</p><p>
Please consider the security implications of this!
The VNC display for the X session always accessible (but hopefully
password protected.)
Add <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-localhost"><code>-localhost</code></a>
if you only plan to access via a
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#tunnelling">SSH tunnel</a>.
</p><p>
The name of the display manager startup script file depends on desktop
used and seem to be:
</p><pre>     GDM (GNOME)  /etc/X11/gdm/Init/Default
                  /etc/gdm/Init/Default
     KDM (KDE)    /etc/kde*/kdm/Xsetup
     XDM          /etc/X11/xdm/Xsetup          (or sometimes xdm/Xsetup_0)
     CDE          /etc/dt/config/Xsetup
</pre>
although the exact location can be operating system, distribution,
and time dependent.  See the documentation for your display manager:&nbsp;
<code>gdm(1), kdm(1), xdm(1), dtlogin(1)</code> for additional details.
There may also be display number specific scripts: e.g. <code>Xsetup_0</code>
vs. <code>Xsetup</code>, you need to watch out for.
<p></p><p>
<b><em>Note:</em></b>&nbsp; You should read and understand all of the
Note's and Update's in the '<b>One time only</b>' section above.
All of the GDM topics apply here as well:
</p><p>
<b><em>Note:</em></b>&nbsp; GDM: The above (in 'One time only') <code>gdm</code> setting of
<code>KillInitClients=false</code> in <code>/etc/X11/gdm/gdm.conf</code>
(or <code>/etc/gdm/gdm.conf</code>, etc.)
for GDM is needed here as well. Other display managers (KDM, etc) may also have a similar problem.
</p><p>
Also see the <em><b>Update</b> Oct/2009</em> above where x11vnc 0.9.9 and
later automatically avoids being killed.
</p><p>
<b><em>Note:</em></b>&nbsp; DtLogin: The above (in 'One time only') <code>Dtlogin*grabServer:False</code> step for
Solaris will be needed for <code>dtlogin</code> here as well.
<br>&nbsp;<br>
</p><p>
In any event, the line you will add to the display manager script
(Xsetup, Default, or whatever) will look something like:
</p><pre>  /usr/local/bin/x11vnc -rfbauth /path/to/the/vnc/passwd -o /var/log/x11vnc.log -forever -bg
</pre>
where you should customize the exact command to your needs
(e.g.  <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-localhost"><code>-localhost</code></a>
for SSH tunnel-only access;
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl SAVE</code></a> for SSL access; etc.)

<p></p><p>
<em>Happy, happy, joy, joy:</em>&nbsp; Note that we do not need to
specify <code>-display</code> or <code>-auth</code>
because happily they are already set for us in the <code>DISPLAY</code>
and <code>XAUTHORITY</code> environment variables for the <code>Xsetup</code>
script!!!
</p><p>
You may also want to force the VNC port with something like "<code>-rfbport 5900</code>"
(or <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-N"><code>-N</code></a>) 
to avoid autoselecting one if 5900 is already taken.
</p><p>
<a name="infaq_gdm_fedora"></a>
</p><hr noshade="1" size="1">
<b>Fedora/gdm:</b>
Here is an example of what we did on a vanilla install of Fedora-C3 (seems
to use <code>gdm</code> by default.)
Add a line like this to <code>/etc/X11/gdm/Init/:0</code>
<pre>  /usr/local/bin/x11vnc -rfbauth /etc/x11vnc.passwd -forever -bg -o /var/log/x11vnc.log
</pre>
And then add this line to <code>/etc/X11/gdm/gdm.conf</code> (or <code>/etc/gdm/gdm.conf</code>, etc.) in the
<code>[daemon]</code> section:
<pre>  KillInitClients=false
</pre>
Then restart: <code>/usr/sbin/gdm-restart</code> (or reboot.)
The <code>KillInitClients=false</code> setting is important: without it
<b>x11vnc</b> will be killed immediately after the user logs in.
Here are
<a href="http://web.archive.org/web/20210304200604/http://www.jirka.org/gdm-documentation/x241.html">full details on how to configure <code>gdm</code></a>
<p></p><p>
</p><hr noshade="1" size="1">
<a name="infaq_dtlogin_solaris"></a>
<b>Solaris/dtlogin:</b>
Here is an example of what we did on a vanilla install of Solaris:
<br>
Make the directory /etc/dt/config:
<pre>  mkdir -p /etc/dt/config
</pre>
Copy over the Xconfig file for customization:
<pre>  cp /usr/dt/config/Xconfig /etc/dt/config/Xconfig
</pre>
Edit /etc/dt/config/Xconfig and uncomment the line:
<pre>  Dtlogin*grabServer:        False
</pre>
Next, copy over Xsetup for customization:
<pre>  cp /usr/dt/config/Xsetup /etc/dt/config/Xsetup
</pre>
Edit /etc/dt/config/Xsetup and at the bottom put a line like:
<pre>  /usr/local/bin/x11vnc -forever -o /var/log/x11vnc.log -bg
</pre>
(tweaked to your local setup and preferences, a password via
<code>-rfbauth</code>, etc. would be a very good idea.)
<p></p><p>
Restart the X server and dtlogin:
</p><pre>  /etc/init.d/dtlogin stop
  /etc/init.d/dtlogin start
</pre>
(or reboot or maybe just restart the X session.)
<a name="infaq_kdm_fedora"></a>
<hr noshade="1" size="1">
<b>KDM:</b>
One user running the <code>kdm</code> display manager reports putting
this line:
<pre>  x11vnc -forever -rfbauth /home/xyz/.vnc/passwd -bg -o /var/log/x11vnc.log
</pre>
in <code>/etc/kde/kdm/Xsetup</code>.  After rebooting the system it
all seemed to work fine.
<p></p><p>
</p><hr noshade="1" size="1">
<p></p><p>
&nbsp;<br>
<a name="infaq_x11vnc_loop"></a>
If you do not want to deal with any display manager startup scripts, here is
a kludgey script that can be run manually or out of a boot file like <code>rc.local</code>:
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_loop">x11vnc_loop</a>
It will need some local customization before running.  Because the 
<code>XAUTHORITY</code> auth file must be guessed by this script, use of
the display manager script method described above is greatly preferred.
There is also the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-loop"><code>-loop</code></a> option that does something
similar.
</p><p>If the machine is a traditional Xterminal you may want to
read <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xterminal-xauth">this FAQ</a>.
<br>&nbsp;
</p><p>
<b><em>Firewalls:</em></b> note all methods will require the host-level
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#firewalls">firewall</a> to be configured to allow connections in on a port.
E.g. 5900 (default VNC port) or 22 (default SSH port for tunnelling VNC.)
Most systems these days have firewalls turned on by default, so you
will actively have to do something to poke a hole in the firewall at
the desired port number.
See your system administration tool for Firewall settings (Yast, Firestarter, etc.)
<br>&nbsp;
</p><p>&nbsp;</p>

<a name="faq-inetd"></a>
<a name="FAQ-61"></a>
<p><b>Q-61:</b>
<font color="#007f00">
Can I run <b>x11vnc</b> out of <code>inetd(8)</code>?
How about <code>xinetd(8)</code>?
</font>
</p>
<p>
Yes, perhaps a line something like this in <code>/etc/inetd.conf</code> will do it for you:
</p><p>
</p><pre>  5900 stream tcp nowait root /usr/sbin/tcpd /usr/local/bin/x11vnc_sh
</pre>
where the shell script <code>/usr/local/bin/x11vnc_sh</code>
uses the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-inetd"><code>-inetd</code></a>
option and looks something like (you'll need to customize to your
settings.)
<pre>#!/bin/sh
/usr/local/bin/x11vnc -inetd -display :0 -auth /home/fred/.Xauthority \
	-rfbauth /home/fred/.vnc/passwd -o /var/log/x11vnc_sh.log
</pre>
<em>Important:</em>&nbsp; Note that you must redirect the standard error output to a log file
(e.g. <code>-o logfile</code>) or "<code>2&gt;/dev/null</code>" for proper
operation via <code>inetd</code> (otherwise the standard error also
goes to the VNC vncviewer, and that confuses it greatly, causing it
to abort.)
If you do <i>not</i> use a wrapper script as above but rather call
<b>x11vnc</b> directly in <code>/etc/inetd.conf</code> and do not
redirect stderr to a file, then you <i>must</i> specify the <code>-q</code>
(aka <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-q,"><code>-quiet</code></a>) option:
"<code>/usr/local/bin/x11vnc -q -inetd ...</code>".
When you supply both <code>-q</code> and <code>-inet</code> and no
"<code>-o logfile</code>" then stderr will automatically be closed
(to prevent, e.g. library stderr messages leaking out to the viewer.)
The recommended practice is to use "<code>-o logfile</code>" to collect
the output in a file or wrapper script with "<code>2&gt;logfile</code>"
redirection because the errors and warnings printed out are very useful
in troubleshooting problems.
<p></p><p>
Note also the need to set <code>XAUTHORITY</code> via 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-auth"><code>-auth</code></a>
to point to the MIT-COOKIE auth file to get permission
to connect to the X display (setting and exporting the
<code>XAUTHORITY</code> variable accomplishes the same thing.) See the
<code>x11vnc_loop</code> file in the previous question for more ideas
on what that auth file may be, etc.
The scheme described in the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-userlogin">FAQ on Unix user logins and <code>inetd(8)</code></a>
works around the <code>XAUTHORITY</code> issue nicely.
</p><p>
<em>Note:</em>&nbsp; On Solaris you cannot have the bare number <code>5900</code> in
<code>/etc/inetd.conf</code>, you'll need to replace it with a word
like <code>x11vnc</code> an then put something like 
"<code>x11vnc 5900/tcp</code>" in <code>/etc/services</code>.
</p><p>
Since the process runs as root, it might be a bad idea to have the logfile
in a world-writable area like <code>/tmp</code> if there are untrustworthy
users on the machine.  Perhaps <code>/var/log</code> is a better place.
</p><p>
Be sure to look at your <code>/etc/hosts.allow</code> and
<code>/etc/hosts.deny</code> settings to limit the machines that can
connect to this service (your desktop!)  For the above example with
<code>/etc/hosts.allow</code>:
</p><pre>  x11vnc_sh : 123.45.67.89
</pre>
<p></p><p>
A really safe way to do things is to limit the above <code>inetd</code>
to <code>localhost</code> only (via <code>/etc/hosts.allow</code>)
and use <code>ssh</code> to tunnel the incoming
connection.  Using <code>inetd</code> for this prevents there being a
tiny window of opportunity between <b>x11vnc</b> starting up and your
<b>vncviewer</b> connecting to it.  Always use a VNC password to further protect
against unwanted access.
</p><p>
For <code>xinetd(8)</code>, one user reports he
created the file <code>/etc/xinetd.d/x11vncservice</code> containing
the following:
</p><pre># default: off
# description:
service x11vncservice
{
        flags           = REUSE NAMEINARGS
        port            = 5900
        type            = UNLISTED
        socket_type     = stream
        protocol        = tcp
        wait            = no
        user            = root
        server          = /usr/sbin/tcpd
        server_args     = /usr/local/bin/x11vnc_sh
        disable         = no
}
</pre>
With the contents of <code>/usr/local/bin/x11vnc_sh</code>
similar to the example given above.
One user reports this works with avoiding the wrapper script:
<pre>service x11vncservice
{
        port            = 5900
        type            = UNLISTED
        socket_type     = stream
        protocol        = tcp
        wait            = no
        user            = root
        server          = /usr/local/bin/x11vnc
        server_args     = -inetd -q -display :0 -auth /var/gdm/:0.Xauth
        disable         = no
}
</pre>
(or one can replace the <code>-q</code> with say "<code>-o /var/log/x11vnc.log</code>"
to capture a log)
<p></p><p>
The above works nicely for GDM because the -auth file is a fixed
name.  For KDM or XDM the filename varies.  Here is one idea for a
<code>x11vnc_sh</code> wrapper to try to guess the name:
</p><pre>#!/bin/sh
COLUMNS=256
export COLUMNS
authfile=`ps wwaux | grep '/X.*-auth' | grep -v grep | sed -e 's/^.*-auth *//' -e 's/ .*$//' | head -n 1`

if [ -r "$authfile" ]; then
        exec /usr/local/bin/x11vnc -inetd -o /var/log/x11vnc.log -display :0 -auth "$authfile"
fi
exit 1
</pre>
Starting with <b>x11vnc</b> 0.9.3 this can be automated by:
<pre>#!/bin/sh
exec /usr/local/bin/x11vnc -inetd -o /var/log/x11vnc.log -find -env FD_XDM=1
</pre>
<p></p><p>&nbsp;</p>

<a name="faq-avahi"></a>
<a name="FAQ-62"></a>
<p><b>Q-62:</b>
<font color="#007f00">
Can I have <b>x11vnc</b> advertise its VNC service and port via mDNS / Zeroconf
(e.g. Avahi) so VNC viewers on the local network can detect it automatically?
</font>
</p>
<p>
Yes, as of Feb/2007 <b>x11vnc</b> supports mDNS / Zeroconf advertising of its
service via the Avahi client library.  Use the option
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-avahi">-avahi</a> 
(same as <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-mdns">-mdns</a> or <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-zeroconf">-zeroconf</a>) to enable it. 
Depending on your setup you may need to install 
<a href="http://web.archive.org/web/20210304200604/http://www.avahi.org/">Avahi</a> (including the development/build
packages), enable the server: <code>avahi-daemon</code> and
<code>avahi-dnsconfd</code>, and possibly open up UDP port 5353 on your firewall.
</p><p>
If the Avahi client library or build environment is not available at
build-time, then at run-time <b>x11vnc</b> will try to look for external
helper programs, <code>avahi-browse(1)</code> or <code>dns-sd(1)</code>,
to do the work.
</p><p>
The service was tested with Chicken of the VNC ("Use Bonjour" selected)
on a Mac on the same network and the service was noted and listed in the
servers list.  Clicking on it and then "Connect" connected automatically
w/o having to enter any hostnames or port numbers.
</p><p>
It appears SuSE 10.1 comes with avahi (or you can add packages, e.g. <code>avahi-0.6.5-27</code>)
but not the development package (you can use the OpenSuSE <code>avahi-devel</code> rpm.)
Unfortunately, you may need to disable another Zeroconf daemon "<code>/etc/init.d/mdnsd stop</code>",
before doing "<code>/etc/init.d/avahi-daemon start</code>" and "<code>/etc/init.d/avahi-dnsconfd start</code>".
We also had to comment out the <code>browse-domains</code> line in <code>/etc/avahi/avahi-daemon.conf</code>.
Hopefully there is "LessConf" to do on other distros/OS's...
</p><p>&nbsp;</p>

<a name="faq-userlogin"></a>
<a name="FAQ-63"></a>
<p><b>Q-63:</b>
<font color="#007f00">
Can I have <b>x11vnc</b> allow a user to log in with her UNIX username and password
and then have it find her X session display on that machine and then attach to it?
How about starting an X session if one cannot be found?
</font>
</p>
<p>
The easiest way to do this is via <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-inetd">inetd(8)</a> using the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-unixpw">-unixpw</a> and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-display_WAIT">-display WAIT</a>
options.  The reason inetd(8) makes this easier is that it starts a 
new <b>x11vnc</b> process for each new user connection.  Otherwise
a wrapper would have to listen for connections and spawn new
<b>x11vnc</b>'s (see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_stunnel-inetd">this example</a>
and also the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-loop">-loopbg</a> option.) 
inetd(8) is not required for this, but it makes some aspects more general.
</p><p>
Also with inetd(8) users always connect to a fixed VNC display, say <code>hostname:0</code>,
and do not need to memorize a special VNC display number just for their
personal use, etc.
</p><p>
<em><b>Update:</b></em> Use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-find">-find</a>,
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-create">-create</a>,
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-svc">-svc</a>,
and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xdmsvc">-xdmsvc</a> options that
are shorthand for common FINDCREATEDISPLAY usage modes (e.g. terminal services) described below.
(i.e. simply use "<code>-svc</code>" instead of the cumbersome
"<code>-display WAIT:cmd=FINDCREATEDISPLAY-Xvfb -unixpw -users unixpw= -ssl SAVE</code>")
</p><p>
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-display_WAIT">-display WAIT</a>
option makes <b>x11vnc</b> wait until a VNC viewer is connected before attaching to the
X display.
</p><p>
Additionally it can be used to run an external command that returns the 
<code>DISPLAY</code> and <code>XAUTHORITY</code> data.  
We provide some useful builtin ones (FINDDISPLAY and FINDCREATEDISPLAY below), but
in principle one could supply his own script:
"<code>-display WAIT:cmd=/path/to/find_display</code>" where the script <code>find_display</code>
might look something like <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/find_display.html">this.</a>
</p><p>
A default script somewhat like the above is used
under "<code>-display WAIT:cmd=FINDDISPLAY</code>"
(same as <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-find"><code>-find</code></a>)
The format for any such command is that it returns <code>DISPLAY=:disp</code>
as the first line and any remaining lines are either
<code>XAUTHORITY=file</code> or raw xauth data (the above example does
the latter.)  If applicable (<code>-unixpw</code> mode), the
program is run as the Unix user name who logged in.
</p><p>
On Linux if the virtual terminal is known the program appends ",VT=n" to the
DISPLAY line; a <code>chvt n</code> will be attempted automatically. Or
if only the X server process ID is known it appends ",XPID=n"
(a <code>chvt</code> will be attempted by x11vnc.)
</p><p>
<em><b>Tip:</b></em> Note that the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-find"><code>-find</code></a> option
is an alias for "<code>-display WAIT:cmd=FINDDISPLAY</code>".  Use it!
</p><p>
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-unixpw">-unixpw</a> option
allows <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-unix-passwords">UNIX password logins</a>.
It conveniently <em>knows</em> the Unix username whose X display
should be found.
Here are a couple <code>/etc/inetd.conf</code> examples of this usage:
</p><pre>5900  stream  tcp  nowait  nobody  /usr/sbin/tcpd /usr/local/bin/x11vnc -inetd -unixpw \
      -find -o /var/log/x11vnc.log -ssl SAVE -ssldir /usr/local/certs
</pre>
<pre>5900  stream  tcp  nowait  root    /usr/sbin/tcpd /usr/local/bin/x11vnc -inetd -unixpw \
      -find -o /var/log/x11vnc.log -ssl SAVE -users unixpw=
</pre>
Note we have used the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-find"><code>-find</code></a> alias and
the very long lines have been split.
An alternative is to 
use a wrapper script, e.g. <code>/usr/local/bin/x11vnc.sh</code>
that has all of the options.  (see also the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-svc"><code>-svc</code></a> alias.)
<p></p><p>
In the first inetd line <b>x11vnc</b> is run as user "nobody" and stays user
nobody during the whole session.  The permissions of the log files
and certs directory will need to be set up to allow "nobody" to use them.
</p><p>
In the second one <b>x11vnc</b> is run as root and switches to the user
that logs in due to the "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-users">-users unixpw=</a>" option.
</p><p>
Note that <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-tunnel-int">SSL</a> is required for
this mode because otherwise the Unix password would be passed in clear
text over the network.  In general <code>-unixpw</code> is not required
for this sort of scheme, but it is convenient because it determines
exactly who the Unix user is whose display should be sought.  Otherwise the
<code>find_display</code> script would have to use some method to work
out DISPLAY, XAUTHORITY, etc (perhaps you use multiple inetd ports and
hardwire usernames for different ports.)
</p><p>
If you really want to disable the SSL or
SSH <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-localhost">-localhost</a>
constraints (this is not recommended unless you really know what you
are doing: Unix passwords sent in clear text is a very bad idea...)
read the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-unixpw">-unixpw</a> documentation.
</p><p>
A inetd(8) scheme for a fixed user that doesn't use SSL or unix passwds 
could be:
</p><pre>  /usr/local/bin/x11vnc -inetd -users =fred -find -rfbauth /home/fred/.vnc/passwd -o /var/log/x11vnc.log
</pre>
The "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-users">-users =fred</a>" option will cause
<b>x11vnc</b> to switch to user fred and then find his X display.
The VNC password (<code>-rfbauth</code>) as opposed to Unix password
(<code>-unixpw</code>) is used to authenticate the VNC client.
<p></p><p>
Similar looking commands to the above examples can be run directly and
do not use inetd (just remove the <code>-inetd</code> option and
run from the cmdline, etc.)
</p><p>
<a name="infaq_findcreatedisplay"></a>
&nbsp;<br>
<em><b>X Session Creation:</b></em>
An added (Nov/2006) extension to FINDDISPLAY is FINDCREATEDISPLAY
where if it <b>does not find</b> an X display via the FINDDISPLAY method it will
<b><em>create</em></b> an X server session for the user (i.e. desktop/terminal
server.)  This is the only
time <b>x11vnc</b> actually tries to start up an X server
(normally it just attaches to an existing one.)
</p><p>
For virtual sessions you will need to install the <b>Xvfb</b> program
(e.g. <code>apt-get install xvfb</code>) or our <b>Xdummy</b> program (see below.)
</p><p>
By default it will only try to start up virtual (non-hardware) X
servers: first <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xvfb"><code>Xvfb</code></a> and if that is not available
then <code>Xdummy</code> (included in the x11vnc source code.)
Note that <code>Xdummy</code>
only works on Linux whereas <code>Xvfb</code> works
just about everywhere (and in some situations Xdummy must be run as root,
but its default is to not run as root.)  
An advantage of Xdummy over Xvfb is that Xdummy supports RANDR dynamic
screen resizing, which can be handy if the user accesses the desktop
from different sized screens (e.g. workstation and laptop.)
</p><p>
So an <code>inetd(8)</code> example might look like:
</p><pre>5900 stream tcp nowait root /usr/sbin/tcpd /usr/local/bin/x11vnc -inetd \
      -o /var/log/x11vnc.log -http -prog /usr/local/bin/x11vnc \
      -ssl SAVE -unixpw -users unixpw= -display WAIT:cmd=FINDCREATEDISPLAY
</pre>
Where the very long lines have been split.
See below where that long and cumbersome last line is replaced by the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-svc"><code>-svc</code></a> alias.
<p></p><p>
The above mode will allow direct SSL
(e.g. <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#ss_vncviewer">ss_vncviewer</a> or <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">SSVNC</a>) access and also Java Web 
browers access via:  <code>https://hostname:5900/</code>.
</p><p>
<em><b>Tip:</b></em> Note that the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-create"><code>-create</code></a> option
is an alias for "<code>-display WAIT:cmd=FINDCREATEDISPLAY-Xvfb</code>".
</p><p>
<em><b>Tip:</b></em> Note that <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-svc"><code>-svc</code></a>
is a short hand for the 
long "<code>-ssl SAVE -unixpw -users unixpw= -display WAIT:cmd=FINDCREATEDISPLAY</code>" part.
Unlike <code>-create</code>, this alias also sets up SSL encryption and Unix password login.
</p><p>
The above inetd example then simplifies to:
</p><pre>5900 stream tcp nowait root /usr/sbin/tcpd /usr/local/bin/x11vnc -inetd \
      -o /var/log/x11vnc.log -http -prog /usr/local/bin/x11vnc \
      -svc
</pre>
<p></p><p>
<em><b>Tip:</b></em> In addition to the usual unixpw parameters, inside
the VNC viewer the user can specify
after his username (following a ":" see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-display_WAIT"><code>-display WAIT</code></a> for details)
for FINDCREATEDISPLAY they can add "<code>geom=WxH</code>" or "<code>geom=WxHxD</code>" to specify the width, height,
and optionally the color depth.  E.g. "<code>fred:geom=800x600</code>" at the login: prompt.
Also if the env. var X11VNC_CREATE_GEOM is set to the desired WxH or WxHxD
that will be used by <b>x11vnc</b>.
</p><p>
You can set the env. var X11VNC_SKIP_DISPLAY to a comma separated list
of displays to ignore in the FINDDISPLAY process (to force creation
of new displays in some cases.)  The user logging in via the vncviewer
can also set this via <code>username:nodisplay=...</code>)
</p><p>
If you do not plan on using the Java Web browser applet you can remove the
<code>-http</code> (and <code>-prog</code>) option since this will speed up logging-in by a few seconds
(<b>x11vnc</b> will not have to wait to see if a connection is HTTPS or VNC.)
</p><p>
For reference, <code>xinetd</code> format in the file, say,
<code>/etc/xinetd.d/x11vnc</code>:
</p><pre>service x11vnc
{
        type            = UNLISTED
        port            = 5900
        socket_type     = stream
        protocol        = tcp
        wait            = no
        user            = root
        server          = /usr/local/bin/x11vnc
        server_args     = -inetd -o /var/log/x11vnc.log -http -prog /usr/local/bin/x11vnc -svc
        disable         = no
}
</pre>
<p></p><p>
To print out the script in this case use "<code>-display WAIT:cmd=FINDCREATEDISPLAY-print</code>".
To change the preference of Xservers and which to try list them, e.g.:
"<code>-display WAIT:cmd=FINDCREATEDISPLAY-X,Xvfb,Xdummy</code>"
or use "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-create_xsrv"><code>-create_xsrv X,Xvfb,Xdummy</code></a>".
The "<code>X</code>" one means to try to start up a real, hardware X server,
e.g. <code>startx(1)</code>
(if there is already a real X server running this may only work on Linux
and the <code>chvt</code> program may <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-linuxvc">need to be
run</a> to switch to the correct Linux virtual terminal.)
<b>x11vnc</b> will try to run <code>chvt</code> automatically if it
can determine which VT should be switched to.
</p><p>
<a name="xdm_greeter_config"></a>
<em><b>XDM/GDM/KDM Login Greeter Panel:</b></em>
If you want to present the user with a xdm/gdm/kdm display manager "greeter"
login you can use <code>Xvfb.xdmcp</code> instead of <code>Xvfb</code>,
etc in the above list.  However, you need to configure xdm/gdm/kdm to
accept localhost XDMCP messages, this can be done by (from -help output):
</p><pre>      If you want the FINDCREATEDISPLAY session to contact an XDMCP login
      manager (xdm/gdm/kdm) on the same machine, then use "Xvfb.xdmcp"
      instead of "Xvfb", etc.  The user will have to supply his username
      and password one more time (but he gets to select his desktop
      type so that can be useful.)  For this to work, you will need to
      enable localhost XDMCP (udp port 177) for the display manager.
      This seems to be:

       for gdm in gdm.conf:   Enable=true in section [xdmcp]
       for kdm in kdmrc:      Enable=true in section [Xdmcp]
       for xdm in xdm-config: DisplayManager.requestPort: 177
</pre>
Unless you are also providing XDMCP service to xterminals or other
machines, make sure that the host access list only allows local connections
(the name of this file is often <code>Xaccess</code> and it is usually
setup by default to do just that.)  Nowadays, host level firewalling
will also typically block UDP (port 177 for XDMCP) by default effectively
limiting the UDP connections to localhost.
<p></p><p>
<em><b>Tip:</b></em> Note that <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xdmsvc"><code>-xdmsvc</code></a>
is a short hand alias for the 
long "<code>-ssl SAVE -unixpw -users unixpw= -display WAIT:cmd=FINDCREATEDISPLAY-Xvfb.xdmcp</code>".
So we simply use:
</p><pre>service x11vnc
{
        type            = UNLISTED
        port            = 5900
        socket_type     = stream
        protocol        = tcp
        wait            = no
        user            = root
        server          = /usr/local/bin/x11vnc
        server_args     = -inetd -o /var/log/x11vnc.log -xdmsvc
        disable         = no
}
</pre>
(Note: use "<code>-svc</code>" instead of "<code>-xdmsvc</code>" for no XDMCP login
greeter.)
<p></p><p>&nbsp;</p>
<em><b>Local access (VNC Server and VNC Viewer on the same machine):</b></em>
To access your virtual X display session locally
(i.e. while sitting at the same machine it is running on) one can
perhaps have something like this in their <code>$HOME/.xinitrc</code>
<pre>#!/bin/sh
x11vnc -create -rfbport 5905 -env WAITBG=1
vncviewer -geometry +0+0 -encodings raw -passwd $HOME/.vnc/passwd localhost:5
</pre>
You may not
need the <code>-passwd</code>.  Recent RealVNC viewers might be this:
<pre>#!/bin/sh
x11vnc -create -rfbport 5905 -env WAITBG=1
vncviewer -FullScreen -PreferredEncoding raw -passwd $HOME/.vnc/passwd localhost:5
</pre>
This way a bare X server is run with no window manager or desktop; it
simply runs only the VNC Viewer on the real X server.  The Viewer then
draws the virtual X session on to the real one.
On your system it might not be <code>$HOME/.xinitrc</code>, but rather
<code>.xsession</code>, <code>.Xclients</code>, or something else.  You will
need to figure out what it is for your system and configuration.
<p></p><p>
There may be a problem if the resolution (WxH) of the virtual X display
does not match that of the physical X display.
</p><p>
If you do not want to or cannot figure out the X startup script name
(<code>.xinitrc</code>, etc) you could save the above commands to a
shell script, say "<code>vnclocal</code>", and the log in via the
normal KDM or GDM greeter program using the "Failsafe" option.
Then in the lone xterm that comes up type "<code>vnclocal</code>" to 
connect to your virtual X display via <b>x11vnc</b> and <code>vncviewer</code>. 
</p><p>&nbsp;</p>
<hr noshade="1" size="1">
<b><em>Summary</em></b>: The "<code>-display WAIT:cmd=FINDCREATEDISPLAY</code>" scheme can be
used to provide a "desktop service" (i.e. terminal service) on the
server machine: you always get some desktop there, either a real hardware X
server or a virtual one (depending on how you set things up.)
<p></p><p>
So it provides simple "terminal services" based on Unix username and password.
The created X server sessions (virtual or real hardware) will remain
running after you disconnect the VNC viewer and will be found again on
reconnecting via VNC and logging in. To terminate them use the normal
way to Exit/LogOut from inside your X session.
The user does not have to memorize which VNC display number is his.
They all go the same one (e.g. <code>hostname:0</code>) and it switches
based on username. 
</p><p>&nbsp;</p>

<a name="faq-loop"></a>
<a name="FAQ-64"></a>
<p><b>Q-64:</b>
<font color="#007f00">
Can I have <b>x11vnc</b> restart itself after it terminates?
</font>
</p>
<p>
One could do this in a shell script, but now there is an option
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-loop">-loop</a> that makes it easier.
Of course when <b>x11vnc</b> restarts it needs to have permissions
to connect to the (potentially new) X display.  This mode could be useful
if the X server restarts often.   Use e.g. "<code>-loop5000</code>" to
sleep 5000 ms between restarts.  Also "<code>-loop2000,5</code>" to sleep
2000 ms and only restart 5 times.
</p><p>
One can also use the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-loop">-loopbg</a> to emulate inetd(8)
to some degree, where each connected process runs in the background.
It could be combined, say, with the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-svc">-svc</a> option to provide
simple terminal services without using inetd(8).
</p><p>&nbsp;</p>

<a name="faq-java-http"></a>
<a name="FAQ-65"></a>
<p><b>Q-65:</b>
<font color="#007f00">
How do I make <b>x11vnc</b> work with the Java VNC viewer applet in a
web browser?
</font>
</p>
<p>
To have <b>x11vnc</b> serve up a Java VNC viewer applet to any web browsers that connect to it,
run <b>x11vnc</b> with this <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-httpdir">option</a>:
</p><pre>  -httpdir /path/to/the/java/classes/dir
</pre>
(this directory will contain the files <code>index.vnc</code> and, for example,
<code>VncViewer.jar</code>) 
Note that <b>libvncserver</b> contains the TightVNC Java classes jar
file for your convenience.  (it is the file
<code>classes/VncViewer.jar</code> in the source tree.)
<p></p><p>
You will see output something like this:
</p><pre>  14/05/2004 11:13:56 Autoprobing selected port 5900
  14/05/2004 11:13:56 Listening for HTTP connections on TCP port 5800
  14/05/2004 11:13:56   URL http://walnut:5800
  14/05/2004 11:13:56 screen setup finished.
  14/05/2004 11:13:56 The VNC desktop is walnut:0
  PORT=5900
</pre>
then you can connect to that URL with any Java enabled browser.  Feel free to customize
the default <code>index.vnc</code> file in the classes directory.
<p></p><p>
As of May/2005 
the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-http">-http</a> option will try to 
guess where the Java classes jar file is by looking in expected locations
and ones relative to the <b>x11vnc</b> binary.
</p><p>
Also note that if you wanted to, you could also start the Java viewer
entirely from the viewer-side by having the jar file there and using
either the <code>java</code> or <code>appletviewer</code> commands to
run the program.
</p><pre>  java -cp ./VncViewer.jar VncViewer HOST far-away.east PORT 5900
</pre>
<p></p><p>
<b>Proxies:</b> See the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-java-viewer-proxy">discussion here</a> if the
web browser must use a web proxy to connect to the internet.  It is
tricky to get Java applets to work in this case: a signed applet must
be used so it can connect to the proxy and ask for the redirection to
the VNC server.  One way to do this is to use the
signed SSL one referred to in <code>classes/ssl/proxy.vnc</code>
and set <code>disableSSL=yes</code> (note that this has no encryption;
please use SSL or SSH as discuss elsewhere on this page) in the URL or the file.
</p><p>&nbsp;</p>

<a name="faq-reverse-connect"></a>
<a name="FAQ-66"></a>
<p><b>Q-66:</b>
<font color="#007f00">
Are reverse connections (i.e. the VNC server connecting to the
VNC viewer) using "<code>vncviewer -listen</code>" and <code>vncconnect(1)</code>
supported?
</font>
</p>
<p>
As of Mar/2004 <b>x11vnc</b> supports reverse connections.
On Unix one starts the VNC viewer in listen mode: "<code>vncviewer -listen</code>"
(see your documentation for Windows, etc),
and then starts up <b>x11vnc</b> with the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-connect"><code>-connect</code></a> option.
To connect immediately at <b>x11vnc</b> startup time use the
"<code>-connect host:port</code>" option (use commas for a list of hosts
to connect to.)  The ":port" is optional (default is VNC listening port is 5500.)
</p><p>
If a file is specified instead:
<code>-connect /path/to/some/file</code> then that file is checked
periodically (about once a second) for new hosts to connect to.
</p><p>
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remote"><code>-remote</code></a>
control option (aka <code>-R</code>) can also be used to do this during
an active <b>x11vnc</b> session, e.g.:
</p><pre>x11vnc -display :0 -R connect:hostname.domain
</pre>
<p></p><p>
Use the "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-connect_or_exit"><code>-connect_or_exit</code></a>"
option to have <b>x11vnc</b> exit if the reverse connection fails.
Also, note the "<code>-rfbport 0</code>" option disables TCP listening for connections
(potentially useful for reverse connection mode, assuming you do not want any
"forward" connections.)
</p><p>
Note that as of Mar/2006 <b>x11vnc</b> requires password
authentication for reverse connections as well as for forward ones
(assuming password auth has been enabled, e.g. via <code>-rfbauth</code>,
<code>-passwdfile</code>, etc.)  Many VNC servers do not require any
password for reverse connections.  To regain the old behavior supply this option
"<code>-env X11VNC_REVERSE_CONNECTION_NO_AUTH=1</code>" to <b>x11vnc</b>.
</p><p>
<b><em>Vncconnect command:</em></b>
To use the <code>vncconnect(1)</code> program (from the core VNC
package at www.realvnc.com) specify the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-vncconnect"><code>-vncconnect</code></a> option
to <b>x11vnc</b> (Note: as of Dec/2004 <code>-vncconnect</code> is now
the default.) <code>vncconnect(1)</code> must be pointed to the
same X11 DISPLAY as <b>x11vnc</b> (since it uses X properties to communicate
with <b>x11vnc</b>.)  If you do not have or do not want to get the
<code>vncconnect(1)</code> program, the following script (named "Vncconnect")
may work if your <code>xprop(1)</code> supports the <code>-set</code> option:
</p><pre>#!/bin/sh
# usage: Vncconnect &lt;host&gt;
#        Vncconnect &lt;host:port&gt;
# note: not all xprop(1) support -set.
#
xprop -root -f VNC_CONNECT 8s -set VNC_CONNECT "$1"
</pre>
<p></p><p>&nbsp;</p>

<a name="faq-reverse-connect-proxy"></a>
<a name="FAQ-67"></a>
<p><b>Q-67:</b>
<font color="#007f00">
Can reverse connections be made to go through a Web or SOCKS proxy or SSH?
</font>
</p>
<p>
Yes, as of Oct/2007 <b>x11vnc</b> supports reverse connections through proxies:
use the "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-proxy"><code>-proxy host:port</code></a>"
option.  The default is to assume the proxy is a Web proxy.  Note that
most Web proxies only allow proxy destination connections to ports
443 (HTTPS) and 563 (SNEWS) and so this might not be too useful unless the
proxy has been modified (AllowCONNECT apache setting) or the
VNC viewer listens on one of those ports (or the router does a port redir.)
A web proxy may also be specified via "<code>-proxy http://host:port</code>"
</p><p>
For SOCKS4 and SOCKS4a proxies use this format "<code>-proxy
socks://host:port</code>".  If the reverse connection hostname is a numerical
IP or "localhost" then SOCKS4 (no host lookup) is used, otherwise SOCKS4a
will be used.  For SOCKS5 (proxy will do lookup and many other things)
use "<code>-proxy socks5://host:port</code>".  Note that the SSH builtin
SOCKS proxy "<code>ssh -D port</code>" only does SOCKS4 or SOCKS5,
so use <code>socks5://</code> for a ssh -D proxy.
</p><p>
The proxying works for both SSL encrypted and normal reverse connections.
</p><p>
An experimental mode is "<code>-proxy http://host:port/...</code>"
where the URL (e.g. a CGI script) is retrieved via the GET method.
See <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-proxy"><code>-proxy</code></a> for more info.
</p><p>
Another experimental mode is "<code>-proxy ssh://user@host</code>"
in which case a SSH tunnel is used for the proxying.
See <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-proxy"><code>-proxy</code></a> for more info.
</p><p>
Up to 3 proxies may be chained together by listing them by commas e.g.:
"<code>-proxy http://host1:port1,socks5://host2:port2</code>"
in case one needs to ricochet off of several machines to ultimately reach
the listening viewer.
</p><p>&nbsp;</p>

<a name="faq-web-login"></a>
<a name="FAQ-68"></a>
<p><b>Q-68:</b>
<font color="#007f00">
Can <b>x11vnc</b> provide a multi-user desktop web login service
as an Apache CGI or PHP script?
</font>
</p>
Yes.  See the example script <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/desktop.cgi.pl">desktop.cgi</a>
for ideas. It is in the source tree in the directory <code>x11vnc/misc</code>.
It serves <b>x11vnc</b>'s SSL enabled Java Applet to the web browser
with the correct connection information for the user's virtual desktop
(an <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xvfb">Xvfb session</a> via <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-create"><code>-create</code></a>; be sure to add the Xvfb package.)
HTTPS/SSL enabled Apache should be used to serve the
script to avoid unix and vnc passwords from being sent in cleartext and sniffed.
<p></p><p>
By default it uses a separate VNC port for each user desktop (either by autoprobing in a range
of ports or using a port based on the userid number.)  The web server's
firewall must allow incoming connections to these ports.
</p><p>
It is somewhat difficult to do all of this with x11vnc listening on a
<b>single</b> port, however there is also a 'fixed port' scheme described
in the script based on <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-loop">-loopbg</a>
that works fairly well (but more experience is needed to see what
problems contention for the same port causes; however at worst one user may
need to re-login.)
</p><p>
There is also an optional 'port redirection' mode for desktop.cgi that
allows redirection to other machines inside the firewall already running
SSL enabled VNC servers.  This provides much of the functionality as
the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-ssl-portal">SSL Portal</a> and is easier to set up.
</p><p>&nbsp; </p><p>

<a name="faq-xvfb"></a>
<a name="FAQ-69"></a>
</p><p><b>Q-69:</b>
<font color="#007f00">
Can I use <b>x11vnc</b> as a replacement for <code>Xvnc</code>? (i.e.
not for a real display, but for a virtual one I keep around.)
</font>
</p><p>
You can, but you would not be doing this for performance reasons
(for virtual X sessions via VNC, <code>Xvnc</code> should give the fastest
response.)  You may want to do this because <code>Xvnc</code>
is buggy and crashes,
does not support an X server extension you desire, or you want to
take advantage of one of <b>x11vnc</b>'s unending number of
options and features.
</p><p>
One way to achieve this is to have a <code><b>Xvfb</b>(1)</code>
virtual framebuffer X server running in the background and have
<b>x11vnc</b> attached to it.
Another method, faster and more accurate, is to use the "dummy"
Device Driver in XFree86/Xorg (see below.)
</p><p>
For these virtual sessions you will need to install the <b>Xvfb</b> program
(e.g. <code>apt-get install xvfb</code>) or our <b>Xdummy</b> program (see below.)
</p><p>
</p><p>
In either case,
one can view this desktop both remotely and also <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_localaccess"><em>locally</em></a> using vncviewer.
Make sure vncviewer's "<code>-encodings raw</code>" is in effect
for local viewing (compression seems to slow things down locally.)
For local viewing you set up a "bare" window manager that just starts up
<code>vncviewer</code> and nothing else (<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_localaccess">See how below</a>.)
</p><p>
Here is one way to start up <b>Xvfb</b>:
</p><pre>  xinit -- /usr/bin/Xvfb :1 -cc 4 -screen 0 1024x768x16
</pre>
This starts up a 16bpp virtual display.  To export it via VNC use
<pre>  x11vnc -display :1 ...
</pre>
Then have the remote <code>vncviewer</code> attach to <b>x11vnc</b>'s
VNC display (e.g. :0 which is port 5900.)
<p></p><p>
The "<code>-cc 4</code>" <b>Xvfb</b> option is to force
it to use a TrueColor visual instead of DirectColor (this works around a recent
bug in the Xorg <b>Xvfb</b> server.)
</p><p>
One good thing about <b>Xvfb</b> is that the virtual framebuffer exists
in main memory (rather than in the video hardware), and so <b>x11vnc</b>
can "screen scrape" it very efficiently (more than, say, 100X faster
than normal video hardware.)
</p><p>
<em><b>Update</b> Nov/2006:</em>
See the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_findcreatedisplay"><code>FINDCREATEDISPLAY</code></a> discussion of the
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-display_WAIT"><code>-display WAIT:cmd=FINDDISPLAY</code></a>"
option where virtual (Xvfb or Xdummy, or even real ones by changing an option)
X servers are started <b>automatically</b> for new users connecting.
This provides a "desktop service" for the machine.  You either get 
your real X session or your virtual (Xvfb/Xdummy) one whenever you
connect to the machine (<code>inetd(8)</code> is a nice way to provide this service.)
The
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-find">-find</a>,
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-create">-create</a>,
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-svc">-svc</a>,
and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xdmsvc">-xdmsvc</a> aliases can also come in handy here.
</p><p>
There are some annoyances WRT <b>Xvfb</b> however.  The default keyboard
mapping seems to be very poor.  One should run <b>x11vnc</b> with
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-add_keysyms"><code>-add_keysyms</code></a>
option to have keysyms added automatically.  Also, to add the
<code>Shift_R</code> and <code>Control_R</code> modifiers something
like this is needed:
</p><pre>#!/bin/sh
xmodmap -e "keycode any = Shift_R"
xmodmap -e "add Shift = Shift_L Shift_R"
xmodmap -e "keycode any = Control_R"
xmodmap -e "add Control = Control_L Control_R"
xmodmap -e "keycode any = Alt_L"
xmodmap -e "keycode any = Alt_R"
xmodmap -e "keycode any = Meta_L"
xmodmap -e "add Mod1 = Alt_L Alt_R Meta_L"
</pre>
(note: these are applied automatically in the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_findcreatedisplay"><code>FINDCREATEDISPLAY</code></a> mode of <b>x11vnc</b>.)
Perhaps the <b>Xvfb</b> options <code>-xkbdb</code>
or <code>-xkbmap</code> could be used to get a better default 
keyboard mapping...
<p></p><p>
<b><em>Dummy Driver:</em></b>&nbsp; A user points out a faster and more accurate method is to use the "dummy"
Device Driver of XFree86/Xorg instead of <b>Xvfb</b>. He uses this
to create a persistent and resizable desktop accessible from anywhere.
In the <code>Device</code> Section of the config file set <code>Driver
"dummy"</code>.  You may also need to set <code>VideoRam NNN</code>
to be large enough to hold the framebuffer. The framebuffer is kept
in main memory like <b>Xvfb</b> except that the server code is closely
correlated with the real XFree86/Xorg Xserver unlike <b>Xvfb</b>.
</p><p>
The main drawback to this method (besides requiring extra configuration
and possibly root permission) is that it also does the Linux Virtual
Console/Terminal (VC/VT) <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-linuxvc">switching</a> even though it does not need to
(since it doesn't use a real framebuffer.)  There are some "dual headed"
(actually multi-headed/multi-user) patches to the X server that turn
off the VT usage in the X server.
<em><b>Update</b>:</em> As of Jul/2005 we have an <code>LD_PRELOAD</code> script 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/Xdummy"><code>Xdummy</code></a> that allows you to use a
stock (i.e. unpatched) Xorg or XFree86 server with the "dummy" driver
and not have any VT switching problems!
An advantage of Xdummy over Xvfb is that Xdummy supports
RANDR dynamic screen resizing.
</p><p>
The standard way to start the "dummy" driver would be:
</p><pre>startx -- :1 -config /etc/X11/xorg.conf.dummy
</pre>
where the file <code>/etc/X11/xorg.conf.dummy</code> has its
<code>Device</code> Section modified as described above.
To use the <code>LD_PRELOAD</code> wrapper script:
<pre>startx -- /path/to/Xdummy :1
</pre>
An <code>xdm(1)</code> example is also provided.
<p></p><p>
In general,
one can use these sorts of schemes to use <b>x11vnc</b> to export other
virtual X sessions, say <code>Xnest</code> or even <code>Xvnc</code>
itself (useful for testing <code>x11vnc</code>.)
</p><p>
<a name="infaq_localaccess">
<em><b>Local access (VNC Server and VNC Viewer on the same machine):</b></em>  You use a VNC viewer to access the
display remotely; to access your virtual X display <b>locally</b>
(i.e. while sitting at the same machine it is running on) one can
perhaps have something like this in their <code>$HOME/.xinitrc</code>
</a></p><pre><a name="infaq_localaccess">#!/bin/sh
x11vnc -display :5 -rfbport 5905 -bg
vncviewer -geometry +0+0 -encodings raw -passwd $HOME/.vnc/passwd localhost:5
</a></pre><a name="infaq_localaccess">
The display numbers (VNC and X) will likely be different (you could also try
</a><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-find">-find</a>),
and you may not
need the <code>-passwd</code>.  Recent RealVNC viewers might be this:
<pre>#!/bin/sh
x11vnc -display :5 -rfbport 5905 -bg
vncviewer -FullScreen -PreferredEncoding raw -passwd $HOME/.vnc/passwd localhost:5
</pre>
This way a bare X server is run with no window manager or desktop; it
simply runs only the VNC Viewer on the real X server.  The Viewer then
draws the virtual X session on to the real one.
On your system it might not be <code>$HOME/.xinitrc</code>, but rather
<code>.xsession</code>, <code>.Xclients</code>, or something else.  You will
need to figure out what it is for your system and configuration.
<p></p><p>&nbsp;</p>
<em><b>XDM/GDM/KDM One-Shot X sessions:</b></em>
For the general replacement of Xvnc by Xvfb+x11vnc,
one user describes a similar setup he created where the X sessions
are one-shot's (destroyed after the vncviewer disconnects)
and it uses the XDM/GDM/KDM login greeter
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/xdm_one_shot.html">here</a>.
<p></p><p>&nbsp;</p>

<a name="faq-headless"></a>
<a name="FAQ-70"></a>
<p><b>Q-70:</b>
<font color="#007f00">
How can I use <b>x11vnc</b> on "headless" machines?  Why might I want to?
</font>
</p><p>
An interesting application of <b>x11vnc</b> is to let it export displays
of "headless" machines.  For example, you may have some lab or server
machines with no keyboard, mouse, or monitor, but each one still has
a video card.  One can use <b>x11vnc</b> to provide a simple "desktop
service" from these server machines.
</p><p>
An X server can be started on the headless machine (sometimes this
requires configuring the X server to not fail if it cannot detect a
keyboard or mouse, see the next paragraph.)
Then you can export that X display via <b>x11vnc</b>
(e.g. see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_display-manager-continuously">this FAQ</a>) and access it
from anywhere on the network via a VNC viewer.
</p><p>
Some tips on getting X servers to start on machines without keyboard
or mouse:  For XFree86/Xorg the <code>Option "AllowMouseOpenFail" "true"</code>
"ServerFlags" config file option is useful.  On Solaris <code>Xsun</code>
the <code>+nkeyboard</code> and <code>+nmouse</code> options are 
useful (put them in the server command line args in 
<code>/etc/dt/config/Xservers</code>.)  There are patches available
for <code>Xsun</code> at least back to Solaris 8 that support this. See
<code>Xserver(1)</code> for more info.
</p><p>
A tip on getting X servers to use higher resolutions on machines without monitor:
The monitor can tell the video card which resolutions and sync frequency ranges are allowed.
With no monitor attached this information is unavailable and the X server
will default to a very low, safe resolution (e.g. 800x600) that nearly
all monitors should handle.  It is possible to work around this in the
X server config file, e.g. to force the specification of which modes are supported.
Here is an a example for the <code>xorg.conf</code> file for Xorg:
</p><p>
</p><pre>Section "Device"
Identifier "VNC Device"
Driver "vesa"
EndSection

Section "Screen"
Identifier "VNC Screen"
Device "VNC Device"
Monitor "VNC Monitor"
SubSection "Display"
Modes "1024x768"
EndSubSection
EndSection

Section "Monitor"
Identifier "VNC Monitor"
HorizSync 30-70
VertRefresh 50-75
EndSection
</pre>
<p></p><p>
More info <a href="http://web.archive.org/web/20210304200604/http://ubuntuforums.org/showthread.php?t=1297815">here</a>.
(the above might not work on more recent Xorg versions.)  Other xorg.conf
file options are possible to solve this problem.  It should be possible
to use a driver for the card instead of the vesa driver and this will
enable larger resolutions and could be faster too.
</p><p>
Although this usage may sound strange it can be quite useful for a GUI
(or other) testing or QA setups: the engineers do not need to walk to lab
machines running different hardware, OS's, versions, etc (or have many
different machines in their office.)  They just connect to the various
test machines over the network via VNC.  The advantage to testing this
way instead of using <code>Xvnc</code> or even <code>Xvfb</code> is that
the test is done using the <em>real</em> X server, fonts, video hardware, etc. that will
be used in the field.
</p><p>
One can imagine a single server machine crammed with as many video cards
as it can hold to provide multiple simultaneous access or testing on
different kinds of video hardware.
</p><p>
See also the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_findcreatedisplay"><code>FINDCREATEDISPLAY</code></a> discussion of the
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-display_WAIT"><code>-display WAIT:cmd=FINDDISPLAY</code></a>"
option where virtual Xvfb or Xdummy, or real X servers are started automatically for new users connecting.
The
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-find">-find</a>,
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-create">-create</a>,
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-svc">-svc</a>,
and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xdmsvc">-xdmsvc</a> aliases can also come in handy here.
</p>

&nbsp;<br><font size="-0"><b>[Resource Usage and Performance]</b></font><br>
<a name="faq-solshm"></a>
<a name="FAQ-71"></a>
<p><b>Q-71:</b>
<font color="#007f00">
I have lots of memory, but why does <b>x11vnc</b> fail with &nbsp;&nbsp; 
<code>shmget: No space left on device</code> &nbsp;&nbsp; or &nbsp;&nbsp;
<code>Minor opcode of failed request:  1 (X_ShmAttach)</code>?
</font>
</p>
<p>
It is not a matter of free memory, but rather free shared memory (shm)
slots, also known as shm segments.  This often occurs on a public
Solaris machine using the default of only 100 slots.  You (or the owner
or root) can clean them out with <code>ipcrm(1)</code>.  <b>x11vnc</b>
tries hard
to release its slots, but it, and other programs, are not always able
to (e.g. if <code>kill&nbsp;-9</code>'d.) 
</p><p>
Sometimes <b>x11vnc</b> will notice the problem with shm segments and
tries to get by with fewer, only giving a warning like this:
</p><pre>  19/03/2004 10:10:58 shmat(tile_row) failed.
  shmat: Too many open files
  19/03/2004 10:10:58 error creating tile-row shm for len=4
  19/03/2004 10:10:58 reverting to single_copytile mode
</pre>
<p></p><p>
Here is a shell script <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/shm_clear"><code>shm_clear</code></a> to list
and prompt for removal of your unattached shm segments (attached
ones are skipped.)  I use it while debugging <b>x11vnc</b>
(I use "<code>shm_clear -y</code>" to assume "yes" for each prompt.)
If <b>x11vnc</b> is regularly not cleaning up its shm segments, please
contact me so we can work to improve the situation.
</p><p>
Longer term,
on Solaris you can put something like this in <code>/etc/system</code>:
</p><pre>  set shmsys:shminfo_shmmax = 0x2000000
  set shmsys:shminfo_shmmni = 0x1000
</pre>
to sweep the problem under the rug (4096 slots.)
On Linux, examine <code>/proc/sys/kernel/shmmni</code>; you
can modify the value by writing to that file.
<p></p><p>
Things are even more tight on Solaris 8 and earlier, there is a
default maximum number of shm segments <em>per process</em> of 6.
The error is the X server (not <b>x11vnc</b>) being unable to
attach to the segments, and looks something like this:
</p><pre>  30/04/2004 14:04:26 Got connection from client 192.168.1.23
  30/04/2004 14:04:26   other clients:
  X Error of failed request:  BadAccess (attempt to access private resource denied)
     Major opcode of failed request:  131 (MIT-SHM)
     Minor opcode of failed request:  1 (X_ShmAttach)
     Serial number of failed request:  14
     Current serial number in output stream:  17
</pre>
This tight limit on Solaris 8 can be increased via:
<pre>  set shmsys:shminfo_shmseg = 100
</pre>
in <code>/etc/system</code>.  See the next paragraph for more workarounds.
<p></p><p>
To minimize the number of shm segments used by <b>x11vnc</b> try using the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-onetile"><code>-onetile</code></a> option
(corresponds to only 3 shm
segments used, and adding <code>-fs 1.0</code> knocks it down to 2.)
If you are having much trouble with shm segments, consider disabling
shm completely via the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noshm"><code>-noshm</code></a> option.  
Performance will be somewhat degraded but when done over local machine
sockets it should be acceptable (see an <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-noshm">earlier
question</a> discussing <code>-noshm</code>.)
</p><p>&nbsp;</p>

<a name="faq-less-resource"></a>
<a name="FAQ-72"></a>
<p><b>Q-72:</b>
<font color="#007f00">
How can I make <b>x11vnc</b> use less system resources?
</font>
</p>
<p>
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nap"><code>-nap</code></a>
(now on by default; use <code>-nonap</code> to disable) and
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wait"><code>-wait n</code></a>"
(where <code>n</code>
is the sleep between polls in milliseconds, the default is 30 or so)
option are good places to start.
In addition, something like
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-sb"><code>-sb 15</code></a>"
will cause <b>x11vnc</b> to go into a deep-sleep mode after 15
seconds of no activity (instead of the default 60.)
</p><p>
Reducing the X server bits per pixel
depth (e.g. to 16bpp or even 8bpp) will further decrease memory I/O and
network I/O.  The ShadowFB X server setting will make <b>x11vnc</b>'s
screen polling less severe. Using the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-onetile"><code>-onetile</code></a> option will use less
memory and use fewer shared memory slots (add
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-fs"><code>-fs 1.0</code></a> for
one less slot.)
</p><p>&nbsp;</p>

<a name="faq-more-resource"></a>
<a name="FAQ-73"></a>
<p><b>Q-73:</b>
<font color="#007f00">
How can I make <b>x11vnc</b> use MORE system resources?
</font>
</p>
<p>
You can try
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-threads"><code>-threads</code></a> (note
this mode can be unstable and/or crash; and as of May/2008 is strongly
discouraged, see the option description) or dial down the wait time (e.g.
<code>-wait 1</code>) and possibly dial down
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-defer"><code>-defer</code></a> as well.
Note that if you try to increase the "frame rate" too much you can
bog down the server end with the extra work it needs to do compressing
the framebuffer data, etc.
</p><p>
That said, it is possible to "stream" video via <b>x11vnc</b>
if the video window is small enough.  E.g. a 256x192 <code>xawtv</code>
TV capture window (using the  <b>x11vnc</b>
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-id"><code>-id</code></a> option) can be streamed
over a LAN or wireless at a reasonable frame rate.
If the graphics card's framebuffer read rate is 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#fb_read_slow">faster</a> than normal
then the video window size and frame rate can be much higher.
The use of <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-turbovnc">TurboVNC</a> and/or TurboJPEG can
make the frame rate somewhat higher still (but most of this hinges
on the graphics card's read rate.)


</p><p>&nbsp;</p>

<a name="faq-slow-link"></a>
<a name="FAQ-74"></a>
<p><b>Q-74:</b>
<font color="#007f00">
I use <b>x11vnc</b> over a slow link with high latency (e.g. dialup
modem or broadband), is there anything I can do to speed things up?
</font>
</p>
<p>
Some things you might want to experiment with (many of which will help
performance on faster links as well):
</p><p>
&nbsp;&nbsp;X server/session parameters:<br>
</p><ul>
	<li>Configure the X server bits per pixel to be 16bpp or even 8bpp.
	(reduces amount of data needed to be polled, compressed, and sent)
	</li>
	<li>Use a smaller desktop size
	(e.g. 1024x768 instead of 1280x1024)
	</li>
	<li>Make sure the desktop background is a <b>solid color</b>
	(the background is resent <i>every</i> time it is re-exposed.)
	Consider using the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-solid"><code>-solid [color]</code></a> option
	to try to do this automatically.
	</li>
	<li>Configure your window manager or desktop "theme" to not use
	fancy images, shading, and gradients for the window
	decorations, etc.  Disable window animations, etc.
	Maybe your desktop has a "low bandwidth" theme you can easily
	switch into and out of.
	Also in Firefox disable eye-candy, e.g.: Edit -&gt; Preferences
	-&gt; Advanced -&gt; Use Smooth Scrolling (deselect it.)
	</li>
	<li>Avoid small scrolls of large windows using the Arrow keys or
	scrollbar.  Try to use PageUp/PageDown instead.
	(not so much of a problem in x11vnc 0.7.2 if
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-scrollcopyrect"><code>-scrollcopyrect</code></a>
	is active and detecting scrolls for the application.)
	</li>
	<li>If the 
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wireframe"><code>-wireframe</code></a>
	option is not available (earlier than x11vnc 0.7.2 or you have disabled it via
	<code>-nowireframe</code>) then Disable Opaque Moves and Resizes
	in the window manager/desktop.  
	</li>
	<li><em><b>However</b></em> if <code>-wireframe</code> is active  (on by
	default in x11vnc 0.7.2) then you should
	<em><b>Enable</b></em> Opaque Moves and Resizes in the window
	manager!  This seems counter-intuitive, but because x11vnc detects
	the move/resize events <em>early</em> there is a <em>huge</em>
	speedup over a slow link when Opaque Moves and Resizes are enabled.
	(e.g. CopyRect encoding will be used.)
	</li>
	<li>Turn off Anti-aliased fonts on your system, web browser, terminal
	windows, etc.  AA fonts do not compress as well as traditional fonts
	(sometimes 10X less.)
	</li>
	<li>On Firefox/Mozilla (and anything else) turn off "Smooth Scroll"
	animations.  In Firefox put in the URL "about:config" and
	set <code>general.smoothScroll</code> to false.
	</li>
	<li>On Xorg/XFree86 turn on the Shadow Framebuffer to speed up reading.
	(<code>Option "ShadowFB" "true"</code>
        in the  Device section of <code>/etc/X11/XF86Config</code>)  This
	disables 2D acceleration on the physical display and so may
	not be worth it (if you play games, etc), but could be of use in some situations. 
	Note: If the network link is very slow, this speedup may not be noticed.
	</li>
</ul>
&nbsp;&nbsp;VNC viewer parameters:<br>
<ul>
	<li>Use a <a href="http://web.archive.org/web/20210304200604/http://www.tightvnc.com/">TightVNC enabled viewer</a>!
	(Actually, RealVNC 4.x viewer with ZRLE encoding is not too bad either;
	some claim it is faster.)
	</li>
	<li>Make sure the <code>tight</code> (or <code>zrle</code>) encoding is being used
	(look at <code>vncviewer</code> and <code>x11vnc</code> outputs)
	</li>
	<li>Request 8 bits per pixel using <code>-bgr233</code>
	(up to 4X speedup over depth 24 TrueColor (32bpp), but colors will be off)
	</li>
	<li>RealVNC 4.x viewer has some <em>extremely</em> low color modes
	(only 64 and even 8 colors.)  <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">SSVNC does too</a>. The colors are poor, but it is 
	usually noticeably faster than bgr233 (256 colors.)
	</li>
	<li>Try increasing the TightVNC <code>-compresslevel</code>
	(compresses more on server side before sending, but uses more CPU)
	</li>
	<li>Try reducing the TightVNC <code>-quality</code>
	(increases JPEG compression, but is lossy with painting artifacts)
	</li>
	<li>Try other VNC encodings via <code>-encodings</code>
	(<code>tight</code> may be the fastest, but you should compare it to
	<code>zrle</code> and maybe some of the others)
	</li>
	<li>On the machine where <code>vncviewer</code> is run,
	make sure Backing Store is enabled (Xorg/XFree86 disables it by default
	causing re-exposures of <code>vncviewer</code> to be <em>very</em> slow)
	<code>Option  "backingstore"</code> in config file.
	</li>
</ul>
&nbsp;&nbsp;<b>x11vnc</b> parameters:<br>
<ul>
	<li>Make sure the
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wireframe"><code>-wireframe</code></a>
	option is active (it should be on by default) and you have
	Opaque Moves/Resizes <em>Enabled</em> in the window manager.
	</li>
	<li>Make sure the
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-scrollcopyrect"><code>-scrollcopyrect</code></a>
	option is active (it should be on by default.)  This detects
	scrolls in many (but not all) applications an applies the
	CopyRect encoding for a big speedup.
	</li>
	<li>Enforce a solid background when VNC viewers are connected via
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-solid"><code>-solid</code></a>
	</li>
	<li>Try x11vnc's client-side caching
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-client-caching">client-side caching</a>
	scheme: <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ncache"><code>-ncache</code></a>
	</li>
	<li>Specify
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-speeds"><code>-speeds modem</code></a>
	to force the wireframe and scrollcopyrect heuristic parameters
	(and any future ones) to those of a dialup modem connection
	(or supply the <code>rd,bw,lat</code> numerical values that
	characterize your link.)
	</li>
	<li>If wireframe and scrollcopyrect aren't working, try using 
	the more drastic
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nodragging"><code>-nodragging</code></a>
	(no screen updates when dragging mouse, but sometimes you miss
	visual feedback)
	</li>
	<li>Set <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-fs"><code>-fs 1.0</code></a>
	(disables fullscreen updates)
	</li>
	<li>Try increasing
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wait"><code>-wait</code></a> or
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-defer"><code>-defer</code></a>
	(reduces the maximum "frame rate", but won't help much for large
	screen changes)
	</li>
	<li>Try the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-progressive"><code>-progressive pixelheight</code></a>
	mode with the block <code>pixelheight</code> 100 or so
	(delays sending vertical blocks since they may change
	while viewer is receiving earlier ones)
	</li>
	<li>If you just want to watch one (simple) window use
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-id"><code>-id</code></a> or
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-appshare"><code>-appshare</code></a>
	(cuts down extraneous polling and updates, but can be buggy or insufficient)
	</li>
	<li>Set <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nosel"><code>-nosel</code></a>
	(disables all clipboard selection exchange)
	</li>
	<li>Use <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nocursor"><code>-nocursor</code></a>
	and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nocursorpos"><code>-nocursorpos</code></a>
	(repainting the remote cursor position and shape takes
	resources and round trips)
	</li>
	<li>On very slow links (e.g. &lt;= 28.8) you may need to increase the
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-readtimeout"><code>-readtimeout n</code></a>
	setting if it sometimes takes more than 20sec to paint the full screen, etc.
	</li>
	<li>Do not use
	<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-fixscreen"><code>-fixscreen</code></a>
	to automatically refresh the whole screen, tap three <code>Alt_L</code>'s
	then the screen has painting errors (rare problem.)
	</li>
</ul>
<p></p><p>
&nbsp;<br>
<em><b>Example for the KDE desktop:</b></em><br>
</p><p>
Launch the "KDE Control Center" utility.  Sometimes this is called "Personal Settings".
</p><p>
Select "Desktop".
</p><p>
&nbsp;Then Select "Window Behavior".  In the "Moving" Tab set these:
</p><ul>
	<li>YES - Display content in moving windows</li>
	<li>YES - Display content in resizing windows</li>
	<li>NO&nbsp;&nbsp; - Display window geometry when moving or resizing</li>
	<li>NO&nbsp;&nbsp; - Animate minimize and restore</li>
</ul>
&nbsp;In the "Translucency" Tab set:
<ul>
	<li>NO&nbsp;&nbsp; - Use translucency/shadows</li>
</ul>
<p></p><p>
Next hit "Back" and then select "Panels".
</p><p>
&nbsp;In the "Appearance" Tab set:
</p><ul>
	<li>NO&nbsp;&nbsp; - Enable icon mouseover effects</li>
	<li>NO&nbsp;&nbsp; - Enable transparency</li>
</ul>
Now go all the way back up to the top and Select "Appearance &amp; Themes".
<p></p><p>
&nbsp;Select "Background" and set:
</p><ul>
	<li>YES - No picture</li>
	<li>Colors:  Single Color</li>
</ul>
<p></p><p>
&nbsp;Select "Fonts" and disable anti-aliased fonts if you are bold enough.
</p><p>
&nbsp;Select "Launch Feedback" and set:
</p><ul>
	<li>Busy Cursor:  No Busy Cursor</li>
	<li>NO&nbsp;&nbsp; - Enable taskbar notification</li>
</ul>
<p></p><p>
&nbsp;Select "Screen Saver" and set:
</p><ul>
	<li>Screen Saver:  Blank Screen</li>
</ul>
<p></p><p>
&nbsp;Select "Style" and in the "Effects" Tab set:
</p><ul>
	<li>NO&nbsp;&nbsp; - Enable GUI effects</li>
</ul>
<p></p><p>
</p><p>
&nbsp;<br>
<em><b>Example for the GNOME desktop:</b></em><br>
</p><ul>
<li>TBD.</li>
</ul>
<p></p><p>&nbsp;</p>

<a name="faq-xdamage"></a>
<a name="FAQ-75"></a>
<p><b>Q-75:</b>
<font color="#007f00">
Does <b>x11vnc</b> support the X DAMAGE Xserver extension to find
modified regions of the screen quickly and efficiently?
</font>
</p>
<p>
Yes, as of Mar/2005 <b>x11vnc</b> will use the
X DAMAGE extension by default if it is available on the display.
This requires <code>libXdamage</code> to be available in the build
environment as well (recent Linux distros and Solaris 10 have it.)
</p><p>
The DAMAGE extension enables the X server to report changed regions of
the screen back to <b>x11vnc</b>.  So <b>x11vnc</b> doesn't have to guess
where the changes are (by polling every pixel of the entire screen every 2-4 seconds.)
The use of X DAMAGE dramatically reduces the load when the screen is not
changing very much (i.e. most of the time.) It also noticeably improves
updates, especially for very small changed areas (e.g. clock ticking,
cursor flashing, typing, etc.)
</p><p>
Note that the DAMAGE extension does not speed up the actual
<em>reading</em> of pixels from the video card framebuffer memory,
by, say, mirroring them in main memory.  So reading the fb is still
painfully <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#fb_read_slow">slow (e.g. 5MB/sec)</a>, and so even
using X DAMAGE when large changes occur on the screen the bulk of the
time is still spent retrieving them.
Not ideal, but use of the ShadowFB XFree86/Xorg option speeds up the
reading considerably (at the cost of h/w acceleration.)
</p><p>
Unfortunately the current Xorg DAMAGE extension implementation can at times
be overly conservative and report very large rectangles as "damaged"
even though only a small portion of the pixels have actually been modified.
This behavior is often the fault of the window manager (e.g. it redraws
the entire, unseen, frame window underneath the application window when
it gains focus), or the application itself (e.g. does large, unnecessary
repaints.)
</p><p>
To work around this deficiency, <b>x11vnc</b> currently only trusts
small DAMAGE rectangles to contain real damage.  The larger rectangles
are only used as hints to focus the traditional scanline polling
(i.e. if a scanline doesn't intersect a recent DAMAGE rectangle, the
scan is skipped.)  You can use the 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xd_area"><code>-xd_area A</code></a>" option
to adjust the size of the trusted DAMAGE rectangles.  The default
is 20000 pixels (e.g. a 140x140 square, etc.)  Use "<code>-xd_area 0</code>"
to disable the cutoff and trust <em>all</em> DAMAGE rectangles.
</p><p>
The option 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xd_mem"><code>-xd_mem f</code></a>" may
also be of use in tuning the algorithm.  To disable using DAMAGE
entirely use
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noxdamage"><code>-noxdamage</code></a>".
</p><p>&nbsp;</p>

<a name="faq-xdamage-opengl"></a>
<a name="FAQ-76"></a>
<p><b>Q-76:</b>
<font color="#007f00">
My OpenGL application shows no screen updates unless
I supply the <code>-noxdamage</code> option to <b>x11vnc</b>.
</font>
</p>
One user reports in his environment (MythTV using the NVIDIA OpenGL drivers)
he gets no updates after the initial screen is drawn unless he uses the
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noxdamage"><code>-noxdamage</code></a>"
option.
<p></p><p>
This seems to be a bug in the X DAMAGE implementation of that
driver. You may have to use <code>-noxdamage</code> as well.
A way to autodetect this will be tried, probably the best it will
do is automatically stop using X DAMAGE. 
</p><p>
A developer for <a href="http://web.archive.org/web/20210304200604/http://minimyth.org/">MiniMyth</a>
reports that the 'alphapulse' tag of the theme G.A.N.T. can also
cause problems, and should be avoided when using VNC.
</p><p>
<em>Update:</em> see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-beryl">this FAQ</a> too.
</p><p>&nbsp;</p>

<a name="faq-pointer-mode"></a>
<a name="FAQ-77"></a>
<p><b>Q-77:</b>
<font color="#007f00">
When I drag windows around with the mouse or scroll up and down things
really bog down (unless I do the drag in a single, quick motion.)
Is there anything to do to improve things?
</font>
</p>
<p>
This problem is primarily due to 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#fb_read_slow">slow hardware read rates</a>
from video cards: as you scroll or move a large window around the screen
changes are much too rapid for x11vnc to keep up them (it can usually only
read the video card at about 5-10 MB/sec, so it can take a good fraction
of a second to read the changes induce from moving a large window, if
this to be done a number of times in succession the window or scroll
appears to "lurch" forward.)  See the description in the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-pointer_mode"><code>-pointer_mode</code></a>
option for more info.  The next bottleneck is compressing all of these
changes and sending them out to connected viewers, however the VNC
protocol is pretty much self-adapting with respect to that (updates are
only packaged and sent when viewers ask for them.)
</p><p>
As of Jan/2004 there are some improvements to <b>libvncserver</b>.
The default should now be much better than before and dragging
small windows around should no longer be a huge pain.
If for some reason these changes make matters worse, you can go back
to the old way via the 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-pointer_mode"><code>-pointer_mode 1</code></a>" option.
</p><p>
Also added was the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nodragging"><code>-nodragging</code></a> option
that <em>disables all</em> screen updates while dragging with the mouse
(i.e. mouse motion with a button held down.)  This gives the snappiest
response, but might be undesired in some circumstances when you want
to see the visual feedback while dragging (e.g. menu traversal or text
selection.)
</p><p>
As of Dec/2004 the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-pointer_mode"><code>-pointer_mode n</code></a> option was introduced. 
n=1 is the original mode, n=2 an improvement, etc..
See the <code>-pointer_mode n</code> help for more info.
</p><p>
Also, in some circumstances the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-threads"><code>-threads</code></a> option
can improve response considerably.  Be forewarned that if more than
one vncviewer is connected at the same time then <code>libvncserver</code>
may not be thread safe (try to get the viewers to use different VNC
encodings, e.g. tight and ZRLE.)  This option can be unstable and so as of Feb/2008
it is disabled by default.  Set env. <code>X11VNC_THREADED=1</code> to re-enable.
</p><p>
As of Apr/2005 two new
options (see the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-wireframe">wireframe FAQ</a> and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-scrollcopyrect">scrollcopyrect FAQ</a> below) provide schemes to
sweep this problem under the rug for window moves or resizes and for some
(but not all) window scrolls.
These are the preferred way of avoiding the "lurching" problem, contact
me if they are not working. Note on SuSE and some other distros the RECORD X extension
used by scrollcopyrect is not enabled by default, turn it on in <code>xorg.conf</code>:
</p><pre>Section "Module"
        ...
        Load  "record"
        ...
EndSection
</pre>
<p></p><p>&nbsp;</p>

<a name="faq-wireframe"></a>
<a name="FAQ-78"></a>
<p><b>Q-78:</b>
<font color="#007f00">
Why not do something like wireframe animations to avoid the windows
"lurching" when being moved or resized?
</font>
</p>
<p>
Nice idea for a hack!  As of Apr/2005
<b>x11vnc</b> by default will apply heuristics to try to guess if a
window is being (opaquely) moved or resized. If such a change is detected
framebuffer polling and updates will be suspended and only an animated
"wireframe" (a rectangle outline drawn where the moved/resized window
would be) is shown.  When the window move/resize stops, it returns to
normal processing: you should only see the window appear in the new
position.  This spares you from interacting with a "lurching" window
between all of the intermediate steps.
BTW the lurching is due to
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-pointer-mode">slow video card read rates</a>
(see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#fb_read_slow">here too</a>.) A displacement,
even a small one, of a large window requires a non-negligible amount
of time, a good fraction of a second, to read in from the hardware
framebuffer.
</p><p>
Note that Opaque Moves/Resizes must be <b>Enabled</b> by your window
manager for <code>-wireframe</code> to do any good.
</p><p>
The mode is currently on by default because most people are afflicted with
the problem.  It can be disabled with the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wireframe"><code>-nowireframe</code></a>
option (aka <code>-nowf</code>.)  Why might one want to turn off
the wireframing?  Since <b>x11vnc</b> is merely guessing when windows
are being moved/resized, it may guess poorly for your window-manager or
desktop, or even for the way you move the pointer.  If your window-manager
or desktop already does its own wireframing then this mode is a waste
of time and could do the wrong thing occasionally.  There may be other
reasons the new mode feels unnatural.  If you have very expensive
video hardware (SGI, well now even proprietary Xorg drivers are fast at
reading) or are using an in-RAM video framebuffer (SunRay, ShadowFB,
Xvfb), the read rate from <em>that</em> framebuffer may be very fast
(100's of MB/sec) and so you don't really see much lurching (at least
over a fast LAN): opaque moves look smooth in <b>x11vnc</b>. Note:
ShadowFB is often turned on when you are using the <code>vesafb</code>
or <code>fbdev</code> XFree86 video driver instead of a native one so
you might be using it already and not know.
</p><p>
The heuristics used to guess window motion or resizing are simple, but
are not fool proof: <b>x11vnc</b> is sometimes tricked and so you'll
occasionally see the lurching opaque move and rarely something even
worse.
</p><p>
First it assumes that the move/resize will occur with a mouse button
pressed, held down and dragged (of course this is only mostly true.)
Next it will only consider a window for wireframing if the mouse pointer
is initially "close enough" to the edges of the window frame, e.g. you
have grabbed the title bar or a resizer edge (this requirement can be
disabled and it also not applied if a modifier key, e.g. Alt, is pressed.)
If these are true, it will wait an amount of time to see if
the window starts moving or resizing.  If it does, it starts drawing
the wireframe "outline" of where the window would be.  When the mouse
button is released, or a timeout occurs, it goes back to the standard
mode to allow the actual framebuffer changes to propagate to the viewers.
</p><p>
These parameters can be tweaked:
</p><ul>
<li>Color/Shade of the wireframe.</li>
<li>Linewidth of the outline frame.</li>
<li>Cutoff size of windows to not apply wireframing to.</li>
<li>Cutoffs for closeness to Top, Bottom, Left, and Right edges of window.</li>
<li>Modifier keys to enable interior window grabbing.</li>
<li>Maximum time to wait for dragging pointer events.</li>
<li>Maximum time to wait for the window to start moving/resizing.</li>
<li>Maximum time to show a wireframe animation.</li>
<li>Minimum time between sending wireframe outlines.</li>
</ul>
See the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wireframe">"<code>-wireframe tweaks</code>"</a>
option for more details. 
On a slow link, e.g. dialup modem, the parameters may be automatically
adjusted for better response.
<p></p><p>
 &nbsp;
</p><p>
<a name="infaq_wirecopyrect"></a>
<em>CopyRect encoding:</em> &nbsp;In addition to the above there is the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wireframe">"<code>-wirecopyrect mode</code>"</a>
option.  It is also on by default.  This instructs <b>x11vnc</b> to
not only show the wireframe animation, but to also instruct all
connected VNC viewers to locally translate the window image data from the
original position to the new position on the screen when the animation
is done.  This speedup is the VNC CopyRect encoding: the framebuffer
update doesn't need to send the actual new image data.  This is
nice in general, and very convenient over a slow link, but since
it is based on heuristics you may need to disable it with the
<code>-nowirecopyrect</code> option (aka <code>-nowcr</code>) if it works
incorrectly or unnaturally for you.
</p><p>
The <code>-wirecopyrect</code> modes are: "never" (same as
<code>-nowirecopyrect</code>); "top", only apply the CopyRect if the window
is appears to be on the top of the window stack and is not obstructed
by other windows; and "always" to always try to apply the CopyRect
(obstructed regions are usually clipped off and not translated.)
</p><p>
Note that some desktops (KDE and xfce) appear to mess with the window
stacking in ways that are not yet clear.  In these cases <b>x11vnc</b>
works around the problem by applying the CopyRect even if obscuring
windows' data is translated!  Use <code>-nowirecopyrect</code> if this
yields undesirable effects for your desktop.
</p><p>
Also, the CopyRect encoding may give incorrect results under
<code>-scale</code> (depending on the scale factor the CopyRect
operation is often only approximate: the correctly scaled framebuffer
will be slightly different from the translated one.)
<b>x11vnc</b> will try to push a "cleanup" update after the CopyRect
if <code>-scale</code> is in effect.
Use <code>-nowirecopyrect</code> if this or other painting errors are
unacceptable.
</p><p>
</p><p>&nbsp;</p>

<a name="faq-scrollcopyrect"></a>
<a name="FAQ-79"></a>
<p><b>Q-79:</b>
<font color="#007f00">
Can <b>x11vnc</b> try to apply heuristics to detect when a window is
scrolling its contents and use the CopyRect encoding for a speedup?
</font>
</p>
<p>
Another nice idea for a hack!  As of May/2005
<b>x11vnc</b> will by default apply heuristics to try to detect if
the window that has the input focus is scrolling its contents
(but only when <b>x11vnc</b> is feeding user input, keystroke or pointer,
to the X server.)  So, when detected, scrolls induced by dragging
on a scrollbar or by typing (e.g. Up or Down arrows, hitting
Return in a terminal window, etc), will show up much more quickly
than via the standard <b>x11vnc</b> screen polling update mechanism.
</p><p>
There will be a speedup for <em>both</em> slow and fast links to viewers.
For slow links the speedup is mostly due to the CopyRect encoding not
requiring the image data to be transmitted over the network.  For fast
links the speedup is primarily due to <b>x11vnc</b> <em>not having to
read the scrolled framebuffer data</em> from the X server  (recall that
reading from the hardware framebuffer is <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#fb_read_slow">slow</a>.)
</p><p>
To do this <b>x11vnc</b> uses the RECORD X extension to snoop the X11
protocol between the X client with the focus window and the X server.
This extension is usually present on most X servers (but SuSE
disables it for some reason.)  On XFree86/Xorg it can be enabled via
<code>Load "record"</code> in the <code>Module</code> section of the
config file if it isn't already:
</p><pre>Section "Module"
        ...
        Load  "record"
        ...
EndSection
</pre>
<p></p><p>
Currently the RECORD extension is used as little as possible so as to
not slow down regular use.  Only simple heuristics are applied to detect
<code>XCopyArea</code> and <code>XConfigureWindow</code> calls from the
application.  These catch a lot of scrolls, e.g. in mozilla/firefox
and in terminal windows like gnome-terminal and xterm.  Unfortunately
the toolkits KDE applications use make scroll detection less effective
(only rarely are they detected: i.e. Konqueror and Konsole don't work.)
An interesting project, that may be the direction <b>x11vnc</b>
takes, is to record <em>all</em> of the X11 protocol from all clients
and try to "tee" the stream into a modified Xvfb watching for
CopyRect and other VNC speedups.  A potential issue is the RECORD
stream is delayed from actual view on the X server display: if one
falls too far behind it could become a mess...
</p><p>
The initial implementation of 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-scrollcopyrect"><code>-scrollcopyrect</code></a>
option is useful in that it detects many scrolls and thus gives a much nicer
working environment (especially when combined with the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wireframe"><code>-wireframe</code></a>
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wirecopyrect"><code>-wirecopyrect</code></a>
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-wireframe">options</a>, which are also on by default; and
if you are willing to enable the ShadowFB things are <em>very</em> fast.)
The fact that there aren't long delays or lurches during scrolling is
the primary improvement.
</p><p>
But there are some drawbacks:
</p><ul>
<li>Not all scrolls are detected.  Some apps scroll windows in ways
that cannot currently be detected, and other times <b>x11vnc</b> "misses"
the scroll due to timeouts, etc. Sometimes it is more distracting
that a speedup occasionally doesn't work as opposed to being consistently
slow!</li>
<li>For rapid scrolling (i.e. sequence of many scrolls over a short
period) there can be painting errors (tearing, bunching up, etc.)
during the scroll.  These will repair themselves after the scroll
is over, but when they are severe it can be distracting.
Try to think of the approximate window contents as a quicker and
more useful "animation" compared to the slower polling scheme...
</li>
<li>Scrolling inside shells in terminal windows (gnome-terminal, xterm), 
can lead to odd painting errors.  This is because <b>x11vnc</b>
did not have time to detect a screen change just before the scroll (most
common is the terminal undraws the block cursor before scrolling the text
up: in the viewer you temporarily see multiple block cursors.)  Another
issue is with things like <code>more(1)</code>: scroll detection for 5-6
lines happens nicely, but then it can't keep up and so there is a
long pause for the standard polling method to deliver the remaining
updates.</li>
<li>More rarely sometimes painting errors are <em>not</em> repaired
after the scroll is over.  This may be a bug in x11vnc or libvncserver,
or it may be an inescapable fact of the CopyRect encoding and the
delay between RECORD callbacks and what is actually on the X display.  One
can tap the <code>Alt_L</code> key (Left "Alt" key) 3 times in a row to
signal <b>x11vnc</b> to refresh the screen to all viewers.  Your VNC-viewer
may have its own screen refresh hot-key or button.  See also:
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-fixscreen"><code>-fixscreen</code></a></li>
<li>Some applications, notably OpenOffice, do <code>XCopyArea</code>
scrolls in weird ways that assume ancestor window clipping is taking
place.  See the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-scr_skip"><code>-scr_skip</code></a>
option for ways to tweak this on a per-application basis.</li>
<li>Selecting text while dragging the mouse may be slower, especially
if the Button-down event happens near the window's edge.  This is because
the scrollcopyrect scheme is watching for scrolls via RECORD and has
to wait for a timeout to occur before it does the update. </li>
<li>For reasons not yet understood the RECORD extension can stop
responding (and hence scrolls are missed.) As a workaround <b>x11vnc</b>
attempts to reset the RECORD connection every 60 seconds or so.  Another
workaround is to type 4 <code>Super_L</code> (Left Super/Windows-Flag
key) in a row to reset RECORD.  Work is in progress to try to fix this
bug.</li>
<li>Sometimes you need to "retrain" <b>x11vnc</b> for a certain
window because it fails to detect scrolls in it.  Sometimes clicking
inside the application window or selecting some text in it to force the
focus helps.</li>
<li>When using the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-scale"><code>-scale</code></a>
option there will be a quick CopyRect scroll, but it needs to be
followed by a slower "cleanup" update.  This is because for a fixed
finite screen resolution (e.g. 75 dpi) scaling and copyrect-ing are not
exactly independent.  Scaling involves a blending of nearby pixels and
if you translate a pixel the neighbor pixel weighting may be different.
So you have to wait a bit for the cleanup update to finish.  On slow
links <b>x11vnc</b> may automatically decide to not detect scrolls when
<code>-scale</code> is in effect.  In general it will also try to
defer the cleanup update if possible.</li>
</ul>
If you find the <code>-scrollcopyrect</code> behavior too approximate
or distracting you can go back to the standard polling-only update
method with the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-scrollcopyrect"><code>-noscrollcopyrect</code></a>
(or <code>-noscr</code> for short.)
If you find some extremely bad and repeatable behavior for
<code>-scrollcopyrect</code> please report a bug.
<p></p><p>
Alternatively, as with <code>-wireframe</code>,
there are many tuning parameters to try to improve the situation.
You can also access these parameters inside the gui under "Tuning".
These parameters can be tweaked:
</p><ul>
<li>The minimum pixel area of a rectangle to be watched for scrolls.</li>
<li>A list if application names to skip scroll detection.</li>
<li>Which keystrokes should trigger scroll detection.</li>
<li>Which applications should have a "terminal" tweak applied to them.</li>
<li>When repeating keys (e.g. Up arrow) should be discarded to preserve a scroll.</li>
<li>Cutoffs for closeness to Top, Bottom, Left, and Right edges of window for mouse induced scrolls.</li>
<li>Set timeout parameters for keystroke induced scrolls.</li>
<li>Set timeout parameters for mouse pointer induced scrolls.</li>
<li>Have the full screen be periodically refreshed to fix painting errors.</li>
</ul>
<p></p><p>&nbsp;</p>

<a name="faq-client-caching"></a>
<a name="FAQ-80"></a>
<p><b>Q-80:</b>
<font color="#007f00">
Can <b>x11vnc</b> do client-side caching of pixel data?  
I.e. so when that pixel data is needed again it does not
have to be retransmitted over the network. 
</font>
</p>
<p>
As of Dec/2006 in the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#beta-test">0.9 development tarball</a>
there is an experimental client-side caching implementation enabled by the
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ncache"><code>-ncache n</code></a>" option.
In fact, during the test period it was on by default with <code>n</code>
set to 10.  To disable it use "<code>-noncache</code>".
</p><p>
It is a simple scheme where a (<b>very</b> large) lower portion of the
framebuffer (i.e. starting just below the user's actual desktop display) is
used for storing pixel data.  CopyRect; a fast, essentially local viewer-side
VNC encoding; is used to swap the pixel data in and out of the actual
display area.  It gives an excellent speedup for iconifying/deiconifying
and moving windows and re-posting of menus (often it doesn't feel like
VNC at all: there is no delay waiting for the pixel data to fill in.)
</p><p>
This scheme is nice because it does all of this within the existing
VNC protocol, and so it works with all VNC viewers.  
</p><p>
A challenge to doing more sophisticated (e.g. compressed and/or shared)
client-side caching is that one needs to extend the VNC protocol, modify
a viewer and then also convince users to adopt your modified VNC Viewer
(or get the new features to be folded into the main VNC viewers, patches
accepted, etc... likely takes many years before they might be deployed in the field.)
So it is convenient that the "<code>-ncache n</code>" works with any unaltered
VNC viewer.
</p><p>
A drawback of the "<code>-ncache n</code>" method is that in the VNC
Viewer you can scroll down and <b>actually see</b> the cached pixel data.
So it looks like there is a bug: you can scroll down in your viewer and
see a strange "history" of windows on your desktop.  This is working
as intended.
One will need to try to adjust the size of his VNC Viewer window so the
cache area cannot be seen.  <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">SSVNC</a> (see below)
can do this automatically.
</p><p>
At some point LibVNCServer may implement a "rfbFBCrop"
pseudoencoding that viewers can use to learn which portion of the
framebuffer to actually show to the users (with the hidden part used
for caching, or perhaps something else, maybe double buffering or other
offscreen rendering...)
</p><p>
The Enhanced TightVNC Viewer (SSVNC) Unix viewer has a nice
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html#ycrop">-ycrop</a> option to
help hide the pixel cache area from view.  It will turn on automatically
if the framebuffer appears to be very tall (height more than twice
the width), or you can supply the actual value for the height.
If the screen is resized by scaling, etc, the ycrop value is scaled as well.
In fullscreen mode you cannot scroll past the end of the actual screen,
and in non-fullscreen mode the window manager frame is adjusted to fit
the actual display (so you don't see the pixel cache region) and the
scrollbars are very thin to avoid distraction and trouble fitting inside
your display.  Use the "<code>-sbwidth n</code>" viewer option to make
the scrollbars thicker if you like.
</p><p>
Another drawback of the scheme is that it is <b>VERY</b> memory intensive, the <code>n</code>
in "<code>-ncache n</code>" is the factor of increase over the base framebuffer 
size to use for caching.  It is an even integer and should be fairly
large, 6-12, to achieve good response.  This usually requires about
50-100MB of additional RAM on both the client and server sides.
For example with <code>n=6</code> a 1280x1024 display will use a framebuffer
that is 1280x7168: everything below row 1024 is the pixel buffer cache.
If you are running on low memory machines or memory is tight because
of other running applications you should not use <code>-ncache</code>. 
</p><p>
The reason for so much memory is because the pixel data is not compressed
and so the whole window to be saved must be stored "offscreen".  E.g. for a
large web browser window this can be nearly 1 million pixels, and that is only
for a <em>single</em> window!  One typically wants to cycle between 5-10 large
active windows.  Also because both backing-store (the window's actual contents)
and save-unders (the pixels covered up by the window) are cached offscreen
that introduces an additional factor of 2 in memory use.
</p><p>
However, even in the smallest usage mode with <code>n</code> equal 2 and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ncache_no_rootpixmap"><code>-ncache_no_rootpixmap</code></a> set
(this requires only 2X additional framebuffer memory) there is still a
noticable improvement for many activities, although it is not as dramatic
as with, say <code>n</code> equal 12 and rootpixmap (desktop background)
caching enabled.
</p><p>
The large memory consumption of the current implementation can
be thought of as a tradeoff to providing caching <em>and</em> being compatible
with all VNC viewers and also ease of implementing.
Hopefully it can be tuned to use less, or the VNC community will extend
the protocol to allow caching and replaying of compressed blobs of data.
</p><p>
Another option to experiment with is
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ncache_cr"><code>-ncache_cr</code></a>".
By specifying it, <b>x11vnc</b> will try to do smooth <em>opaque</em> window
moves instead of its wireframe.  This can give a very nice effect (note:
on Unix the realvnc viewer seems to be smoother than the tightvnc
viewer), but can lead to some painting problems, and can be jerky in
some circumstances.
</p><p>
Surprisingly, for very slow connections, e.g. modem, the
<code>-ncache_cr</code> option can actually improve window drags.
This is probably because no pixel data (only CopyRect instructions)
are sent when dragging a window.  Normally, the wireframe must be sent
and this involves compressing and sending the lines that give rise to
the moving box effect (note that real framebuffer data is sent to
"erase" the white lines of the box.)
</p><p>
If you experience painting errors you can can tap the <code>Alt_L</code>
key (Left "Alt" key) 3 times in a row to signal <b>x11vnc</b> to
refresh the screen to all viewers.  You may also need to iconify and
then deiconify any damaged windows to correct their cache data as well.
Note that if you change color viewer depth (e.g. 8bpp to full color) dynamically
that will usually lead to the entire extended framebuffer being resent 
which can take a long time over very slow links: it may be better to 
reconnect and reset the format right after doing so.  <b>x11vnc</b>
will try to detect the format change and clear (make completely black)
the cache region.
&nbsp;</p><p>
<em>Gotcha for older Unix VNC Viewers:</em>
The older Unix VNC viewers (e.g. current TightVNC Unix Viewer) require
X server backingstore to keep off-viewer screen data local.  If the
viewer-side X server has backingstore disabled (sadly, currently the default on
Linux, etc), then to get the offscreen pixels the viewer has to ask
for a refresh over the network, thereby defeating the caching. 
Use something like this in your viewer-side <code>/etc/X11/xorg.conf</code>
file (or otherwise get your viewer-side system to do it)
</p><pre>Section "Device"
        ...
        Option  "backingstore"
        ...
EndSection
</pre>
No problems like this have been observed with Windows VNC Viewers: they all
seem to keep their entire framebuffer in local memory.
&nbsp;<p></p><p>
<em>Gotcha for KDE krdc VNC Viewer:</em>
One user found that KDE's krdc viewer has some sort of hardwired limit
on the maximum size of the framebuffer (64MB?).  It fails quickly
saying "The connection to the host has been interrupted."
The workaround for his 1280x1024 x11vnc-side display was to run
with "<code>-ncache 10</code>", i.e. a smaller value to be under the
krdc threshold.
</p><p>
Although this scheme is not as quick (nor as compressed) as nx/nomachine,
say, it does provide a good step in the direction of improving VNC
performance by client side caching.
</p><p>
</p><p>&nbsp;</p>

<a name="faq-turbovnc"></a>
<a name="FAQ-81"></a>
<p><b>Q-81:</b>
<font color="#007f00">
Does <b>x11vnc</b> support TurboVNC?
</font>
</p>
<p>
As of Feb/2009 (development tarball) there is an experimental kludge to let you build
<b>x11vnc</b> using TurboVNC's modified TightVNC encoding.
<a href="http://web.archive.org/web/20210304200604/http://www.virtualgl.org/About/TurboVNC">TurboVNC</a> is 
part of the <a href="http://web.archive.org/web/20210304200604/http://www.virtualgl.org/">VirtualGL</a> project.
It does two main things to speed up the TightVNC encoding:
</p><ul>
<li>
It eliminates bottlenecks, overheads, wait-times in the TightVNC 
encoding implementation and instead only worries about sending very well (and quickly) compressed
JPEG data.
</li>
<li>
A fast proprietary JPEG implemention is used (Intel IPP on x86) instead
of the usual <code>libjpeg</code> implementation.  
<a href="http://web.archive.org/web/20210304200604/http://sourceforge.net/project/showfiles.php?group_id=117509&amp;package_id=166100">TurboJPEG</a>
is an interface library, <code>libturbojpeg</code>, provided by the project that achieves this.
</li>
</ul>
TurboVNC works very well over LAN and evidently fast Broadband too.
When using it with <b>x11vnc</b> in such a situation you may want to
dial down the delays, e.g.
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wait"><code>-wait 5</code></a>"
and
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-defer"><code>-defer 5</code></a>"
(or even a smaller setting) to poll and pump things out more quickly.
<p></p><p>
See the instructions in "<code>x11vnc/misc/turbovnc/README</code>" for how
to build <b>x11vnc</b> with TurboVNC support.  You will also need to
download the
<a href="http://web.archive.org/web/20210304200604/http://sourceforge.net/project/showfiles.php?group_id=117509&amp;package_id=166100">TurboJPEG</a>
software.
</p><p>
In brief, the steps look like this:
</p><pre>  cd x11vnc-x.y.z/x11vnc/misc/turbovnc
  ./apply_turbovnc
  cd ../../..
  env LDFLAGS='-L/DIR -Xlinker --rpath=/DIR' ./configure
  make AM_LDFLAGS='-lturbojpeg'
</pre>
where you replace "<code>/DIR</code>" with the directory containing
<code>libturbojpeg.so</code> you downloaded separately.
If it works out well enough TurboVNC support will be integrated into
<b>x11vnc</b> and more of its tuning features will be implemented.
Support for TurboVNC in <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">SSVNC</a> viewer has been added
as an experiment as well.  If you try either one, let us know how it went.
<p></p><p>
There also may be some <code>Linux.i686</code> and
<code>Darwin.i386</code> <b>x11vnc</b> binaries with TurboVNC support
in the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/bins">misc. bins</a> directory.  For other platforms
you will need to compile yourself.
</p><p>
On relatively cheap and old hardware (Althon64 X2 5000+ / GeForce 6200) <b>x11vnc</b>
and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">SSVNC</a>, both TurboVNC enabled, were
able to sustain 13.5 frames/sec (fps) and 15 Megapixels/sec
using the VirtualGL supplied OpenGL benchmark program
<code>glxspheres</code>.  VirtualGL on higher-end hardware can sustain
<a href="http://web.archive.org/web/20210304200604/http://www.virtualgl.org/About/Reports">20-30 fps</a> with the
<code>glxspheres</code> benchmark.
</p><p>
<em><b>Potential Slowdown:</b></em>
As we describe  <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#fb_read_slow">elsewhere</a>, unless you use
<b>x11vnc</b> with an X server using, say, NVidia proprietary drivers
(or a virtual X server like Xvfb or Xdummy, or in <code>ShadowFB</code> mode),
then the read rate from the graphics card can be rather slow (e.g. 10 MB/sec) and
becomes the bottleneck when using <b>x11vnc</b> over fast networks.
Note that all of Xorg's drivers currently (2009) have slow read rates
(only proprietary drivers appear to have optimized reads.)
</p><p>
So under these (more or less typical) conditions, the speed improvement
provided by TurboVNC may only be marginal.  Look for this output
to see your read rate:
</p><pre>  28/02/2009 11:11:07 Autoprobing TCP port 
  28/02/2009 11:11:07 Autoprobing selected port 5900
  28/02/2009 11:11:08 fb read rate: 10 MB/sec
  28/02/2009 11:11:08 screen setup finished.
</pre>
A rate of 10 MB/sec means a 1280x1024x24 screen takes 0.5 seconds
to read in.  TurboVNC compresses that to JPEG in a much shorter time.
On the other hand, an NVidia driver may have a read rate of 250 MB/sec
and so only takes 0.02 seconds to read the entire screen in.
<p></p><p>&nbsp;</p>

&nbsp;<br><font size="-0"><b>[Mouse Cursor Shapes]</b></font><br>
<a name="faq-cursor-shape"></a>
<a name="FAQ-82"></a>
<p><b>Q-82:</b>
<font color="#007f00">
Why isn't the mouse cursor shape (the little icon shape where the
mouse pointer is) correct as I move from window to window?
</font>
</p>
<p>
On X servers supporting XFIXES or Solaris/IRIX Overlay extensions it is possible
for <b>x11vnc</b> to do this correctly.  See a few paragraphs down for the
answer. 
</p><p>
Historically, the X11 mouse cursor shape (i.e. little picture: an
arrow, X, I-beam, resizer, etc) is one of the few <em>WRITE-only</em>
objects in X11.  That is, an application can tell the X server what the
cursor shape should be when the pointer is in a given window, but a program
(like <b>x11vnc</b>) unfortunately cannot <em>read</em> this information.
I believe this is because the cursor shape is often downloaded to the
graphics hardware (video card), but I could be mistaken.
</p><p>
A simple kludge is provided by the
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-cursor"><code>-cursor X</code></a>" option that
changes the cursor when the mouse is on the root background (or any window
has the same cursor as the root background.)  Note that
desktops like GNOME or KDE often cover up the root background, so this
won't work for those cases. Also see the 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-cursor"><code>-cursor some</code></a>"
option for additional kludges.
</p><p>
Note that as of Aug/2004 on
Solaris using the SUN_OVL overlay extension and IRIX, <b>x11vnc</b> can show the
correct mouse cursor when the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-overlay"><code>-overlay</code></a> option
is supplied.  See <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#infaq_the-overlay-mode">this FAQ</a> for more info.
</p><p>
Also as of Dec/2004 XFIXES X extension support has been added to allow
exact extraction of the mouse cursor shape.  XFIXES fixes the problem
of the cursor-shape being write-only: <b>x11vnc</b> can now query the
X server for the current shape and send it back to the connected
viewers.  XFIXES is available on recent Linux Xorg based distros and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#solaris10-build">Solaris 10</a>.
</p><p>
The only XFIXES issue is the handling of 
alpha channel <em>transparency</em> in cursors.  If a cursor has
any translucency then in general it must be approximated to opaque
RGB values for use in VNC.  There are some situations
where the cursor transparency can also handled exactly: 
when the VNC Viewer requires the cursor shape be drawn into the VNC
framebuffer or if you apply a patch to your VNC Viewer to 
extract hidden alpha channel data under 32bpp. 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xfixes-alpha-hacks">Details can be found here</a>.
</p><p>&nbsp;</p>

<a name="faq-xfixes-alpha"></a>
<a name="FAQ-83"></a>
<p><b>Q-83:</b>
<font color="#007f00">
When using XFIXES cursorshape mode, some of the cursors look really
bad with extra black borders around the cursor and other cruft.
How can I improve their appearance?
</font>
</p>
<p>
This happens for cursors with transparency ("alpha channel");
regular X cursors (bitmaps) should be correct.  Unfortunately
<b>x11vnc</b> 0.7 was released with a very poor algorithm for
approximating the transparency, which led to the ugly black
borders.
</p><p>
The problem is as follows: XFIXES allows <b>x11vnc</b> to retrieve the
current X server cursor shape, including the alpha channel for
transparency.  For traditional bitmap cursors the alpha value will be 0
for completely transparent pixels and 255 for completely opaque pixels;
whereas for modern, eye-candy cursors an alpha value between 0 and 255
means to blend in the background colors to that degree with the cursor
colors.  The pixel color blending formula is something like this:
Red = Red_cursor * &#945; + Red_background * (1 - &#945;),
(where here 0 &#8804; &#945; &#8804; 1), with similar for Green and Blue.
The VNC protocol does not currently support an alpha channel in
cursors: it only supports regular X bitmap cursors and Rich Cursors
that have RGB (Red, Green, Blue) color data, but no "A" = alpha data.
So in general <b>x11vnc</b> has to <em>approximate</em> a cursor with
transparency to create a Rich Cursor.  This is easier said than done:
some cursor themes have cursors with complicated drop shadows and other
forms of translucency.
</p><p>
Anyway, for the <b>x11vnc</b> 0.7.1 release the algorithm for
approximating transparency is much improved and hopefully gives
decent cursor shapes for most cursor themes and you don't
have to worry about it.
</p><p>
In case it still looks bad for your cursor theme, there are (of
course!) some tunable parameters.  The 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-alphacut"><code>-alphacut n</code></a>" option
lets you set the threshold "n" (between 0 and 255): cursor
pixels with alpha values below n will be considered completely
transparent while values equal to or above n will be completely
opaque.  The default is 240.  The 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-alphafrac"><code>-alphafrac f</code></a>" option
tries to correct individual cursors that did not fare well with the
default <code>-alphacut</code> value: if a cursor has less than
fraction <code>f</code> (between 0.0 and 1.0) of its pixels selected by
the default <code>-alphacut</code>, the threshold is lowered until
<code>f</code> of its pixels are selected.  The default fraction is
0.33.
</p><p>
Finally, there is an option
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-alpharemove"><code>-alpharemove</code></a>
that is useful for themes where many cursors are light colored
(e.g. "whiteglass".)  XFIXES returns the cursor data with the RGB values
pre-multiplied by the alpha value.  If the white cursors look too grey,
specify
<code>-alpharemove</code> to brighten them by having <b>x11vnc</b> divide
out the alpha value.
</p><p>
One user played with these parameters and reported back:
</p><pre> Of the cursor themes present on my system:
 
   gentoo and gentoo-blue:   alphacut:192 - noalpharemove
   
   gentoo-silver:            alphacut:127 and alpharemove
   
   whiteglass and redglass (presumably also handhelds, which is based
   heavily on redglass) look fine with the apparent default of alphacut:255.
</pre>
<p></p><p>&nbsp;</p>

<a name="faq-xfixes-alpha-hacks"></a>
<a name="FAQ-84"></a>
<p><b>Q-84:</b>
<font color="#007f00">
In XFIXES mode, are there any hacks to handle cursor transparency ("alpha
channel") exactly?
</font>
</p>
<p>
As of Jan/2005 <code>libvncserver</code>
has been modified to allow an alpha channel (i.e. RGBA data) for
Rich Cursors.  So <b>x11vnc</b> can now send the alpha channel data to
<code>libvncserver</code>.  However, this data will only be used for
VNC clients that do not support the CursorShapeUpdates VNC extension (or have
disabled it.)  It can be disabled for all clients with the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nocursorshape"><code>-nocursorshape</code></a>
<b>x11vnc</b> option.  In this case the cursor is drawn, correctly
blended with the background, into the VNC framebuffer before being sent out
to the client.  So the alpha blending is done on the <b>x11vnc</b>
side.  Use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noalphablend"><code>-noalphablend</code></a>
option to disable this behavior (always approximate transparent cursors
with opaque RGB values.)
</p><p>
The CursorShapeUpdates VNC extension complicates matters because
the cursor shape is sent to the VNC viewers supporting it, and
the viewers draw the cursor locally.  This improves response
over slow links.  Alpha channel data for these locally drawn cursors
is not supported by the VNC protocol.
</p><p>
However, in the <code>libvncserver</code> CVS there is a patch to the
TightVNC viewer to make this work for CursorShapeUpdates under some
circumstances.  This hack is outside of the VNC protocol.  It requires
the screens on both sides to be depth 24 at 32bpp (it uses the extra
8 bits to secretly hide the cursor alpha channel data.)  Not only does
it require depth 24 at 32bpp, but it also currently requires the client
and server to be of the same endianness (otherwise the hidden alpha data
gets reset to zero by a <code>libvncserver</code> translation function;
we can fix this at some point if there is interest.)  The patch is for
the TightVNC 1.3dev5 Unix vncviewer and it enables the TightVNC viewer
to do the cursor alpha blending locally. The patch code should give an
example on how to change the Windows TightVNC viewer to achieve the same
thing (send me the patch if you get that working.)
</p><p>
This patch is applied to the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">
Enhanced TightVNC Viewer (SSVNC)</a> package we provide.
</p>

&nbsp;<br><font size="-0"><b>[Mouse Pointer]</b></font><br>
<a name="faq-cursor-arrow"></a>
<a name="FAQ-85"></a>
<p><b>Q-85:</b>
<font color="#007f00">
Why does the mouse arrow just stay in one corner in my vncviewer, whereas
my cursor (that does move) is just a dot?
</font>
</p>
<p>
This default takes advantage of a 
<a href="http://web.archive.org/web/20210304200604/http://www.tightvnc.com/">tightvnc</a>
extension (CursorShapeUpdates) that allows specifying a cursor image
shape for the local VNC viewer.  You may disable it with the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nocursor"><code>-nocursor</code></a> option to
<b>x11vnc</b> if your viewer does not have this extension.
</p><p>
Note: as of Aug/2004 this should
be fixed: the default for non-tightvnc viewers (or ones that do not
support CursorShapeUpdates) will be to draw the moving cursor into the
<b>x11vnc</b> framebuffer.  This can also be disabled via
<code>-nocursor</code>.
</p><p>&nbsp;</p>

<a name="faq-cursor-positions"></a>
<a name="FAQ-86"></a>
<p><b>Q-86:</b>
<font color="#007f00">
Can I take advantage of the TightVNC extension to the VNC protocol where
Cursor Positions Updates are sent back to all connected clients (i.e.
passive viewers can see the mouse cursor being moved around by another
viewer)?
</font>
</p>
<p>
Use the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-cursorpos"><code>-cursorpos</code></a> option when starting <b>x11vnc</b>.
A VNC viewer must support the Cursor Positions Updates for the user to
see the mouse motions (the TightVNC viewers support this.)
As of Aug/2004 <code>-cursorpos</code>
is the default.  See also 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nocursorpos"><code>-nocursorpos</code></a> and 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nocursorshape"><code>-nocursorshape</code></a>.
</p><p>&nbsp;</p>

<a name="faq-buttonmap-opt"></a>
<a name="FAQ-87"></a>
<p><b>Q-87:</b>
<font color="#007f00">
Is it possible to swap the mouse buttons (e.g. left-handed operation),
or arbitrarily remap them?  How about mapping button clicks to 
keystrokes, e.g. to partially emulate Mouse wheel scrolling?
</font>
</p>
<p>
You can remap the mouse buttons via something like:
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-buttonmap"><code>-buttonmap 13-31</code></a>
(or perhaps 12-21.)  Also, note that <code>xmodmap(1)</code> lets you directly adjust
the X server's button mappings, but in some circumstances it might be
more desirable to have <b>x11vnc</b> do it.
</p><p>
One user had an X server with only one mouse button(!) and was able
to map all of the VNC client mouse buttons to it via: <code>-buttonmap 123-111</code>.
</p><p>
Note that the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-debug_pointer"><code>-debug_pointer</code></a> option prints out much info for
every mouse/pointer event and is handy in solving problems.
</p><p>
To map mouse button clicks to keystrokes you can use the alternate format
where the keystrokes are enclosed between colons like this
:&lt;<code>KeySym</code>&gt;: in place of 
the mouse button digit.  For a sequence of keysyms separate them 
with "+" signs.  Look in the include file <code>&lt;X11/keysymdef.h&gt;</code>, or
use <code>xev(1)</code>, or <code>-debug_keyboard</code> to find the keysym names.
Button clicks can also be included in the sequence via
the fake keysyms <code>Button1</code>, etc.
</p><p>
As an example, suppose the VNC viewer
machine has a mouse wheel (these generate button 4 and 5 events), but
the machine that <b>x11vnc</b> is run on only has the 3 regular buttons.  In
normal operation <b>x11vnc</b> will discard the button 4 and 5 events.
However, either of the following button maps could possibly be of use
emulating the mouse wheel events in this case:
</p><pre>  -buttonmap 12345-123:Prior::Next:
  -buttonmap 12345-123:Up+Up+Up::Down+Down+Down:
</pre>
Exactly what keystroke "scrolling" events they should be bound to
depends on one's taste. If this method is too approximate, one could
consider not using
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-buttonmap"><code>-buttonmap</code></a>
but rather configuring the X server to think it has a mouse with 5
buttons even though the physical mouse does not.
(e.g. '<code>Option      "ZAxisMapping" "4 5"</code>'.)
<p></p><p>
Note that when a keysym-mapped mouse button is clicked down this immediately 
generates the key-press and key-release events (for each keysym in turn if
the mapping has a sequence of keysyms.)  When the mouse button goes back
up nothing is generated.  
</p><p>
If you include modifier keys like <code>Shift_L</code> instead of key-press
immediately followed by key-release the state of the modifier key is
toggled (however the initial state of the modifier key is ignored.)  So
to map the right button to type my name 'Karl Runge' I could use this:
</p><pre>  -buttonmap 3-:Shift_L+k+Shift_L+a+r+l+space+Shift_L+r+Shift_L+u+n+g+e:
</pre>
(yes, this is getting a little silly.)
<p></p><p>
BTW, Coming the other way around, if the machine you are sitting at does
not have a mouse wheel, but the remote machine does (or at least has 5
buttons configured), this key remapping can be useful:
</p><pre>  -remap Super_R-Button4,Menu-Button5
</pre>
you just tap those two keys to get the mouse wheel scrolls (this is more
useful than the Up and Down arrow keys because a mouse wheel "click"
usually gives a multi-line scroll.)
<p></p>

&nbsp;<br><font size="-0"><b>[Keyboard Issues]</b></font><br>
<a name="faq-altgr"></a>
<a name="FAQ-88"></a>
<p><b>Q-88:</b>
<font color="#007f00">
How can I get my <code>AltGr</code> and <code>Shift</code> modifiers
to work between keyboards for different languages?
</font>
</p>
<p>
The option <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-modtweak"><code>-modtweak</code></a> 
should help here.  It
is a mode that monitors the state of the <code>Shift</code> and
<code>AltGr</code> Modifiers and tries to deduce the correct keycode to send,
possibly by sending fake modifier key presses and releases in addition
to the actual keystroke.
</p><p>
<em><b>Update</b>:</em>&nbsp; As of Jul/2004 <code>-modtweak</code>
is now the default (use <code>-nomodtweak</code>
to get the old behavior.)  This was done because it was noticed on newer
XFree86 setups even on bland "us" keyboards like "<code>pc104 us</code>"
XFree86 included a "ghost" key with both "&lt;" and "&gt;" it.  This
key does not exist on the keyboard (see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-greaterless">this FAQ</a>
for more info.)  Without <code>-modtweak</code> there was then an ambiguity
in the reverse map keysym =&gt; keycode, making it so the "&lt;" symbol
could not be typed.
</p><p>
Also see the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xkbmodtweak">FAQ about the <code>-xkb</code> option</a>
for a more powerful method of modifier tweaking for use on X servers with the
XKEYBOARD extension.
</p><p>
When trying to resolve keyboard mapping problems,
note that the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-debug_keyboard"><code>-debug_keyboard</code></a> option prints out much info for
every keystroke and so can be useful debugging things.
</p><p>
Note that one user had a strange setup and none of the above helped.
His solution was to <em>disable</em> all of the above and use
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-modtweak"><code>-nomodtweak</code></a>.
This is the simplest form of keystroke insertion and it actually solved
the problem.  Try it if the other options don't help.
</p><p>&nbsp;</p>

<a name="faq-greaterless"></a>
<a name="FAQ-89"></a>
<p><b>Q-89:</b>
<font color="#007f00">
When I try to type a "&lt;" (i.e. less than) instead I get "&gt;" (i.e. greater than)!
Strangely, typing "&gt;" works OK!!
</font>
</p>
<p>
Does your keyboard have a single key with both "&lt;" and "&gt;" on it?
Even if it doesn't, your X server may think your keyboard has such a
key (e.g. <code>pc105</code> in the <code>XF86Config</code> file when
it should be something else, say <code>pc104</code>.)
</p><p>
<em>Short Cut:</em> Try the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xkb"><code>-xkb</code></a> or
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-sloppy_keys"><code>-sloppy_keys</code></a>
options and see if that helps the situation.
The discussion below is a bit outdated
(e.g. <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-modtweak"><code>-modtweak</code></a>
is now the default)
but it is useful reference for various tricks and so is kept.
</p><p>
&nbsp;</p><p>
The problem here is that on the Xserver where <b>x11vnc</b> is run
there are <b>two</b> keycodes that correspond to
the "&lt;" keysym.  Run something like this to see:
</p><p>
</p><pre>  xmodmap -pk | egrep -i 'KeyCode|less|greater'
  There are 4 KeySyms per KeyCode; KeyCodes range from 8 to 255.
      KeyCode     Keysym (Keysym) ...
       59         0x002c (comma)  0x003c (less)
       60         0x002e (period) 0x003e (greater)
       94         0x003c (less)   0x003e (greater)
</pre>
<p></p><p>
That keycode 94 is the special key with both "&lt;" and "&gt;".
When <b>x11vnc</b> receives the "&lt;" keysym over the wire from the remote
VNC client, it unfortunately maps it to keycode 94 instead of 59, 
and sends 94 to the X server.  Since <code>Shift</code> is down
(i.e. you are Shifting the comma key), the X server interprets this as
Shifted-94, which is "&gt;".
</p><p>
</p><p>
A workaround in the X server configuration is to "deaden" that special key:
</p><p>
</p><pre>  xmodmap -e "keycode 94 = "
</pre>
<p></p><p>
However, one user said he had to do this:
</p><p>
</p><pre>  xmodmap -e "keycode 94 = 0x002c 0x003c"
</pre>
<p></p><p>
(If the numerical values are different for your setup, substitute the ones that
correspond to your display.  The above <code>xmodmap</code> scheme can often be 
used to work around other ambiguous keysym to keycode mappings.)
</p><p>
Alternatively, here are some 
<b>x11vnc</b> options to try to work around the problem:
</p><pre>   -modtweak
</pre>
and
<pre>   -remap less-comma
</pre>
These are convenient in that they do not modify the actual X server settings.
The former 
(<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-modtweak"><code>-modtweak</code></a>)
is a mode that monitors the state of the <code>Shift</code>
and <code>AltGr</code> modifiers and tries to deduce the correct
keycode sequence to send.  Since Jul/2004 <code>-modtweak</code> is 
now the default.  The latter 
(<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remap"><code>-remap less-comma</code></a>) is an
immediate remapping of the keysym
<code>less</code> to the keysym <code>comma</code> when it comes in
from a client (so when <code>Shift</code> is down the <code>comma</code>
press will yield "&lt;".)
<p></p><p>
See also the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xkbmodtweak">FAQ about the <code>-xkb</code> option</a>
as a possible workaround using the XKEYBOARD extension.
</p><p>
Note that the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-debug_keyboard"><code>-debug_keyboard</code></a> option prints out much info for
every keystroke to aid debugging keyboard problems.
</p><p>&nbsp;</p>

<a name="faq-greaterless-sloppy"></a>
<a name="FAQ-90"></a>
<p><b>Q-90:</b>
<font color="#007f00">
Extra Character Inserted, E.g.: When I try to type a "&lt;" (i.e. less than) instead I get "&lt;," (i.e.
an extra comma.)
</font>
</p>
<p>
This is likely because you press "<code>Shift</code>" then "<code>&lt;</code>"
but then released the <code>Shift</code> key before releasing the
"<code>&lt;</code>".   
Because of a <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-greaterless">keymapping ambiguity</a>
the last event "<code>&lt;</code> up" is interpreted as ","
because that key unshifted is the comma.
</p><p>
This extra character insertion will happen for other combinations of
characters: in general it can happen whenever the <code>Shift</code>
key is released early.
</p><p>
This should not happen in
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xkb"><code>-xkb</code></a> mode,
because it works hard to resolve the ambiguities.
If you do not want to use <code>-xkb</code>, try the option
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-sloppy_keys"><code>-sloppy_keys</code></a>
to attempt a similar type of algorithm.
</p><p>
One user had this problem for Italian and German keyboards with the 
key containing ":" and "."  When he typed ":" he would get an extra
"." inserted after the ":".  The solution was <code>-sloppy_keys</code>. 
</p><p>&nbsp;</p>

<a name="faq-xkbmodtweak"></a>
<a name="FAQ-91"></a>
<p><b>Q-91:</b>
<font color="#007f00">
I'm using an "international" keyboard (e.g. German "de", or Danish "dk")
and the <code>-modtweak</code> mode works well if the VNC viewer is run
on a Unix/Linux machine with a similar keyboard.&nbsp;&nbsp; But if I run the VNC
viewer on Unix/Linux with a different keyboard (e.g. "us") or Windows
with any keyboard, I can't type some keys like:&nbsp;&nbsp; "@", "$", "&lt;", "&gt;", etc.
How can I fix this? 
</font>
</p>
<p>
The problem with Windows is it does not seem to handle <code>AltGr</code>
well.  It seems to fake it up by sending <code>Control_L+Alt_R</code> to
applications.
The Windows VNC viewer sends those two down keystrokes out on the wire
to the VNC server, but when the user types the next key to get, e.g., "@" the
Windows VNC viewer sends events bringing the up the <code>Control_L+Alt_R</code>
keys, and then sends the "@" keysym by itself.
</p><p>
The Unix/Linux VNC viewer on a "us" keyboard does a similar thing since
"@" is the <code>Shift</code> of the "2" key.  The keysyms <code>Shift</code>
and "@" are sent to the VNC server.
</p><p>In both cases no <code>AltGr</code>
is sent to the VNC server, but we know <code>AltGr</code> is needed
on the physical international keyboard to type a "@".
</p><p>
This all worked fine with <b>x11vnc</b> running with the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-modtweak"><code>-modtweak</code></a> option (it figures out how to adjust the Modifier
keys (<code>Shift</code> or <code>AltGr</code>) to get the "@".)
However it fails under recent versions of XFree86 (and the X.org fork.)
These run the XKEYBOARD extension by default and make heavy use of it
to handle international keyboards.
</p><p>
To make a long story short, on these newer XFree86 setups  the
traditional X keymap lookup <b>x11vnc</b> uses is no longer accurate.
<b>x11vnc</b> can't find the keysym "@" anywhere in the keymapping!
(even though it is in the XKEYBOARD extended keymapping.)
</p><p>
<b><em>How to Solve:</em></b>&nbsp;As of Jul/2004
<b>x11vnc</b> has two changes:
</p><ul>
	<li><code>-modtweak</code> (tweak Modifier keys) is now the default
		(use <code>-nomodtweak</code> to go back to the old way)</li>
	<li>there is a new option <code>-xkb</code> to use the XKEYBOARD
		extension API to do the Modifier key tweaking.
</li></ul>
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xkb"><code>-xkb</code></a> option seems to fix all of the missing keys:
"@", "&lt;", "&gt;", etc.: it is recommended that you try it if
you have this sort of problem.  Let us know if there are any remaining
problems (see the next paragraph for some known problems.)  If you
specify the <code>-debug_keyboard</code> (aka <code>-dk</code>) option
<em>twice</em>
you will get a huge amount of keystroke debugging output (send it
along with any problems you report.)  
<p></p><p>
<em><b>Update</b>:</em> as of Jun/2005 
<b>x11vnc</b> will try to automatically enable
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xkb"><code>-xkb</code></a> if it appears
that would be beneficial (e.g. if it sees any of "@", "&lt;", "&gt;", "[" and
similar keys are mapped in a way that needs the <code>-xkb</code>
to access them.)  To disable this automatic check use <code>-noxkb</code>.
</p><p>
<em>Known problems:</em>
</p><ul>
<li>One user had to disable a "ghost" <code>Mode_switch</code> key
that was causing problems under <code>-xkb</code>.
His physical <code>AltGr</code> key was
bound to <code>ISO_Level3_Shift</code> (which seems to be the XKEYBOARD
way of doing things), while there was a ghost key
<code>Mode_switch</code> (which seems to be obsolete) in the mapping as
well.  Both of these keysyms were bound to <code>Mod5</code> and
<b>x11vnc</b> was unfortunately choosing <code>Mode_switch</code>.
<p></p><p>
From the <b>x11vnc</b> <code>-xkb -dk -dk</code> output it was noted that
<code>Mode_switch</code> was attached to keycode 93 (no physical
key generates this keycode) while
<code>ISO_Level3_Shift</code> was attached to keycode 113.
The keycode skipping option was used to disable the ghost key:
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-skip_keycodes"><code>-skip_keycodes 93</code></a>
</p><p>
</p></li>
<li>In implementing <code>-xkb</code> we noticed that some characters were
still not getting through, e.g. "~" and "^".  This is not really
an XKEYBOARD problem.  What was happening was the VNC viewer was sending the
keysyms <code>asciitilde</code> and <code>asciicircum</code> 
to <b>x11vnc</b>, but on the X server with the international keyboard
those keysyms were not mapped to any keys.  So <b>x11vnc</b>
had to skip them (Note: as of May/2005 they are added by default
see -add_keysyms below.)  
<p></p><p>
The way these characters are typically entered on international
keyboards is by "dead" (aka "mute") keys.  E.g. to enter
"~" at the physical display the keysym <code>dead_tilde</code>
is pressed and released (this usually involves holding <code>AltGr</code>
down while another key is pressed) and then <code>space</code> is pressed.
(this can also be used get characters with the "~" symbol
on top, e.g. "" by typing "a" instead of <code>space</code>.) 
</p><p>
What to do? In general the VNC protocol has not really solved this
problem: what should be done if the VNC viewer sends a keysym
not recognized by the VNC server side?  Workarounds can possibly
be created using the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remap"><code>-remap</code></a> <b>x11vnc</b> option:
</p><pre>  -remap asciitilde-dead_tilde,asciicircum-dead_circumflex
</pre>  
etc.  Use <code>-remap filename</code> if the list is long.
Please send us your workarounds for this problem on your keyboard.
Perhaps we can have <b>x11vnc</b> adjust automatically at some point.
Also see the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-add_keysyms"><code>-add_keysyms</code></a>
option in the next paragraph.
<p></p><p>
<em><b>Update</b>:</em> for convenience
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remap"><code>-remap DEAD</code></a>"
does many of these mappings at once.
</p><p>
</p></li>
<li>To complement the above workaround using the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remap"><code>-remap</code></a>, an option
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-add_keysyms"><code>-add_keysyms</code></a> was added.  This option
instructs <b>x11vnc</b> to bind any unknown Keysyms coming in from
VNC viewers to unused Keycodes in the X server.
This modifies the global state of the X server.  When <b>x11vnc</b>
exits it removes the extra keymappings it created.
Note that the <code>-remap</code> mappings are applied first, 
right when the Keysym is received from a VNC viewer, and only
after that would <code>-add_keysyms</code>, or anything else, come into play.
<p></p><p>
<em><b>Update</b>:</em> <code>-add_keysyms</code> is now on by default.
Use <code>-noadd_keysyms</code> to disable.
</p></li>
</ul>
<p></p><p>&nbsp;</p>

<a name="faq-repeated-keys"></a>
<a name="FAQ-92"></a>
<p><b>Q-92:</b>
<font color="#007f00">
When typing I sometimes get double, triple, or more of my keystrokes
repeated.  I'm sure I only typed them once, what can I do?
</font>
</p>
<p>
This may be due to an interplay between your X server's key autorepeat
delay and the extra time delays caused by <b>x11vnc</b> processing.
</p><p>
Short answer: disable key autorepeating by running the command
"<code>xset r off</code>" on the Xserver where <b>x11vnc</b> is run
(restore via "<code>xset r on</code>") or use the new (Jul/2004)
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-norepeat"><code>-norepeat</code></a> <b>x11vnc</b> option.
You will still have autorepeating because that is taken
care of on your VNC viewer side.
</p><p>
<em><b>Update</b>:</em> as of Dec/2004 <code>-norepeat</code> is now the default.
Use <code>-repeat</code> to disable it.
</p><p>
<b>Details</b>:<br>suppose you press a key DOWN and it generates changes in
large regions of the screen.  The CPU and I/O work <b>x11vnc</b> does
for the large screen change could be longer than your X server's key
autorepeat delay.  <b>x11vnc</b> may not get to processing the key UP
event until after the screen work is completed.  The X server believes
the key has been held down all this time, and applies its autorepeat
rules.
</p><p>
Even without inducing changes in large regions of the screen, this
problem could arise when accessing <b>x11vnc</b> via a dialup modem
or otherwise high latency link (e.g. &gt; 250 ms latency.)
</p><p>
Look at the output of "<code>xset q</code>" for the "auto repeat delay"
setting.  Is it low (e.g. &lt; 300 ms)?  If you turn off autorepeat
completely: "<code>xset r off</code>", does the problem go away?
</p><p>
The workaround is to manually apply "<code>xset r off</code>"
and "<code>xset r on</code>" as needed, or to use the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-norepeat"><code>-norepeat</code></a> (which
has since Dec/2004 been made the default.)
Note that with X server autorepeat turned off the VNC viewer side of the
connection will (nearly always) do its own autorepeating so there is no
big loss here, unless someone is also working at the physical display
and misses his autorepeating.
</p><p>&nbsp;</p>

<a name="faq-repeated-keys-still"></a>
<a name="FAQ-93"></a>
<p><b>Q-93:</b>
<font color="#007f00">
The <b>x11vnc</b> <code>-norepeat</code> mode is in effect, but I <em>still</em>
get repeated keystrokes!!
</font>
</p>
<p>
Are you using <b>x11vnc</b> to <em>log in to</em> an X session via display
manager? (as described in <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-display-manager">this FAQ</a>)
If so, <b>x11vnc</b> is starting before your session and it disables
autorepeat when you connect, but then after you log in your session
startup (GNOME, KDE, ...) could be resetting the autorepeat to be on.
Or it could be something inside your desktop trying to be helpful that
decides to turn it back on.
</p><p>
<b>x11vnc</b> in <code>-norepeat</code>
mode will by default reset autorepeat to off 2 times (to help get thru
the session startup problem), but it will not continue to battle with things turning autorepeat back on.
It will also turn autorepeat off whenever it goes from a state of zero
clients to one client.  You can adjust the number of resets via
"<code>-norepeat N</code>", or use "<code>-norepeat -1</code>" to have
it keep resetting it whenever autorepeat gets turned back on when
clients are connected.
</p><p>
In general you can manually turn autorepeating off by typing 
"<code>xset r off</code>", or a using desktop utility/menu, or
"<code>x11vnc -R norepeat</code>".
If something in your desktop is automatically turning it
back on you should figure out how to disable that somehow.
</p><p>&nbsp;</p>

<a name="faq-mod-stuck-down"></a>
<a name="FAQ-94"></a>
<p><b>Q-94:</b>
<font color="#007f00">
After using <b>x11vnc</b> for a while, I find that I cannot type
some (or any) characters or my mouse clicks and drags no longer
have any effect, or they lead to strange effects.  What happened?
</font>
</p>
<p>
Probably a modifier key, e.g. Control or Alt is "stuck" in a
pressed down state.
</p><p>
This happens for VNC in general by the following mechanism.
Suppose on the Viewer side desktop there is some hot-key to switch
desktops/rooms/spaces, etc.  E.g. suppose Alt+LeftArrow moves to the
left desktop/room/space.  Or suppose an Alt+hotkey combination
iconifies a window.  This can leave the Alt key pressed down on the remote
side.
</p><p>
Consider the sequence that happens.  The Alt_L key and then the LeftArrow
key go down.  Since you are inside the viewer the Alt_L key press is sent
to the other side (<b>x11vnc</b>) and so it is pressed down in the remote
desktop as well.  (by "Alt_L" we mean the Alt key on the left-hand side
of the keyboard.)  Your local desktop (where the VNC Viewer is running)
then warps to the new desktop/room/space:
<b><em>Leaving the Alt_L key still pressed
down in the remote desktop.</em></b> 
</p><p>
If someone is sitting at the desktop, or when you return in the viewer
it may be very confusing because the Alt_L is still pressed down but
you (or the person sitting at the desktop) do not realize this.
Depending on which remote desktop (<b>x11vnc</b> side) is used, it can
act very strangely.
</p><p>
A quick workaround when you notice this is to press and release all
of the Alt, Shift, Control, Windows-Flag, modifier keys to free the
pressed one.  You need to do this for <b>both the left and right</b>
Shift, Alt, Control, etc. keys to be sure.
</p><p>
Note that many VNC Viewers try to guard against this when they are notified
by the window system that the viewer app has "lost focus".  When it
receives the "lost focus" event, the viewer sends VNC Key-Release events
for all modifier keys that are currently pressed down.  This does not always
work, however, since it depends on how the desktop manages these "warps".
If the viewer is not notified it cannot know it needs to release the modifiers.
</p><p>
You can also use the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-clear_mods"><code>-clear_mods</code></a> option
to try to clear all of the modifier keys at <b>x11vnc</b> startup.
You will still have to be careful that you do not leave the modifier key
pressed down during your session.  It is difficult to prevent this
problem from occurring (short of using
<code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remap">-remap</a></code> to prevent sending
<b>all</b> of the problem modifier keys, which would make the destkop pretty
unusable.)
</p><p>
During a session
these <b>x11vnc</b> remote control commands can also help:
</p><pre>   x11vnc -R clear_mods
   x11vnc -R clear_keys
   x11vnc -R clear_locks
   x11vnc -R clear_all
</pre>
<p></p><p>
A similar problem can occur if you accidentally press the Caps_Lock
or Num_Lock down.  When these are locked on the remote side it can
sometimes lead to strange desktop behavior (e.g. cannot drag or click
on windows.)  As above you may not notice this because the lock isn't
down on the local (Viewer) side.   
See <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-remap-capslock">this FAQ</a> on lock keys problem.
These options may help avoid the problem:
<code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-skip_lockkeys">-skip_lockkeys</a></code> and
<code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-capslock">-capslock</a></code>.
See also <code><a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-clear_all">-clear_all</a></code>.
</p><p>&nbsp;</p>

<a name="faq-remap-opt"></a>
<a name="FAQ-95"></a>
<p><b>Q-95:</b>
<font color="#007f00">
The machine where I run <b>x11vnc</b> has an <code>AltGr</code> key, but the
local machine where I run the VNC viewer does not.  Is there a way I 
can map a local unused key to send an <code>AltGr</code>?  How about
a <code>Compose</code> key as well?
</font>
</p>
<p>
Something like 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remap"><code>-remap Super_R-Mode_switch</code></a>" <b>x11vnc</b>
option may work.
Note that <code>Super_R</code> is the "Right Windoze(tm) Flaggie" key;
you may want to choose another.  The <code>-debug_keyboard</code> option
comes in handy in finding keysym names (so does <code>xev(1)</code>.)
</p><p>
For <code>Compose</code> how about "<code>-remap Menu-Multi_key</code>"
(note that <code>Multi_key</code> is the official name for <code>Compose</code>.)
To do both at the same time: "<code>-remap Super_R-Mode_switch,Menu-Multi_key</code>"
or use "<code>-remap filename</code>" to specify remappings from a file.
</p><p>&nbsp;</p>

<a name="faq-sun-alt-meta"></a>
<a name="FAQ-96"></a>
<p><b>Q-96:</b>
<font color="#007f00">
I have a Sun machine I run <b>x11vnc</b> on.  Its Sun keyboard
has just one <code>Alt</code> key labelled "Alt" and two <code>Meta</code>
keys labelled with little diamonds.  The machine where I run the
VNC viewer only has <code>Alt</code> keys.  How can I send a <code>Meta</code>
keypress?  (e.g. emacs needs this) 
</font>
</p>
<p>
Here are a couple ideas.  The first one is to simply use <code>xmodmap(1)</code>
to adjust the Sun X server.  Perhaps <code>xmodmap -e "keysym Alt_L = Meta_L Alt_L"</code>
will do the trick.
(there are other ways to do it, one user used:
<code>xmodmap -e "keycode 26 = Meta_L"</code> for his setup.)
</p><p>
Since <code>xmodmap(1)</code> modifies the X server mappings you may not want to
do this (because it affects local work on that machine.)
Something like the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remap"><code>-remap Alt_L-Meta_L</code></a>
to <b>x11vnc</b> may be sufficient for ones needs, and does not modify
the X server environment.  Note that you cannot send <code>Alt_L</code>
in this case, maybe <code>-remap Super_L-Meta_L</code> would be a better choice
if the <code>Super_L</code> key is typically unused in Unix.
</p><p>&nbsp;</p>

<a name="faq-hpux-multi-key"></a>
<a name="FAQ-97"></a>
<p><b>Q-97:</b>
<font color="#007f00">
Running <b>x11vnc</b> on HP-UX I cannot type "#" I just get a "3" instead.
</font>
</p>
<p>
One user reports this problem on HP-UX Rel_B.11.23.  The problem
was traced to a strange keyboard mapping for the machine (e.g.
<code>xmodmap -pk</code> output) that looked like:
</p><pre>  ...
  039  2                  at                 at               at
  ...
  047  3                  numbersign         numbersign       numbersign
</pre>
and similar triple mappings (with two in the AltGr/Mode_switch group)
of a keysum to a single keycode.
<p></p><p>
Use the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nomodtweak">-nomodtweak</a> 
option as a workaround.  You can also use <code>xmodmap</code> to
correct these mappings in the server, e.g.:
</p><pre>  xmodmap -e "keycode 47 = 3 numbersign"
</pre>
Also, as of Feb/2007, set the environment variable 
<code>MODTWEAK_LOWEST=1</code> (either in your shell 
or via "<code>-env MODTWEAK_LOWEST=1</code>" option)
to handle these mappings better.
<p></p><p>&nbsp;</p>

<a name="faq-remap-button-click"></a>
<a name="FAQ-98"></a>
<p><b>Q-98:</b>
<font color="#007f00">
Can I map a keystroke to a mouse button click on the remote machine? 
</font>
</p>
<p>
This can be done directly in some X servers using AccessX and
Pointer_EnableKeys, but is a bit awkward.  It may be more convenient to 
have <b>x11vnc</b> do the remapping.  This can be done via the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remap"><code>-remap</code></a> option using the fake "keysyms" 
<code>Button1</code>, <code>Button2</code>, etc. as the "to" keys (i.e.
the ones after the "-")
</p><p>
As an example, consider a laptop where the VNC viewer is run that has a
touchpad with only two buttons.  It is difficult to do a middle button
"paste" because (using XFree86/Xorg Emulate3Buttons) you have to click both
buttons on the touch pad at the same time.  This remapping:
</p><pre>  <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remap">-remap Super_R-Button2</a>
</pre>
maps the <code>Super_R</code> "flag" key press to the Button2 click,
thereby making X pasting a bit easier.
<p></p><p>
Note that once the key goes down, the button down and button up events
are generated immediately on the <b>x11vnc</b> side.  When the key is
released (i.e. goes up) no events are generated.
</p>

<a name="faq-remap-capslock"></a>
<a name="FAQ-99"></a>
<p><b>Q-99:</b>
<font color="#007f00">
How can I get Caps_Lock to work between my VNC viewer and <b>x11vnc</b>?
</font>
</p>
<p>
This is a little tricky because it is possible to get the Caps_Lock state
out of sync between your viewer-side machine and the x11vnc-side X server.
For best results, we recommend not ever letting the Caps_Lock keypresses
be processed by <b>x11vnc</b>.  That way when you press Caps_Lock
in the viewer your local machine goes into the Caps_Lock on state and sends
keysym "A" say when you press "a".  <b>x11vnc</b> will then fake things
up so that Shift is held down to generate "A".  The
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-skip_lockkeys">-skip_lockkeys</a> option
should help to accomplish this.
For finer grain control use something like:
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-remap">-remap</a> Caps_Lock-None".
</p><p>
Also try the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nomodtweak">-nomodtweak</a> and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-capslock">-capslock</a> options.
</p><p>
Another useful option that turns off any Lock keys on the remote side at
startup and end is the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-clear_all">-clear_all</a> option.
During a session you can run these remote control commands to modify the Lock keys:
</p><pre>   x11vnc -R clear_locks
   x11vnc -R clear_all
</pre>
the former will try to unset any Lock keys, the latter will do same and also
try to make it so no key is pressed down (e.g. "stuck" Alt_L, etc.)
<p></p>

&nbsp;<br><font size="-0"><b>[Screen Related Issues and Features]</b></font><br>
<a name="faq-scrollbars"></a>
<a name="FAQ-100"></a>
<p><b>Q-100:</b>
<font color="#007f00">
The remote display is larger (in number of pixels) than the local display
I am running the <b>vncviewer</b> on.  I don't like the <b>vncviewer</b> scrollbars, 
what I can do? 
</font>
</p>
<p>
<b>vncviewer</b> has a option (usually accessible via <code>F8</code> key
or <code>-fullscreen</code> option) for <b>vncviewer</b> to run in full screen,
where it will automatically scroll when the mouse is near the edge of
the current view.
For quick scrolling, also make sure Backing Store is enabled on the
machine <b>vncviewer</b> is run on.  (XFree86/Xorg disables it by default
for some reason, add Option "backingstore" to XF86Config on the
<b>vncviewer</b> side.)
</p><p>
BTW, contact me if you are having problems with <b>vncviewer</b> in
fullscreen mode with your window manager (i.e. no keyboard response.)  I
have a workaround for <b>vncviewer</b> using <code>XGrabServer()</code>.
</p><p>
There may also be scaling viewers out there (e.g. TightVNC or UltraVNC on
Windows) that automatically shrink or expand the remote framebuffer to
fit the local display.  Especially for hand-held devices.
See also <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-scaling">the next FAQ on x11vnc scaling</a>.
</p><p>&nbsp;</p>

<a name="faq-scaling"></a>
<a name="FAQ-101"></a>
<p><b>Q-101:</b>
<font color="#007f00">
Does <b>x11vnc</b> support server-side framebuffer scaling?  (E.g. to
make the desktop smaller.)
</font>
</p>
<p>
As of Jun/2004 <b>x11vnc</b> provides
basic server-side scaling.  It is a global scaling of the desktop, not
a per-client setting.  To enable it use the 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-scale"><code>-scale fraction</code></a>" option.
"fraction" can either be a floating point
number (e.g. <code>-scale 0.75</code>) or the alternative m/n fraction
notation (e.g. <code>-scale 3/4</code>.)
Note that if fraction is greater than one the display is magnified.
</p><p>
Extra resources (CPU, memory I/O, and memory) are required
to do the scaling.  If the machine is slow where <b>x11vnc</b> is run
with scaling enabled, the interactive response can be unacceptable.
OTOH, if run with scaling on a fast machine the performance degradation
is usually not a big issue or even noticeable.
</p><p>
It may help to compile <b>x11vnc</b> with compiler option <code>-O3</code>
or <code>-O4</code> to speed up the scaling code.  Set the <code>CFLAGS</code>
env. var. before running <code>configure</code>.
</p><p>
Also, if you just want a quick, rough "thumbnail" of the display you can
append ":nb" to the fraction to turn on "no blending" mode.  
E.g.: "<code>-scale 1/3:nb</code>"  Fonts will
be difficult to read, but the larger features will be recognizable.
BTW, "no blending" mode is forced on when scaling 8bpp PseudoColor displays
(because blending an indexed colormap is a bad idea and leads to random colors,
use <code>:fb</code> to force it on.)
</p><p>
One can also use the ":nb" with an integer scale factor
(say "<code>-scale 2:nb</code>") to use <b>x11vnc</b> as a screen magnifier
for vision impaired
<a href="http://web.archive.org/web/20210304200604/http://people.pwf.cam.ac.uk/ssb22/setup/vnc-magnification.html">applications</a>.
Since with integer scale factors the framebuffers become huge and
scaling operations time consuming, be sure to use ":nb" for the fastest
response.
</p><p>
In general for a scaled display if you are using a TightVNC viewer you
may want to turn off jpeg encoding (e.g. <code>vncviewer -nojpeg host:0</code>.)
There appears to be a noise enhancement effect, especially for regions
containing font/text: the scaling can introduce some pixel artifacts
that evidently causes the tight encoding algorithm to incorrectly detect
the regions as image data and thereby introduce additional pixel artifacts
due to the lossiness of the jpeg compression algorithm.  Experiment to
see if <code>-nojpeg</code> vncviewer option improves the readability of text
when using <code>-scale</code> to shrink the display size.
Also note that scaling may actually slow down the transfer of 
text regions because after being scaled they do not compress as well.
(this can often be a significant slowdown, e.g. 10X.)
</p><p>
Another issue is that it appears VNC viewers require the screen width
to be a multiple of 4.  When scaling <b>x11vnc</b> will round the 
width to the nearest multiple of 4.  To disable this use the ":n4" sub
option (like ":nb" in the previous paragraph; to specify both
use a comma: ":nb,n4", etc.)
</p><p>
If one desires per-client scaling for something like 1:1 from 
a workstation and 1:2 from a smaller device (e.g. handheld),
currently the only option is to run two (or more) <b>x11vnc</b>
processes with different scalings listening on separate ports
(<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rfbport"><code>-rfbport</code></a> option, etc.)
</p><p>
<em><b>Update</b></em>: 
As of May/2006 <b>x11vnc</b> also supports the UltraVNC server-side
scaling.  This is a per-client scaling by factors 1/2, 1/3, ... and
so may be useful for PDA's ("<code>-scale 1/2</code>", etc. will give
similar results except that it applies to all clients.)
You may need to supply "<code>-rfbversion 3.6</code>" for this to be
recognized by UltraVNC viewers.
</p><p>
<a name="infaq_multiple-x11vncs"></a>
BTW, whenever you run two or more <b>x11vnc</b>'s on the same X display
<em>and</em> use the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-gui">GUI</a>, then to avoid all of the
<b>x11vnc</b>'s simultaneously answering the gui you will
need to use something like
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-connect">"<code>-connect file1 -gui ...</code>"</a>
with different connect files for each <b>x11vnc</b> you want to control
via the gui (or remote-control.)  The "<code>-connect file1</code>"
usage gives separate communication channels between a x11vnc process and the gui
process.  Otherwise they all share the same X property channels:
<code>VNC_CONNECT</code> and <code>X11VNC_REMOTE</code>.
</p><p>
<em><b>Update</b></em>: 
As of Mar/2005 <b>x11vnc</b> now scales
the mouse cursor with the same scale factor as the screen.
If you don't want that, use the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-scale_cursor">"<code>-scale_cursor frac</code>"</a> option
to set the cursor scaling to a different factor
(e.g. use "<code>-scale_cursor 1</code>" to keep the cursor at its natural
unscaled size.)
</p><p>&nbsp;</p>

<a name="faq-xinerama"></a>
<a name="FAQ-102"></a>
<p><b>Q-102:</b>
<font color="#007f00">
Does <b>x11vnc</b> work with Xinerama? (i.e. multiple monitors joined
together to form one big, single screen.)
</font>
</p><p>
Yes, it should generally work because it simply polls the big effective
screen.
</p><p>
If the viewing-end monitor is not as big as the remote Xinerama
display, then the <b>vncviewer</b> scrollbars, etc, will have to be used to pan
across the large area.
However one user started two <b>x11vnc</b>'s, one with
"<code>-clip 1280x1024+0+0</code>" and the other with
"<code>-clip 1280x1024+1280+0</code>" to split the big screen into
two and used two VNC viewers to access them.
</p><p>
As of Jun/2008: Use "<code>-clip xinerama0</code>" to clip to the first xinerama
sub-screen (if xinerama is active.)  xinerama1 for the 2nd sub-screen,
etc.  This way you don't need to figure out the WxH+X+Y of the desired
xinerama sub-screen.  screens are sorted in increasing distance from the
(0,0) origin (I.e. not the Xserver's order.)
</p><p>
There are a couple potential issues with Xinerama however.  If the screen is not
rectangular (e.g. 1280x1024 and 1024x768 monitors joined together), then
there will be "non-existent" areas on the screen.  The X server will
return "garbage" image data for these areas and so they may be
distracting to the viewer.  The
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-blackout"><code>-blackout</code></a>
<b>x11vnc</b> option allows you to blacken-out rectangles by manually
specifying their WxH+X+Y geometries.  If your system
has the <code>libXinerama</code> library, the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xinerama"><code>-xinerama</code></a> <b>x11vnc</b> option can be used to have it automatically determine the
rectangles to be blackened out.
(Note on 8bpp PseudoColor displays the
fill color may not be black.)
<em><b>Update</b></em>: <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xinerama"><code>-xinerama</code></a> is now on by default.
</p><p>
Some users have reported that the mouse does
not behave properly for their Xinerama display: i.e. the mouse cannot
be moved to all regions of the large display.  If this happens
try using the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xwarppointer"><code>-xwarppointer</code></a> option.  This instructs
<b>x11vnc</b> to fake mouse pointer motions using the
<code>XWarpPointer</code> function instead of the
<code>XTestFakeMotionEvent</code> XTEST function. (This may be due
to a bug in the X server for XTEST when Xinerama is enabled.)
<em><b>Update</b></em>: 
As of Dec/2006 <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xwarppointer"><code>-xwarppointer</code></a>
will be applied automatically if Xinerama is detected. To disable use:
<code>-noxwarppointer</code>
</p><p>&nbsp;</p>

<a name="faq-multi-screen"></a>
<a name="FAQ-103"></a>
<p><b>Q-103:</b>
<font color="#007f00">
Can I use <b>x11vnc</b> on a multi-headed display that is not Xinerama
(i.e. separate screens <code>:0.0</code>, <code>:0.1</code>, ... 
for each monitor)?
</font>
</p>
<p>
You can, but it is a little bit awkward: you must start separate
<b>x11vnc</b> processes for each screen, and on the viewing end start up
separate VNC viewer processes connecting to them.  e.g. on the remote end:
</p><pre>  x11vnc -display :0.0 -bg -q -rfbport 5900
  x11vnc -display :0.1 -bg -q -rfbport 5901
</pre>
(this could be automated in the display manager <code>Xsetup</code> for example)
and then on the local machine where you are sitting:
<pre>  vncviewer somehost:0 &amp;
  vncviewer somehost:1 &amp;
</pre>
<p></p><p>
<em><b>Update</b>:</em> Since about 2009 (Xorg 7.4?) there appears to be a bug
in the Xorg X server where the XTestFakeMotionEvent() interface ignores
the screen argument passed to it.  This makes it impossible to switch
the mouse between the multiple screens via the vncviewers.  A workaround
for this Xorg bug is to call x11vnc with the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xwarppointer"><code>-xwarppointer</code></a> option.
</p><p>
Note: if you are running on Solaris 8 or earlier you can easily hit up
against the maximum of 6 shm segments per process (for <code>Xsun</code>
in this case) from running multiple <b>x11vnc</b> processes.
You should modify <code>/etc/system</code> as mentioned in another 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-solshm">FAQ</a> to increase the limit.  It is probably also a
good idea to run with the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-onetile"><code>-onetile</code></a> option in this case
(to limit each <b>x11vnc</b> to 3 shm segments), or even 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noshm"><code>-noshm</code></a>
to use no shm segments.
</p><p>&nbsp;</p>

<a name="faq-clip-screen"></a>
<a name="FAQ-104"></a>
<p><b>Q-104:</b>
<font color="#007f00">
Can <b>x11vnc</b> show only a portion of the display?  (E.g. for
a special purpose application or a very large screen.)
</font>
</p>
<p>
As of Mar/2005 <b>x11vnc</b> has the
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-clip"><code>-clip WxH+X+Y</code></a>" option to
select a rectangle of width <code>W</code>, height <code>H</code>
and offset <code>(X, Y)</code>. Thus the VNC screen will be the clipped
sub-region of the display and be only <code>WxH</code> in size.
One user used <code>-clip</code> to split up a large
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xinerama">Xinerama screen</a> into two more managable
smaller screens.
</p><p>
This also works to view a sub-region of a single application window if the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-id"><code>-id</code></a> or
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-id"><code>-sid</code></a> options are used.
The offset is measured from the upper left corner of the selected window.
</p><p>&nbsp;</p>

<a name="faq-xrandr"></a>
<a name="FAQ-105"></a>
<p><b>Q-105:</b>
<font color="#007f00">
Does <b>x11vnc</b> support the XRANDR (X Resize, Rotate and Reflection)
extension?  Whenever I rotate or resize the screen <b>x11vnc</b> 
just seems to crash.  
</font>
</p>
<p>
As of Dec/2004 <b>x11vnc</b>
supports XRANDR.  You enable it with the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-xrandr"><code>-xrandr</code></a> option to make <b>x11vnc</b> monitor XRANDR events and also
trap X server errors if the screen change occurred in the middle
of an X call like <code>XGetImage</code>.  Once it traps the screen
change it will create a new framebuffer using the new screen.
</p><p>
If the connected vnc viewers support the NewFBSize VNC extension
(Windows TightVNC viewer and RealVNC 4.0 windows and Unix viewers do)
then the viewer will automatically resize.  Otherwise, the new
framebuffer is fit as best as possible into the original viewer size
(portions of the screen may be clipped, unused, etc.)
For these viewers you can try the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-padgeom"><code>-padgeom</code></a> option
to make the region big enough to hold all resizes and rotations.
We have fixed this problem for the TightVNC Viewer on Unix:
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">SSVNC</a>
</p><p>
If you specify "<code>-xrandr newfbsize</code>" then vnc viewers 
that do not support NewFBSize will be disconnected before the resize.
If you specify "<code>-xrandr exit</code>" then all will be disconnected
and <b>x11vnc</b> will terminate.
</p><p>&nbsp;</p>

<a name="faq-rotate"></a>
<a name="FAQ-106"></a>
<p><b>Q-106:</b>
<font color="#007f00">
Independent of any XRANDR, can I have <b>x11vnc</b> rotate and/or
reflect the screen that the VNC viewers see?  (e.g. for a handheld
whose screen is rotated 90 degrees.)
</font>
</p>
<p>
As of Jul/2006 there is the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rotate"><code>-rotate</code></a> option
allow this.  E.g's: "<code>-rotate +90</code>", "<code>-rotate -90</code>",
"<code>-rotate x</code>", etc.
</p><p>&nbsp;</p>

<a name="faq-black-screen"></a>
<a name="FAQ-107"></a>
<p><b>Q-107:</b>
<font color="#007f00">
Why is the view in my VNC viewer completely black?  Or why is
everything flashing around randomly?
</font>
</p>
<p>
See the next FAQ for a possible explanation.
</p><p>&nbsp;</p>

<a name="faq-linuxvc"></a>
<a name="FAQ-108"></a>
<p><b>Q-108:</b>
<font color="#007f00">
I use Linux <b>Virtual Terminals</b> (VT's) to implement 'Fast User Switching'
between users' sessions (e.g. Betty is on <code>Ctrl-Alt-F7</code>,
Bobby is on <code>Ctrl-Alt-F8</code>, and Sid is on
<code>Ctrl-Alt-F1</code>: they use those keystrokes to switch between
their sessions.)&nbsp;&nbsp; How come the view in a VNC viewer connecting to
<b>x11vnc</b> is either completely black, doesn't update, or pixels messed up
unless the X session <b>x11vnc</b> is attached to is in <b>the active VT</b>?
</font>
</p>
<p>
This seems to have to do with how applications (the X server processes in
this case) must "play nicely" if they are not on the active VT (sometimes
called VC for virtual console.)  That is, they should not
read from the keyboard or mouse or manage the video display unless they
have the active VT.  Given that it appears the <code>XGetImage()</code> call
must ultimately retrieve the framebuffer data from the video hardware itself, it would
make sense <b>x11vnc</b>'s polling wouldn't work unless the X session 
had active control of the VT.
</p><p>
There does not seem to be an easy way to work around this.  Even
<code>xwd(1)</code> doesn't work in this case (try it.)  Something
would need to be done at a lower level, say in the XFree86/Xorg X server.
Also, using the Shadow Framebuffer (a copy of the video
framebuffer is kept in main memory) does not appear to fix the
problem (last checked 2007.)
</p><p>
If no one is sitting at the workstation and you just want to remotely
switch the VT over to the one associated with your X session (so
<b>x11vnc</b> can poll it correctly), one can use the <code>chvt(1)</code>
command, e.g. "<code>chvt 7</code>" for VT #7.
</p><p>&nbsp;</p>

<a name="faq-hidden-taskbars"></a>
<a name="FAQ-109"></a>
<p><b>Q-109:</b>
<font color="#007f00">
I am using <b>x11vnc</b> where my local machine has "popup/hidden taskbars"
and the remote display where  <b>x11vnc</b> runs also has "popup/hidden
taskbars" and they interfere and fight with each other.  What can I do?
</font>
</p>
<p>
When you move the mouse to the edge of the screen where the popups happen,
the taskbars interfere with each other in strange ways.  This sometimes
happens where the local machine is GNOME or Mac OS X and the remote
machine is GNOME.  Is there a way to temporarily disable one or both of
these magic desktop taskbars?
</p><p>
One <b>x11vnc</b> user suggests: it should be straightforward to right
mouse click on the task bar panel, and uncheck "enable auto-hide" from
the panel properties dialog box.  This will make the panel always
visible.
</p>

<a name="faq-kde-screensaver"></a>
<a name="FAQ-110"></a>
<p><b>Q-110:</b>
<font color="#007f00">
Help! <b>x11vnc</b> and my KDE screensaver keep switching each other on and off every few seconds.
</font>
</p>
<p>
This is a new (Jul/2006) problem seen, say, on the version of KDE that
is shipped with SuSE 10.1.  It is not yet clear what is causing this...
If you move the mouse through <b>x11vnc</b> the screensaver shuts off
like it should but then a second or two after you stop moving the mouse
the screensaver snaps back on.
</p><p>
This may be a bug in <code>kdesktop_lock</code>.  For now the only workaround
is to disable the screensaver.  You can try using another one such as
straight <code>xscreensaver</code> 
(see the instructions <a href="http://web.archive.org/web/20210304200604/http://www.jwz.org/xscreensaver/man1.html">here</a>
for how to disable <code>kdesktop_lock</code>.)
If you have more info on this or see it outside of KDE please let us know.
</p><p>
<em><b>Update</b>:</em> It appears this is due to <code>kdesktop_lock</code>
enabling the screen saver when the Monitor is in DPMS low-power state
(e.g. standby, suspend, or off.)  In Nov/2006 the <b>x11vnc</b>
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nodpms"><code>-nodpms</code></a> option
was added as a workaround.  Normally it is a good thing that the
monitor powers down (since <b>x11vnc</b> can still poll the framebuffer
in this state), but if you experience the <code>kdesktop_lock</code>
problem you can specify the "<code>-nodpms</code>" option to keep
the Monitor out of low power state while VNC clients are connected.
This is basically the same as typing "<code>xset dpms force on</code>"
periodically.  (if you don't want to do these things just disable  
the screensaver.)  Feel free to file a bug against <code>kdesktop_lock</code>
with KDE.
</p>

<a name="faq-beryl"></a>
<a name="FAQ-111"></a>
<p><b>Q-111:</b>
<font color="#007f00">
I am running the compiz 3D window manager (or beryl, MythTv, Google Earth,
or some other OpenGL app) and I do not get screen updates in <b>x11vnc</b>.
</font>
</p>
<p>
This appears to be because the 3D OpenGL/GLX hardware screen updates
do not get reported via the XDAMAGE mechanism.  So this is a bug in
compiz/beryl or XDAMAGE/Xorg or
the (possibly 3rd party) video card driver.
</p><p>
As a workaround apply the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noxdamage"><code>-noxdamage</code></a> option.
As of Feb/2007 <b>x11vnc</b> will try to autodetect the problem and
disable XDAMAGE if is appears to be missing a lot of updates.
But if you know you are using compiz you might as well always supply
<code>-noxdamage</code>.
Thanks to
<a href="http://web.archive.org/web/20210304200604/http://www.dslinux.org/blogs/pepsiman/?p=73">this user</a>
who reported the problem and discovered the workaround.
</p><p>
A developer for <a href="http://web.archive.org/web/20210304200604/http://minimyth.org/">MiniMyth</a>
reports that the 'alphapulse' tag of the theme G.A.N.T. can also
cause problems, and should be avoided when using VNC.
</p><p>
Please report a bug or complaint to Beryl/Compiz and/or Xorg about this:
running x11vnc with <code>-noxdamage</code> disables a nice improvement
in responsiveness (especially for typing) and also leads to unnecessary
CPU and memory I/O load due to the extra polling.
</p><p>
<em><b>Update</b>:</em> as of May/2010 NVIDIA may have fixed this
problem in their proprietary drivers.  See the <a href="http://web.archive.org/web/20210304200604/http://www.nvnews.net/vbulletin/showthread.php?t=151186">NVIDIA Release Notes.</a>
(look for 'x11vnc'.)
</p>

<a name="faq-vmware"></a>
<a name="FAQ-112"></a>
<p><b>Q-112:</b>
<font color="#007f00">
Can I use <b>x11vnc</b> to view my VMWare session remotely?
</font>
</p><p>
Yes, since VMWare usually runs as an X application you can view it via
<b>x11vnc</b> in the normal way.
</p><p>
Note that VMWare has several viewing modes:
</p><ul>
	<li>Normal X application window&nbsp; (with window manager frame)</li>
	<li>Quick-Switch mode&nbsp; (with no window manager frame)</li>
	<li>Fullscreen mode</li>
</ul>
The way VMWare does Fullscreen mode on Linux is to display the Guest
desktop in a separate Virtual Terminal (e.g. VT 8)
(see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-linuxvc">this FAQ on VT's</a> for background.) 
Unfortunately, this Fullscreen VT is not an X server.  So 
<b>x11vnc</b> cannot access it (however, <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-rawfb">see
this discussion of <code>-rawfb</code></a> for a possible workaround.)
<b>x11vnc</b> works fine with
"Normal X application window" and "Quick-Switch mode"
because these use X.
<p></p><p>
<em><b>Update</b>:</em> It appears the in VMWare 5.x the Fullscreen mode is
X, so <b>x11vnc</b> access does work.
</p><p>
One user reports he left his machine with VMWare in the Fullscreen mode,
and even though his X session wasn't in the active VT, he could still
connect <b>x11vnc</b> to the X session and pass the keystrokes
<code>Ctrl-Alt</code> (typing "blind") to the VMWare X app.
This induced VMWare to switch out of Fullscreen into Normal X mode and
he could continue working in the Guest desktop remotely.
</p><p>
&nbsp;</p><p>
<em>Aside:</em>
Sometimes it is convenient (for performance, etc.) to start VMWare in
its own X session using <code>startx(1)</code>.  This can be
used to have a minimal window manger (e.g. <code>twm</code> or
even no window manager), to improve response.  One can also cut
the display depth (e.g. to 16bpp) in this 2nd X session to 
improve video performance.  This 2nd X session emulates 
Fullscreen mode to some degree and can be viewed
via <b>x11vnc</b> as long as the VMWare X session
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-linuxvc">is in the active VT</a>.
</p><p>
Also note that with a little bit of playing with "<code>xwininfo -all
-children</code>" output one can extract the (non-toplevel) window-id of the
of the Guest desktop only when VMWare is running as a normal X application.
Then one can export just the guest desktop (i.e. without the VMWare
menu buttons) by use of the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-id"><code>-id windowid</code></a> option.
The caveats are the X session VMWare is in must be in the active VT
and the window must be fully visible, so this mode is not terribly convenient,
but could be useful in some circumstances (e.g. running VMWare on a very
powerful server machine in a server room that happens to have a video card,
(but need not have a monitor, Keyboard or mouse).)
</p><p>&nbsp;</p>


&nbsp;<br><font size="-0"><b>[Exporting non-X11 devices via VNC]</b></font><br>
<a name="faq-rawfb"></a>
<a name="FAQ-113"></a>
<p><b>Q-113:</b>
<font color="#007f00">
Can non-X devices (e.g. a raw framebuffer) be viewed (and even controlled)
via VNC with <b>x11vnc</b>?
</font>
</p><p>
As of Apr/2005 there is support for this.
Two options were added: 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rawfb"><code>-rawfb string</code></a>"
(to indicate the raw frame buffer device, file, etc. and its parameters) and 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-pipeinput"><code>-pipeinput command</code></a>"
(to provide an external program that will inject or otherwise process
mouse and keystroke input.)
Some useful 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-pipeinput"><code>-pipeinput</code></a>
schemes, <code>VID</code>, <code>CONSOLE</code>, and <code>UINPUT</code>,
have since been built into <b>x11vnc</b> for convenience.
</p><p>
This non-X mode for <b>x11vnc</b> is somewhat experimental because
it is so removed in scope from the intended usage of the tool.
Incomplete attempt is made to make all of the other options consistent
with non-X framebuffer polling.  So all of the X-related options
(e.g. <code>-add_keysyms</code>, <code>-xkb</code>) are just ignored
or may cause an error if used.  Be careful applying such an
option via remote control.
</p><p>
The format for the <code>-rawfb</code> string is:
</p><pre>    -rawfb &lt;type&gt;:&lt;object&gt;@&lt;W&gt;x&lt;H&gt;x&lt;bpp&gt;[-&lt;BPL&gt;][:&lt;R&gt;/&lt;G&gt;/&lt;B&gt;][+&lt;offset&gt;]
</pre>
There are also some useful aliases (e.g. "<code>console</code>".)
Some examples:
<pre>    -rawfb shm:210337933@800x600x32:ff/ff00/ff0000

    -rawfb map:/dev/fb0@1024x768x16

    -rawfb map:/tmp/Xvfb_screen0@640x480x8+3232

    -rawfb file:/tmp/my.pnm@250x200x24+37

    -rawfb file:/dev/urandom@128x128x8

    -rawfb snap:/dev/video0@320x240x24 -24to32

    -rawfb console

    -rawfb vt2

    -rawfb video

    -rawfb setup:mycmd.sh

</pre>
So the type can be "<code>shm</code>" for shared memory objects,
and "<code>map</code>" or "<code>file</code>" for file objects.
"<code>map</code>" uses <code>mmap(2)</code> to map the file into
memory and is preferred over "<code>file</code>" (that uses the slower
<code>lseek(2)</code> access method.)  Only use <code>file</code> if
<code>map</code> isn't working. BTW, "<code>mmap</code>" is an alias for
"<code>map</code>" and if you do not supply a type and the file exists,
<code>map</code> is assumed (see the -help output and below for some exceptions to this.)
The "<code>snap:</code>" setting applies the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-snapfb"><code>-snapfb</code></a> option
with "<code>file:</code>" type reading (this is useful for exporting
webcams or TV tuner video; see <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-video">the next FAQ</a> for more info.)
<p></p><p>
Also, if the string is of the form "<code>setup:cmd</code>" then 
<code>cmd</code> is run and the first line of its output retrieved
and used as the rawfb string.  This allows initializing the device, 
determining WxHxB, etc.
</p><p>
The object will be the numerical shared memory id for the case of
<code>shm</code>.  The idea here is some other program has created
this shared memory segment and periodically updates it with new
framebuffer data.  <b>x11vnc</b> polls the area for changes.
See <code>shmat(2)</code> and <code>ipcs(8)</code> for more 
info.  The <code>ipcs</code> command will list current shared
memory segments on the system.
Sometimes you can snoop on a program's framebuffer it did not expect
you would be polling!
</p><p>
The object will be the path to the regular or character special
file for the cases of <code>map</code> and <code>file</code>.
The idea here is that in the case of a regular file some other
program is writing/updating framebuffer image data to it.
In the case of a character special (e.g. <code>/dev/fb0</code>)
it is the kernel that is "updating" the framebuffer data.
</p><p>
In most cases <b>x11vnc</b> needs to be told the width, height,
and number of bits per pixel (bpp) of the framebuffer.
This is the <code>@WxHxB</code> field.  For the case of the
Linux framebuffer device, <code>/dev/fb0</code>, the <code>fbset(8)</code>
may be of use (but may not always be accurate for what is
currently viewable.)  In general some guessing may be required, especially
for the bpp. <em><b>Update</b>:</em> in "<code>-rawfb console</code>"
mode <b>x11vnc</b> will use the linuxfb API to try to guess
(it is still not always accurate.)  Also try "<code>-rawfb vtN</code>"
(on x11vnc 0.9.7 and later) for the N-th Linux text console (aka virtual terminal.)
If the number of Bytes Per Line is not WxHxB/8 (i.e. the framebuffer lines
are padded) you can specify this information after WxHxB via "-BPL",
e.g. @800x600x16-2048
</p><p>
Based on the bpp <b>x11vnc</b> will try to guess the red, green, 
and blue masks (these indicate which bits correspond to each color.)
It if gets it wrong you can specify them manually via the
optional "<code>:R/G/B</code>" field.
E.g. "<code>:0xff0000/0x00ff00/0x0000ff</code>" (this is the default for 32bpp.)
</p><p>
Finally, the framebuffer may not begin at the beginning of the memory
object, so use the optional "<code>+offset</code>" parameter to indicate
where the framebuffer information starts.  So as an example, the
<code>Xvfb</code> virtual framebuffer has options <code>-shmem</code>
and <code>-fbdir</code> for exporting its virtual screen to either shm or
a mapped file.  The format of these is XWD and so the initial header
should be skipped.  BTW, since XWD is not strictly RGB the view will only
be approximate, but usable.  Of course for the case of <code>Xvfb</code>
<b>x11vnc</b> can poll it much better via the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-xvfb">X API</a>,
but you get the idea.
</p><p>
By default in <code>-rawfb</code> mode <b>x11vnc</b> will actually
<em>close</em> any X display it happened to open.  This is basically to
shake out bugs (e.g it will crash rather than mysteriously interacting
with the X display.)  If you want <b>x11vnc</b> to keep the X
display open while polling the raw framebuffer prefix a "+" sign at
the beginning of the string (e.g. <code>+file:/dev/urandom@64x64x8</code>)
This could be convenient for keeping the remote control channel active (it
uses X properties.)  The "<code>-connect /path/to/file</code>" mechanism
could also be used for remote control to avoid the X property channel.
Rare usage, but if you also supply <code>-noviewonly</code> in this "+" mode
then the mouse and keyboard input are still sent to the X display, presumably
for doing something amusing with <code>/dev/fb</code>...
</p><p><em>Interesting Devices:</em>.  Here are some aliases for interesting
device files that can be polled via <code>-rawfb</code>:
</p><pre>   -rawfb console               /dev/fb0        Linux Console
   -rawfb vt2                   /dev/vcsa2      Linux Console (e.g. virtual terminal #2)
   -rawfb video                 /dev/video0     Video4Linux Capture device
   -rawfb rand                  /dev/urandom    Random Bytes
   -rawfb null                  /dev/zero       Zero Bytes (black screen)
</pre>
The Linux console, <code>/dev/fb0</code>, etc needs to have its
driver enabled in the kernel.  Some of the drivers are video card
specific and accelerated.  The console is either the Text consoles
(usually <code>tty1-tty6</code>), or X graphical display
(usually starting at <code>tty7</code>.)  In addition to the text console
other graphical ones may be viewed and interacted with as well,
e.g. DirectFB or SVGAlib apps, VMWare non-X fullscreen, or 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-qt-embedded">Qt-embedded</a>
apps (PDAs/Handhelds.)  By default the pipeinput mechanisms
<code>UINPUT</code> and <code>CONSOLE</code> (keystrokes only) are
automatically attempted in this mode under "<code>-rawfb console</code>".
<p></p><p>
The  Video4Linux Capture device, <code>/dev/video0</code>, etc is either
a Webcam or a TV capture device and needs to have its
driver enabled in the kernel.
See <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-video">this FAQ</a> for details.
If specified via "<code>-rawfb Video</code>" then the pipeinput method
"<code>VID</code>" is applied (it lets you change video parameters
dynamically via keystrokes.)
</p><p>
The last two, <code>/dev/urandom</code> and <code>/dev/zero</code>
are just for fun, but are also useful in testing.
</p><p>&nbsp;</p>
<p>
All of the above 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rawfb"><code>-rawfb</code></a> options
are just for viewing the raw framebuffer (although some of the
aliases do imply keystroke and mouse pipeinput methods.) 
That may be enough for certain applications of this feature
(e.g. suppose a <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-video">video camera</a> mapped its
framebuffer into memory and you just wanted to look at it via VNC.)
</p>
To handle the pointer and keyboard input from
the viewer users the "<code>-pipeinput cmd</code>" option was added
to indicate a helper program to process the user input.  The input is
streamed to it and looks something like this:
<pre>   Pointer 1 205 257 0 None
   Pointer 1 198 253 0 None
   Pointer 1 198 253 1 ButtonPress-1
   Pointer 1 198 253 0 ButtonRelease-1
   Pointer 1 198 252 0 None
   Keysym 1 1 119 w KeyPress
   Keysym 1 0 119 w KeyRelease
   Keysym 1 1 65288 BackSpace KeyPress
   Keysym 1 0 65288 BackSpace KeyRelease
   Keysym 1 1 112 p KeyPress
   Keysym 1 0 112 p KeyRelease
</pre>
Run "<code>-pipeinput tee:/bin/cat</code>" to get a description of
the format.  Note that the <code>-pipeinput</code> option is independent
of <code>-rawfb</code> mode and so may have some other interesting uses.
The "<code>tee:</code>" prefix means <b>x11vnc</b> will both process
the user input and pipe it to the command.  The default is to just pipe
it to the <code>-pipeinput</code> command.
<p></p><p>
Note the <code>-pipeinput</code> helper program could actually control
the raw framebuffer.  In the libvncserver CVS a simple example program
<code>x11vnc/misc/slide.pl</code> is provided that demonstrates
a simple jpeg "slideshow" application.
Also the builtin "<code>-pipeinput VID</code>" mode does this
for webcams and TV capture devices (<code>/dev/video0</code>.)
</p><p>
The <code>-pipeinput</code> program is run with these environment
variables set: <code>X11VNC_PID</code>, <code>X11VNC_PROG</code>,
<code>X11VNC_CMDLINE</code>, <code>X11VNC_RAWFB_STR</code>
to aid its knowing what is up.
</p><p>
Another example provided in libvncserver CVS is a script to
inject keystrokes into the Linux console (e.g. the virtual
consoles: <code>/dev/tty1</code>, <code>/dev/tty2</code>, etc)
in <code>x11vnc/misc/vcinject.pl</code>.  It is based on the
<code>vncterm/LinuxVNC.c</code> program also in the libvncserver CVS.
So to view and interact with VT #2 (assuming it is the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-linuxvc">active VT</a>)
one can run something like:
</p><pre>  x11vnc -rawfb map:/dev/fb0@1024x768x16 -pipeinput './vcinject.pl 2'
</pre>
This assumes your Linux framebuffer device (<code>/dev/fb0</code>)
is properly configured.   See <code>fbset(8)</code> and other
documentation. Try "<code>file:/dev/fb0@WxHxB</code>" as a last resort.
Starting with <b>x11vnc</b> 0.8.1, the above VT injection is built in,
as well as WxHxB determination.  Just use something like:
<pre>  x11vnc -rawfb console
</pre>
this will try to guess the active virtual console (via
<code>/dev/tty0</code>) and also the <code>/dev/fb0</code> WxHxB and rgb
masks automatically.  Use, e.g., "<code>-rawfb console3</code>" to force
the VT number.
This input method can be used generally via "<code>-pipeinput CONSOLE</code>".
Also starting with <b>x11vnc</b> 0.8.2 the "<code>-pipeinput UINPUT</code>"
mode is tried first (it does both keyboard and mouse input) and then
falls back to <code>CONSOLE</code> mode if it is not available.
Here is the -help output for this mode:
<blockquote>
                       If the rawfb string begins with "console" the framebuffer
                       device /dev/fb0 is opened (this requires the appropriate
                       kernel modules to be installed) and so is /dev/tty0.
                       The latter is used to inject keystrokes (not all are
                       supported, but the basic ones are.)  You will need to
                       be root to inject keystrokes.  /dev/tty0 refers to the
                       active VT, to indicate one explicitly, use "console2",
                       etc. using the VT number.
<p></p><p>

                       If the Linux version seems to be 2.6 or later and the
                       "uinput" module appears to be present, then the uinput
                       method will be used instead of /dev/ttyN.  uinput allows
                       insertion of BOTH keystrokes and mouse input and so it
                       preferred when accessing graphical (e.g. Qt-embedded)
                       linux console apps.  See -pipeinput UINPUT below
                       for more information on this mode (you may want to
                       also use the -nodragging and -cursor none options.)
                       Use "console0", etc  or -pipeinput CONSOLE to force the
                       /dev/ttyN method.
</p><p>

                       Note you can change VT remotely using the chvt(1)
                       command.  Sometimes switching out and back corrects
                       the framebuffer state.
</p><p>
                       To skip input injecting entirely use "consolex".
</p><p>

                       The string "/dev/fb0" (1, etc) can be used
                       instead of "console".  This can be used to specify
                       a different framebuffer device, e.g. /dev/fb1.  As a
                       shortcut the "/dev/" can be dropped.  If the name is
                       something nonstandard, use "console:/dev/foofb"
</p><p>

                       If you do not want x11vnc to guess the framebuffer's
                       WxHxB and masks automatically (sometimes the kernel
                       gives inaccurate information), specify them with a
                       @WxHxB at the end of the string.
</p></blockquote>
<p></p><p>
</p><p>
The above is just an example of what can be done.  Note that if you
really want to view and interact with the Linux Text console it is
better to use the more accurate and faster <code>LinuxVNC</code>
program.  The advantage <code>x11vnc -rawfb</code> might
have is that it can allow interaction with a non-text
application, e.g. one based on SVGAlib or 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-qt-embedded">Qt-embedded</a>
Also, for example the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-vmware">VMWare Fullscreen mode</a> is actually 
viewable under <code>-rawfb</code> and can be interacted with 
if <code>uinput</code> is enabled.
</p><p>
If the Linux <code>uinput</code> driver is available then full keystroke and
mouse input into the Linux console can be performed.  You may be able to enable 
<code>uinput</code> via commands like these:
</p><pre>  modprobe uinput
  mknod /dev/input/uinput c 10 223
</pre>
<p></p><p>
The <code>-rawfb</code> and <code>-pipeinput</code> features are
intended to help one creatively "get out of a jam" (say on a legacy
or embedded device) where X is absent or doesn't work properly.
Feedback and bug reports are welcome.
For more control and less overhead use <code>libvncserver</code>
in your own C program that passes the framebuffer to libvncserver.
</p><p>&nbsp;</p>

<a name="faq-linux-vt"></a>
<a name="FAQ-114"></a>
<p><b>Q-114:</b>
<font color="#007f00">
Can I export the Linux Console (Virtual Terminals) via VNC using <b>x11vnc</b>?
</font>
</p><p>
Yes, you may need to be root to access the devices that make up the
linux console.
</p><p>
To access the active Linux console via the computer's framebuffer try
something like:
</p><pre>  x11vnc -rawfb console
  x11vnc -rawfb console2
</pre>
These will try to access the framebuffer through <code>/dev/fb</code>
(or <code>/dev/fb0</code>, etc.)
and if it succeeds it will show any text or graphics that is currently
displayed.  Keystrokes will be injected via the device <code>/dev/tty0</code>
(to force an explicit virtual terminal append a number, e.g. "<code>console2</code>"
to select <code>/dev/tty2</code>.) 
<p></p><p>
If your Linux system does not have a framebuffer device (<code>/dev/fb</code>)
you can get one by adding, e.g., <code>vga=0x31B</code> boot parameter.
This enables the VGA framebuffer device at 1280x1024x24.  0x317
gives 1024x768x16, etc.  You can also enable a Linux framebuffer device
by modprobing a framebuffer driver specific to your video card.   
</p><p>
Note that this "<code>-rawfb console</code>" mode shows the contents
of the hardware framebuffer, and so will show whatever is on the screen.
It has no concept of Virtual Terminals WRT what there is to view,
it always shows the active virtual terminal.
</p><p>
Another mode is specific to the Linux text Virtual Terminals, it shows
their text and colors (but no graphics) regardless of whether it is the
active VT or not.  It is available on <b>x11vnc</b> 0.9.7 and later.
Enable this mode like this:
</p><pre>  x11vnc -rawfb vt
  x11vnc -rawfb vt2
</pre>
The former will select the active one, the latter the 2nd VT.
<b>x11vnc</b> implements this mode by opening the current console text
file "<code>/dev/vcsa2</code>" instead of "<code>/dev/fb</code>". 
In this way it provides the basic functionality of the
LibVNCServer <code>LinuxVNC</code> program.
<p></p><p>
The <code>vt</code> mode can be a useful way to try to get a machine's
X server working remotely, e.g. you edit <code>/etc/X11/xorg.conf</code>
and then type <code>startx</code> (or similar, e.g. gdm) in the virtual
terminal.  A 2nd x11vnc could be used to see if the X server is now working
correctly.
</p>

<a name="faq-video"></a>
<a name="FAQ-115"></a>
<p><b>Q-115:</b>
<font color="#007f00">
Can I export via VNC a Webcam or TV tuner framebuffer using <b>x11vnc</b>?
</font>
</p><p>
Yes, this is possible to some degree with the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rawfb"><code>-rawfb</code></a> option.
There is no X11 involved: snapshots from the video capture device are
used for the screen image data.
See the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-rawfb">previous FAQ on -rawfb</a> for background.
For best results, use <b>x11vnc</b> version 0.8.1 or later.
</p><p>
Roughly, one would do something like this:
</p><pre>  x11vnc -rawfb snap:/dev/video@320x240x32
</pre>
This requires that the system allows simple <code>read(2)</code> access
to the video device.  This is true for video4Linux on Linux kernel 2.6
and later (it won't work for 2.4, you'll need a separate program to
snapshot to a file that you point <code>-rawfb</code> to; ask me if it
is not clear what to do.)
<p></p><p>
The "snap:" enforces 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-snapfb"><code>-snapfb</code></a> mode
which appears to be necessary.  The read pointer for video capture devices
cannot be repositioned (which would be needed for scanline polling),
but you can read a full frame of data from the device.
</p><p>
On Linux, if the Video4Linux API is present or the <code>v4l-info(1)</code>
program (related to <code>xawtv</code>) exists in in <code>PATH</code>,
then <b>x11vnc</b> can be instructed to try it to determine the
<code>-rawfb</code> WxHxB parameters for you automatically.  In this
case one would just type:
</p><pre>  x11vnc -rawfb video
</pre>
or "<code>-rawfb video1</code>" for the 2nd video device, etc.
<p></p><p>
<b>x11vnc</b> has also been extended to use the Video4Linux
API over <code>v4l-info</code> if it is available at build time.
This enables setting parameters (e.g. size and brightness) via
<b>x11vnc</b>.  See the description below.  Without Video4Linux you will
need to initialize the settings of the video device using something like
<code>xawtv</code> or <code>spcaview</code> (and then hope the settings
persist until <b>x11vnc</b> reopens the device.)
</p><p>
Many video4linux drivers tend to set the framebuffer to be
24bpp (as opposed to 32bpp.)  Since this can cause problems with
VNC viewers, etc, the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-24to32"><code>-24to32</code></a> option
will be automatically imposed when in 24bpp.
</p><p>
Note that by its very nature, video capture involves rapid change in the
framebuffer.  This is especially true for cameras where slight wavering in
brightness is always happening.  This can lead to much network bandwidth
consumption for the VNC traffic and also local CPU and I/O resource usage.
You may want to experiment with "dialing down" the framerate
via the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-wait"><code>-wait</code></a>,
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-slow_fb"><code>-slow_fb</code></a>, or
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-defer"><code>-defer</code></a>
options.  Decreasing the window size and bpp also helps. 
</p><p>
&nbsp;&nbsp;
</p><p><em>Setting Camera/Tuner parameters via <b>x11vnc</b></em>:
</p><p>
There is also some support for setting parameters of the capture device.
This is done via "<code>-rawfb video:&lt;settings&gt;</code>".  
This could be useful for unattended startup at boottime, etc.
Here is the -help description:
</p><blockquote>
       A more sophisticated video device scheme allows initializing the
       device's settings using:

<p></p><p>
</p><pre>           -rawfb video:&lt;settings&gt;
</pre>

<p></p><p>

                       The prefix could also be, as above, e.g. "video1:" to
                       specify the device file.  The v4l API must be available
                       for this to work.  Otherwise, you will need to try
                       to initialize the device with an external program,
                       e.g. xawtv, spcaview, and hope they persist when x11vnc
                       re-opens the device.
</p><p>
                       &lt;settings&gt; is a comma separated list of key=value pairs.
                       The device's brightness, color, contrast, and hue can
                       be set to percentages, e.g. br=80,co=50,cn=44,hu=60.
</p><p>
                       The device filename can be set too if needed (if it
                       does not start with "video"), e.g. fn=/dev/qcam.
</p><p>
                       The width, height and bpp of the framebuffer can be
                       set via, e.g., w=160,h=120,bpp=16.
</p><p>

                       Related to the bpp above, the pixel format can be set
                       via the fmt=XXX, where XXX can be one of: GREY, HI240,
                       RGB555, RGB565, RGB24, and RGB32 (with bpp 8, 8, 16, 16,
                       24, and 32 respectively.)  See http://www.linuxtv.org
                       for more info (V4L api.)
</p><p>
                       For TV/rf tuner cards one can set the tuning mode
                       via tun=XXX where XXX can be one of PAL, NTSC, SECAM,
                       or AUTO.
</p><p>
                       One can switch the input channel by the inp=XXX
                       setting, where XXX is the name of the input channel
                       (Television, Composite1, S-Video, etc.)  Use the name
                       that is in the information about the device that
                       is printed at startup.
</p><p>
                       For input channels with tuners (e.g. Television) one
                       can change which station is selected by the sta=XXX
                       setting.  XXX is the station number.  Currently only
                       the ntsc-cable-us (US cable) channels are built into
                       x11vnc. See the -freqtab option below to supply one
                       from xawtv. If XXX is greater than 500, then it is
                       interpreted as a raw frequency in KHz.
</p><p>

     Example:
</p><p>

     -rawfb video:br=80,w=320,h=240,fmt=RGB32,tun=NTSC,sta=47
</p><p>
                       one might need to add inp=Television too for the input
                       channel to be TV if the card doesn't come up by default
                       in that one.
</p><p>
                       Note that not all video capture devices will support
                       all of the above settings.
</p><p>
                       See the -pipeinput VID option below for a way to control
                       the settings through the VNC Viewer via keystrokes.
</p><p>
                       As above, if you specify a "@WxHxB..." after the
                       &lt;settings&gt; string they are used verbatim: the device
                       is not queried for the current values.  Otherwise the
                       device will be queried.
</p><p>
</p></blockquote>
Also, if you supply the "<code>-pipeinput VID</code>" 
(or use "<code>-rawfb Video</code>") option you can
control the settings to some degree via keystroke mappings, e.g.
B to increase the brightness or Up arrow to change the TV station:
<blockquote>
      For "-pipeinput VID" and you are using the -rawfb for a video
      capture device, then an internal list of keyboard mappings is used
      to set parameters of the video.  The mappings are:
<p></p><p>

&nbsp;&nbsp;&nbsp;       "B" and "b" adjust the brightness up and down.<br>
&nbsp;&nbsp;&nbsp;       "H" and "h" adjust the hue.<br>
&nbsp;&nbsp;&nbsp;       "C" and "c" adjust the colour.<br>
&nbsp;&nbsp;&nbsp;       "N" and "n" adjust the contrast.<br>
&nbsp;&nbsp;&nbsp;       "S" and "s" adjust the size of the capture screen.<br>
&nbsp;&nbsp;&nbsp;       "I" and "i" cycle through input channels.<br>
&nbsp;&nbsp;&nbsp;       Up and Down arrows adjust the station (if a tuner)<br>
&nbsp;&nbsp;&nbsp;       F1, F2, ..., F6 will switch the video capture pixel<br>
&nbsp;&nbsp;&nbsp;       format to HI240, RGB565, RGB24, RGB32, RGB555, and<br>
&nbsp;&nbsp;&nbsp;       GREY respectively.  See -rawfb video for details.<br>

</p><p>
</p></blockquote>
See also the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-freqtab"><code>-freqtab</code></a>
option to supply your own xawtv channel to frequency mappings for
your country (only ntsc-cable-us is built into x11vnc.)
<p></p><p>&nbsp;</p>

<a name="faq-qt-embedded"></a>
<a name="FAQ-116"></a>
<p><b>Q-116:</b>
<font color="#007f00">
Can I connect via VNC to a Qt-embedded/Qt-enhanced/Qtopia application running on my
handheld, cell phone, or PC using the Linux console framebuffer (i.e. not X11)?
</font>
</p><p>
Yes, the basic method for this is the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-rawfb">-rawfb</a> scheme where the Linux console
framebuffer (usually <code>/dev/fb0</code>) is polled and the
<code>uinput</code> driver is used to inject keystrokes and mouse input.
Often you will just have to type:
</p><pre>  x11vnc -rawfb console
</pre>
(you may need to enable the <code>uinput</code> driver on the system via 
"<code>modprobe uinput; mknod /dev/input/uinput c 10 223</code>")
If this does not find the correct frame buffer properties figure them
out or guess them and use something like:
<pre>  x11vnc -rawfb /dev/fb0@640x480x16
</pre>
Also, to force usage of the <code>uinput</code> injection method use 
"<code>-pipeinput UINPUT</code>".
See the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-pipeinput"><code>-pipeinput</code></a>
description for tunable parameters, etc.
<p></p><p>
One problem with the <b>x11vnc</b> <code>uinput</code> scheme is that
it cannot guess the mouse motion "acceleration" used by the windowing
application (e.g. QWS or X11.)  For X11 and Qt-embedded the acceleration
is usually 2 (i.e. a dx of 1 from the mouse yields a 2 pixel displacement
of the mouse cursor.)  The default <b>x11vnc</b> uses is 2, since that
is often used.  However for one Qt-embedded system we needed to do:
</p><pre>  x11vnc -rawfb console  -pipeinput UINPUT:accel=4.0
</pre>
to get reasonable positioning of the mouse.
<p></p><p>
Even with the correct acceleration
setting there is still some drift (probably because of the mouse
threshold where the acceleration kicks in) and so  <b>x11vnc</b>
needs to reposition the cursor from 0,0 about 5 times a second.
See the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-pipeinput"><code>-pipeinput UINPUT</code></a>
option for tuning parameters that can be set (there are some
experimental thresh=N tuning parameters as well)
</p><p>
Currently, one can expect mouse input to be a little flakey. 
All in all, the Linux framebuffer input mechanism for Qt-embedded
framebuffer apps is not perfect, but it is usable.
</p><p>
If you need to create a smaller <b>x11vnc</b> binary for a handheld
environment be sure to run <code>strip(1)</code> on it and also consider
configuring with, e.g.  "<code>env CPPFLAGS='-DSMALL_FOOTPRINT=1' ./configure ...</code>"
to remove rarely used features and large texts (use 2 or 3 instead of
1 to remove more.)  Currently (Jul/2006) this can lower the size of the
<b>x11vnc</b> from 1.1MB to 0.6-0.7MB.
</p><p>
The <b>x11vnc</b> <code>uinput</code> method applies to nearly anything on
the Linux framebuffer console, not just Qt-embedded/Qtopia.  DirectFB, SDL
using <code>fbcon</code> driver, SVGAlib applications can also be viewed
and interacted with.  Even a Linux X session can be viewed and interacted
with without using X11 (and <b>x11vnc</b> does not have to terminate
when the X server restarts!)  The Linux Text consoles (F1-F6) also work.
</p><p>
Note that Qt-embedded supplies its own VNC graphics driver, 
but it cannot do <em>both</em> the Linux console framebuffer and
VNC at the same time, which is often what is desired from VNC.
</p><p>
<em><b>Update</b>:</em> We are finding some setups like Qtopia on the IPAQ
do not allow mouse input via <code>uinput</code>.  Please help us
debug this problem by trying <b>x11vnc</b> on your device and letting
us know what does and does not work.  See the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-qtmoko">next FAQ</a>
for a possible workaround for touchscreens.
</p><p>&nbsp;</p>

<a name="faq-qtmoko"></a>
<a name="FAQ-117"></a>
<p><b>Q-117:</b>
<font color="#007f00">
How do I inject touch screen input into an Qt-embedded/Qt-enhanced/Qtopia cell phone
such as openmoko/qtmoko Neo Freerunner?
</font>
</p><p>
The qtmoko project does not use X11 for the graphical display.  Unfortunately
the Linux uinput method described in the previous FAQ does not work because
Qt is using TSLIB (touch screen library) to process the input and it only
reads from one device (often <code>/dev/input/event1</code>) and <b>not</b> from
the new UINPUT device that <b>x11vnc</b> creates (under <code>-pipeinput UINPUT</code>) 
</p><p>
So something else needs to be done.  It was discovered that by simply writing
the touchscreen events <em>directly</em> to <code>/dev/input/event1</code>
then input can be injected into the system.  There is no <b>x11vnc</b> builtin mode for this
yet (until we understand it better), but there is a working script provided in
<code>x11vnc/misc/qt_tslib_inject.pl</code>. So one could use it this way
for example:
</p><pre>  x11vnc ... -rawfb console -pipeinput path/to/qt_tslib_inject.pl -env INJECT_OPTIONS=clickonly,cal=/etc/pointercal
</pre>
Read the script for how to enable other options and what the above options
mean (e.g. <code>/etc/pointercal</code> contains TSLIB's calibration
parameters and are necessary to achieve accurate pointing.)
<p></p><p>
The <code>x11vnc/misc/qt_tslib_inject.pl</code> script can potentially be
modified to handle other devices where the uinput method fails.
It could also be modified to create 'hot keys', etc.
</p><p>
Please let us know how things go if you try this out; there is much
to learn about synthetic input injection in handhelds and cell phones.
As we learn more we can develop a builtin <b>x11vnc</b> mode for
this sort of injection.
</p><p>
<em><b>Update Dec/2010</b>:</em> There is experimental built-in UINPUT support
in the x11vnc development tarball for qtmoko with touchpad managed by tslib.  See
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-pipeinput"><code>-pipeinput UINPUT</code></a>
for more info.  Here is an example:
</p><pre>   x11vnc -rawfb console -pipeinput UINPUT:touch,tslib_cal=/etc/pointercal,direct_abs=/dev/input/event1,nouinput,dragskip=3
</pre>
<p></p><p>&nbsp;</p>

<a name="faq-no-x11"></a>
<a name="FAQ-118"></a>
<p><b>Q-118:</b>
<font color="#007f00">
Now that non-X11 devices can be exported via VNC using <b>x11vnc</b>,
can I build it with no dependencies on X11 header files and libraries?
</font>
</p><p>
Yes, as of Jul/2006 <b>x11vnc</b> enables building for 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rawfb"><code>-rawfb</code></a> only support.
Just do something like when building:
</p><pre>  ./configure --without-x    (plus any other flags)
  make
</pre>
You can then test via "<code>ldd x11vnc</code>" that the binary
does not depend on <code>libX11.so</code>, etc.  See the
previous FAQ's for non-X11 framebuffer usage.  If you use this
for an interesting non-X11 application please let us know what you did.
<p></p><p>&nbsp;</p>

<a name="faq-cross-compile"></a>
<a name="FAQ-119"></a>
<p><b>Q-119:</b>
<font color="#007f00">
How do I cross compile <b>x11vnc</b> for a different architecture than
my Linux i386 or amd64 PC?
</font>
</p><p>
You will need a cross-compiling toolchain.  Perhaps your distro provides
these or you can find a HOWTO for your distro.  We found a nice one at
qtmoko.org for building armel binaries on Debian Linux i386 machines.
It includes most of the libraries that <b>x11vnc</b> needs.  We use that
example here.
</p><p>
We ran this script to set PATH, configure, and build:
</p><pre>#!/bin/sh

# toolchain from: qtmoko-debian-toolchain-armv4t-eabi.tar.gz

export PATH=/opt/toolchains/arm920t-eabi/bin:$PATH

env CC=arm-linux-gcc ./configure --host=arm-linux --without-avahi

make

arm-linux-strip ./x11vnc/x11vnc
ls -l ./x11vnc/x11vnc
</pre>
Note we had to include <code>--without-avahi</code> due to lack
of <code>libavahi-client.so.3</code> supplied by the toolchain
we used.  One would need to add it if it was desired on the
target machine.  We also stripped the binary to make it smaller.
<p></p><p>
For an embedded system one may also want to add <code>--without-x</code>
if the embedded system does not use X11 and the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rawfb"><code>-rawfb</code></a> mechanism
must be used.
</p><p>&nbsp;</p>

<a name="faq-macosx"></a>
<a name="FAQ-120"></a>
<p><b>Q-120:</b>
<font color="#007f00">
Does <b>x11vnc</b> support Mac OS X Aqua/Quartz displays natively
(i.e. no X11 involved)?
</font>
</p>
<p>
Yes, since Nov/2006 in the development tree (x11vnc-0.8.4 tarball) there
is support for native Mac OS X Aqua/Quartz displays using the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rawfb"><code>-rawfb</code></a> mechanism
described above.  The mouse and keyboard input is achieved via
Mac OS X API's.
</p><p>
So you can use <b>x11vnc</b> as an alternative to 
<a href="http://web.archive.org/web/20210304200604/http://www.testplant.com/products/vine_server/OS_X">OSXvnc</a> (aka Vine Server), or
<a href="http://web.archive.org/web/20210304200604/http://www.apple.com/remotedesktop/">Apple Remote Desktop (ARD)</a>.  Perhaps there
is some <b>x11vnc</b> feature you'd like to use on Mac OS X, etc.  For a number of
activities (e.g. window drags) it seems to be faster than OSXvnc.
</p><p>
<b>Notes:</b>
</p><p>
<em>X11:</em>&nbsp;&nbsp;<b>x11vnc</b> will also work (as it has for
years) with a X11 server (XDarwin) running on Mac OS X (people often install
this software to display remote X11 apps on their Mac OS X system,
or use some old
favorites locally such as <code>xterm</code>.)  However in this case <b>x11vnc</b>
will only work reasonably in single window
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-id"><code>-id windowid</code></a> mode
(and the window may need to have mouse focus.)
</p><p>
If you do not have the <code>DISPLAY</code> env. variable set, <b>x11vnc</b>
will assume native Aqua/Quartz on Mac OS X, however if <code>DISPLAY</code>
is set it will assume an X11 connection.  Use "<code>-rawfb console</code>"
to force the native display (or unset <code>DISPLAY</code>.)
</p><p>
<em>Update:</em> Leopard sets <code>DISPLAY</code> by default in all
sessions.  Since it starts with the string "<code>/tmp/</code>" <b>x11vnc</b>
will use that to know if it should ignore it.  Use "<code>-display :0.0</code>"
to force it.
</p><p>
<em>Building:</em>&nbsp;&nbsp;If you don't have the X11 build and runtime
packages installed you will need to build it like this:
</p><pre>   (cd to the e.g. x11vnc-0.9, source directory)
   ./configure --without-x
   make
</pre>
<p></p><p>
<em>Win2VNC/x2vnc:</em>&nbsp;&nbsp;One handy use is to use the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nofb"><code>-nofb</code></a> mode
to redirect mouse and keyboard input to a nearby Mac
(i.e. one to the side of your desk)
via <a href="http://web.archive.org/web/20210304200604/http://fredrik.hubbe.net/x2vnc.html">x2vnc</a>
or Win2VNC.  See <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-win2vnc">this FAQ</a> for more info.
</p><p>
<em>Options:</em>&nbsp;&nbsp;Here are the Mac OS X specific <b>x11vnc</b> options:
</p><pre>   -macnodim              For the native Mac OS X server, disable dimming. 
   -macnosleep            For the native Mac OS X server, disable display sleep.
   -macnosaver            For the native Mac OS X server, disable screensaver.
   -macnowait             For the native Mac OS X server, do not wait for the
                          user to switch back to his display.
   -macwheel n            For the native Mac OS X server, set the mouse wheel
                          speed to n (default 5.)
   -macnoswap             For the native Mac OS X server, do not swap mouse
                          buttons 2 and 3.
   -macnoresize           For the native Mac OS X server, do not resize or reset
                          the framebuffer even if it is detected that the screen
                          resolution or depth has changed.
   -maciconanim n         For the native Mac OS X server, set n to the number
                          of milliseconds that the window iconify/deiconify
                          animation takes.  In -ncache mode this value will be
                          used to skip the animation if possible. (default 400)
   -macmenu               For the native Mac OS X server, in -ncache client-side
                          caching mode, try to cache pull down menus (not perfect
                          because they have animated fades, etc.)
</pre>
<p></p><p>
<em>PasteBoard/Clipboard:</em>&nbsp;&nbsp;
There is a bug that the Clipboard (called PasteBoard on Mac it appears)
exchange will not take place unless <b>x11vnc</b> was started from
<b>inside</b> the Aqua display (e.g. started inside a Terminal
app window.)  Otherwise it cannot connect to the PasteBoard server.
So Clipboard exchange won't work for our standard "ssh in"
startup scheme.
</p><p>
Hopefully this deficiency can be removed, but until then for
Clipboard exchange to work you will need to start <b>x11vnc</b>
inside the desktop session (i.e. either start it running before
you leave, or start up a <em>2nd</em> <b>x11vnc</b> inside
from a <em>1st</em> one started outside, or use the apple script
below)
</p><p>
Here also is a <code>osascript</code> trick that seems to work
(it opens the Terminal app and instructs it to start <b>x11vnc</b>):
</p><pre> 
#!/bin/sh
#
# start_x11vnc: start x11vnc in a Terminal window
# (this will allow Clipboard/Pasteboard exchange to work)

tmp=/tmp/start_x11vnc.$$

cat &gt; $tmp &lt;&lt;END

tell application "Terminal"
        activate
        do script with command "$HOME/x11vnc -rfbauth .vnc/passwd -ssl SAVE"
end tell

END

osascript $tmp
rm -f $tmp

</pre> 
where you should customize the <b>x11vnc</b> command line to your needs
and the full path to the binary.
Save it in a file e.g. "<code>start_x11vnc</code>"
and then after you SSH in just type "<code>./start_x11vnc</code>"
(or have ssh run the command for you.)
Then once you are connected via VNC, iconify the Terminal windows
(you can't delete them since that will kill <b>x11vnc</b>.)
<p></p><p>
<em><b>Update Aug/2010:</b></em> A user reports the following useful
information:
</p><pre>This is not a problem on Mac OS X 10.6.x (Snow Leopard) when connecting
via ssh to start x11vnc.  And, on Mac OS X 10.5.x (Leopard), the problem
can be permanently eliminated by doing this:


sudo /usr/libexec/PlistBuddy -c 'delete :LimitLoadToSessionType' \
   -c 'add :LimitLoadToSessionType string Background' \
   /System/Library/LaunchAgents/com.apple.pboard.plist
# ignore any 'Delete: Entry, ":LimitLoadToSessionType", Does Not Exist' message

and then restarting (yes, you must restart not just log off).  But  
ONLY do that for Mac OS X 10.5.x and NOT for 10.6.x (which doesn't  
need it anyway).
</pre>
We recently got access to a MacOSX 10.6.4 (Snow Leopard) macbook and
have confirmed that the above is correct.
<p></p><p>&nbsp;</p>

<a name="faq-reflect"></a>
<a name="FAQ-121"></a>
<p><b>Q-121:</b>
<font color="#007f00">
Can <b>x11vnc</b> be used as a VNC reflector/repeater to improve
performance for the case of a large number of simultaneous VNC viewers
(e.g. classroom broadcasting or a large demo)?
</font>
</p>
<p>
Yes, as of Feb/2007 there is the 
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-reflect"><code>-reflect host:N</code></a>"
option to connect to the VNC server "<code>host:N</code>" (either
another <b>x11vnc</b> or any other VNC server) and re-export it.  VNC viewers then
connect to the <b>x11vnc</b>(s) running <code>-reflect</code>.  
</p><p>
The <code>-reflect</code> option is the same as:
"<code>-rawfb vnc:host:N</code>".
See the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-rawfb"><code>-rawfb</code></a>
description under "VNC HOST" for more details. 
</p><p>
You can replace "<code>host:N</code>" with "<code>listen</code>"
or "<code>listen:port</code>" for reverse connections.
</p><p>
One can set up a number of such reflectors/repeaters to spread the resource
usage around, e.g.:
</p><pre>       C -------&lt;-------|                           
       C -------&lt;-------|                           
       C -------&lt;-------|---- R -----|                          
       C -------&lt;-------|            |              
       C -------&lt;-------|            |              
                                     |
       C -------&lt;-------|            |              
       C -------&lt;-------|            |              
       C -------&lt;-------|---- R -----|                          
       C -------&lt;-------|            |              
       C -------&lt;-------|            |              
                                     |====== S 
       C -------&lt;-------|            |
       C -------&lt;-------|            |              
       C -------&lt;-------|---- R -----|                          
       C -------&lt;-------|            |              
       C -------&lt;-------|            |              
                                     |
       C -------&lt;-------|            |              
       C -------&lt;-------|            |              
       C -------&lt;-------|---- R -----|                          
       C -------&lt;-------|                           
       C -------&lt;-------|
</pre>
Where "S" is the original VNC Server, "C" denote VNC viewer clients, and
"R" denotes an <b>x11vnc</b> running <code>-reflect</code> to "S".
<p></p><p>
Ideally, a client "C" will be fairly close network-wise to its "R".
It is fine to run the "R" on the same machine as one of its "C's".
A nice setup for a large, (e.g. 64-128) viewer classroom broadcast
case would be to run R's on areas isolated by network switches, e.g.
one R per switch.
</p><p>
In an extreme case (e.g. 1000 viewers) one might actually need
a 2nd layer of R's in the tree.  If you try something like that let us know! 
</p><p>
There are many resource savings in doing something like the above.
The first obvious one is network bandwidth savings.  Another is less
CPU load on "S" since it handles many fewer simultaneous connections.
Also, if there are a few clients C on very slow links, their presence
does not slow down every other client, just the clients on their "R".
One way a slow client affects things is if there are some large framebuffer
writes (e.g. jpeg image region) then the repeater may block waiting
for that large write to finish before going onto the next client
(however, if the write is small enough, the kernel will buffer it and the 
server can go on to service the next client.)
</p><p>
The <b>x11vnc</b> <code>-reflect</code> implementation uses the <code>libvncclient</code>
library in the LibVNCServer project to handle the connection to "S".
It is not currently very efficient since it simply does its normal
framebuffer polling scheme on the <code>libvncclient</code>
framebuffer (which it then re-exports via VNC to its clients C.)
However, CopyRect and CursorShape encodings are preserved in the reflection and
that helps.  Dragging windows with the mouse can be a problem
(especially if S is not doing wireframing somehow, consider
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nodragging"><code>-nodragging</code></a>
if the problem is severe)
For a really fast reflector/repeater it would have to be implemented from
scratch with performance in mind.  See these other projects:
</p><pre>    <a href="http://web.archive.org/web/20210304200604/http://sourceforge.net/projects/vnc-reflector/">http://sourceforge.net/projects/vnc-reflector/</a>,
    <a href="http://web.archive.org/web/20210304200604/http://www.tightvnc.com/projector/">http://www.tightvnc.com/projector/</a>                (closed source?),
</pre>
<p></p><p>
&nbsp;<br>
<em>Automation via Reverse Connections:</em>&nbsp;&nbsp;
Instead of having the R's connect directly to S and then the C's connect directly to
the R they should use, some convenience can be achieved by using 
reverse connections (the <b>x11vnc</b>
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-connect">"<code>-connect host1,host2,...</code>"</a> option.)
Suppose all the clients "C" are started up in Listen mode:
</p><pre>    client1&gt;  vncviewer -listen
    client2&gt;  vncviewer -listen
    client3&gt;  vncviewer -listen
    ...
    client64&gt; vncviewer -listen
</pre>
(e.g. <code>client1&gt;</code> is the cmdline prompt on machine <code>client1</code> ... etc)
and all the repeaters R are started like this:
<pre>    repeater1&gt; x11vnc -reflect listen -connect client1,client2,...client8
    repeater2&gt; x11vnc -reflect listen -connect client9,client10,...client16
    ...
    repeater8&gt; x11vnc -reflect listen -connect client57,client58,...client64
</pre>
and finally the main server is started to kick the whole thing into motion:
<pre>    vncserver&gt; x11vnc -display :0 -connect repeater1,repeater2,...repeater8
</pre>
(or instruct a non-x11vnc VNC server to reverse connect to the repeaters.)
For a classroom broadcasting setup one might have the first two sets of
commands start automatically at bootup or when someone logs in, and then
start everything up with the S server.  One may even be able to script the
forward connection bootstrap case, let us know what you did.  A really nice
thing would be some sort of auto-discovery of your repeater, etc...
<p></p>

<a name="faq-os-install"></a>
<a name="FAQ-122"></a>
<p><b>Q-122:</b>
<font color="#007f00">
Can <b>x11vnc</b> be used during a Linux, Solaris, etc. system Installation
so the Installation can be done remotely?
</font>
</p>
<p>
This can be done, but it doesn't always work because it depends on how the
OS does its install.  We have to "sneak in" somehow.
Note that some OS's have a remote install (ssh etc.) built in and so
you might want to use that instead.
</p><p>
Usually the OS install will have to be a network-install in order to have
networking up during the install.  Otherwise, you may have a (slim) chance to 
configure the networking manually (<code>ifconfig(8)</code> and <code>route(8)</code>.)
</p><p>
To avoid library dependencies problems in the typical minimal (e.g. busybox) 
installation OS it is a good idea to build a statically linked <b>x11vnc</b>
binary.  A way that often works is to do a normal build and then paste
the final <b>x11vnc</b> link line into a shell script.  Then change the 
"<code>gcc</code>" to "<code>gcc -static</code>" and run the shell script.
You may need to disable features (e.g. "<code>--without-xfixes</code>")
if there is not a static library for the feature available.
You may also need to add extra link options (e.g. "<code>-lXrender</code>")
to complete library dependencies manually.
</p><p>
Let's call the binary <code>x11vnc.static</code>. Place it on a webserver
somewhere.  It may be possible to retrieve it via <code>scp(1)</code> too.
</p><p>
During the install you need to get a shell to retreive
<code>x11vnc.static</code> and run it.
</p><p>
If the Solaris install is an older X-based one, there will be a menu
for you to get a terminal window.  From that window you might be able
to retrieve <code>x11vnc.static</code> via
<code>wget</code>, <code>scp</code>, or <code>ftp</code>.  Remember to
do "<code>chmod 755 ./x11vnc.static</code>" and then find the <code>-auth</code>
file as in <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-display-manager">this FAQ</a>.
</p><p>
If it is a Linux install that uses an X server (e.g. SuSE and probably Fedora),
then you can often get a shell by pressing <code>Ctrl-Alt-F2</code> or similar.
Then get the x11vnc binary via something like this:
</p><pre>   cd /tmp
   wget http://192.168.0.22/x11vnc.static
   chmod 755 ./x11vnc.static
</pre>
Find the name of the auth file as in <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-display-manager">this FAQ</a>.
(maybe run "<code>ps wwaux | grep auth</code>".)  Then run it like this:
<pre>   ./x11vnc.static -forever -nopw -display :0 -auth /tmp/wherever/the/authfile
</pre>
then press <code>Alt-F7</code> to go back to the X install.  You should
now be able to connect via a vnc viewer and continue the install.  Watch out for
the display being :1, etc.
<p></p><p>
If there is a firewall blocking incoming connections during the install,
use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-connect">"<code>-connect hostname</code>"</a> option option for 
a reverse connection to the hostname running the VNC viewer in listen mode.
</p><p>
Debian based installs are either console-text or console-framebuffer based.
These are <code>install</code> (or <code>expert</code>) and <code>installgui</code>
(or <code>expertgui</code>) boot lines, respectively.  For the console-text
based installs you probably need to add a boot cmd line option like
<code>vga=0x314</code> (which is 800x600x16) to get the console-text to use the
linux framebuffer device properly.
</p><p>
For a Debian console-text based install after the network is configured
press <code>Ctrl-Alt-F2</code> to get a shell.  Retrieve the binary via
<code>wget</code> as above and <code>chmod 755</code> it. Then run it
something like this:
</p><pre>   sleep 10; ./x11vnc.static -forever -nopw -rawfb console
</pre>
then before the sleep is over press <code>Alt-F1</code> to get back to the
install virtual console.  You should be able to connect via a VNC viewer
and continue with the install.
<p></p><p>
For a recent (2009) Debian install we booted with
"<code>expert vga=0x301</code>" and "<code>expert vga=0x311</code>"
to get console text based installs at 640x480x8 and 640x480x16, respectively
(replace "expert" with "install" if you like.)  Otherwise it was giving
a 16 color 640x480x4 (4 bit per pixel) display which x11vnc could not handle. 
</p><p>
For Debian console-framebuffer GUI based installs (<code>installgui</code>
or <code>expertgui</code>) we have not be able to enter keystrokes or
mouse motions.  This may be resolved if the install had the Linux
kernel module <code>uinput</code>, but it doesn't; one can wget <code>uinput.ko</code> and
then run <code>insmod</code> on it, but the module must match the installation kernel.
So, failing that, you can only do the GUI view-only, which can be handy
to watch a long network install from your desk instead of in front of the
machine being installed.  For these, after the network is configured press
<code>Ctrl-Alt-F2</code> to get a shell.
  Retrieve the binary via <code>wget</code> as 
above and <code>chmod 755</code> it. Then run it something like this:
</p><pre>   sleep 10; ./x11vnc.static -forever -nopw -rawfb console
</pre>
then before the sleep is over press <code>Alt-F5</code> to get back to the
GUI install console.  You should be able to connect via a VNC viewer
and watch the install.
<p></p>

&nbsp;<br><font size="-0"><b>[Misc: Clipboard, File Transfer/Sharing, Printing, Sound, Beeps, Thanks, etc.]</b></font><br>
<a name="faq-clipboard"></a>
<a name="FAQ-123"></a>
<p><b>Q-123:</b>
<font color="#007f00">
Does the Clipboard/Selection get transferred between the vncviewer
and the X display? 
</font>
</p>
<p>
As of Jan/2004 <b>x11vnc</b> supports
the "CutText" part of the RFB (aka VNC) protocol.  When text is
selected/copied in the X session that x11vnc is polling it will be
sent to connected VNC viewers.  And when CutText is received from a
VNC viewer then x11vnc will set the X11 selections PRIMARY, CLIPBOARD,
and CUTBUFFER0 to it.
<b>x11vnc</b> is able to hold the PRIMARY and CLIPBOARD selections
(<b>Xvnc</b> does not seem to do this.)
</p><p>
The X11 selections can be confusing, especially to those coming from Windows
or MacOSX where there is just a single 'Clipboard'.  The X11 CLIPBOARD
selection is a lot like that of Windows and MacOSX, e.g. highlighted
text is sent to the clipboard when the user activates "Edit -&gt;
Copy" or presses "Control+C" (and pasting it via "Edit -&gt; Paste"
or "Control+V".)  The X11 PRIMARY selection has been described as 'for
power users' or 'an Easter Egg'.  As soon as text is highlighted it is
set to the PRIMARY selection and so it is immediately ready for pasting,
usually via the Middle Mouse Button or "Shift+Insert".
See <a href="http://web.archive.org/web/20210304200604/http://www.jwz.org/doc/x-cut-and-paste.html">this jwz link</a>
for more information.
</p><p>
<b>x11vnc</b>'s default behavior is to watch both CLIPBOARD and PRIMARY
and whenever one of them changes, it sends the new text to connected viewers.
Note that since the RFB protocol only has a single "CutText" then both
selections are "merged" to some degree (and this can lead to confusing results.)
One user was confused why x11vnc was "forgetting" his CLIPBOARD selection
and the reason was he also changed PRIMARY <em>some time after</em> he
copied text to the clipboard.  Usually an app will set PRIMARY as soon
as any text is highlighted so it easy to see how CLIPBOARD was forgotten.  Use
the <code>-noprimary</code> described below as a workaround.  Similarly,
by default when x11vnc receives CutText it sets <em>both</em> CLIPBOARD
and PRIMARY to it (this is probably less confusing, but could possibly
lead to some failure modes as well.)
</p><p>
You may not like these defaults.  Here are ways to change the behavior:
</p><ul>
<li>
If you don't want the Clipboard/Selection exchanged at all use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nosel"><code>-nosel</code></a> option.
</li>
<li>
If you want changes in PRIMARY to be ignored use the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noprimary"><code>-noprimary</code></a> option.
</li>
<li>
If you want changes in CLIPBOARD to be ignored use the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noclipboard"><code>-noclipboard</code></a> option.
</li>
<li>
If you don't want x11vnc to set PRIMARY to the "CutText" received from viewers use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nosetprimary"><code>-nosetprimary</code></a> option.
</li>
<li>
If you don't want x11vnc to set CLIPBOARD to the "CutText" received from viewers use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nosetclipboard"><code>-nosetclipboard</code></a> option.
</li>
</ul>
You can also fine-tune it a bit with the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-seldir"><code>-seldir dir</code></a> option
and also <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-input"><code>-input</code></a>.
<p></p><p>
You may need to watch out for desktop utilities such as KDE's "Klipper"
that do odd things with the selection, clipboard, and cutbuffers. 
</p><p>&nbsp;</p>

<a name="faq-record-swf"></a>
<a name="FAQ-124"></a>
<p><b>Q-124:</b>
<font color="#007f00">
Can I use <b>x11vnc</b> to record a Shock Wave Flash (or other format)
video of my desktop, e.g. to record a tutorial or demo?
</font>
</p>
<p>
Yes, it is possible with a number of tools that record VNC and transform
it to <code>swf</code> format or others.  One such popular tool is <a href="http://web.archive.org/web/20210304200604/http://www.unixuser.org/~euske/vnc2swf/">pyvnc2swf</a>.
There are a number of 
<a href="http://web.archive.org/web/20210304200604/http://wolphination.com/linux/2006/06/30/how-to-record-videos-of-your-desktop/">tutorials</a> (broken link?)
on how to do this.  Another option is to use the <code>vnc2mpg</code>
that comes in
the LibVNCServer package.
</p>
An important thing to remember when doing this is that tuning parameters
should be applied to <b>x11vnc</b> to speed up its polling for this sort
of application, e.g. "<code>-wait 10 -defer 10</code>".
<p>
</p>


<a name="faq-filexfer"></a>
<a name="FAQ-125"></a>
<p><b>Q-125:</b>
<font color="#007f00">
Can I transfer files back and forth with <b>x11vnc</b>?
</font>
</p>
<p>
As of Oct/2005 and May/2006 <b>x11vnc</b> enables, respectively, the
TightVNC and UltraVNC file transfer implementations that were added to
libvncserver.  This currently works with TightVNC and UltraVNC viewers
(and Windows viewers only support filetransfer it appears... but they do
work to some degree under Wine on Linux.)
</p><p>
The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">SSVNC</a> Unix VNC viewer supports UltraVNC file
transfer by use of a Java helper program.
</p><p>
TightVNC file transfer is off by default, if you want to enable it use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-tightfilexfer"><code>-tightfilexfer</code></a> option.
</p><p>
UltraVNC file transfer is off by default, to enable it
use something like
"<code>-rfbversion 3.6 -permitfiletransfer</code>" options
(UltraVNC incorrectly uses the RFB protocol version to determine if
<em>its</em> features are available, so <b>x11vnc</b> has to pretend to be version 3.6.)
As of Sep/2006 "<code>-ultrafilexfer</code>" is an alias for these two options.
Note that running as RFB version 3.6 may confuse other VNC Viewers.
</p><p>
Sadly you cannot do both <code>-tightfilexfer</code> and
<code>-ultrafilexfer</code> at the same time because the latter
requires setting the version to 3.6 and tightvnc will
not do filetransfer when it sees that version number.
</p><p>
Also, because of the way the LibVNCServer TightVNC file transfer is
implemented, you cannot do Tightvnc file transfer in <code>-unixpw</code>
mode.  However, UltraVNC file transfer does work in <code>-unixpw</code>
(but if a client tries it do a filetransfer during the login process it will
be disconnected.)
</p><p>
<b>IMPORTANT</b>: please understand if <code>-ultrafilexfer</code> or <code>-tightfilexfer</code> is
specified and you run x11vnc as root for, say, inetd
or display manager (gdm, kdm, ...) access and you do
not have it switch users via the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-users"><code>-users</code></a>
option, then
VNC Viewers that connect are able to do filetransfer
reads and writes as <b>*root*</b>.
</p><p>
The UltraVNC and TightVNC settings can be toggled on and off inside
the gui or by <code>-R</code> remote control.  However for TightVNC the
changed setting only applies for NEW clients, current clients retain
their TightVNC file transfer ability.  For UltraVNC it works better,
however if an UltraVNC client has initiated a file transfer dialog it will
remain in effect until the dialog is closed.  If you want to switch
between UltraVNC and TightVNC file transfer in the gui or by remote control
you will probably be foiled by the "<code>-rfbversion 3.6</code>" issue.  
</p><p>&nbsp;</p>

<a name="faq-ultravnc"></a>
<a name="FAQ-126"></a>
<p><b>Q-126:</b>
<font color="#007f00">
Which UltraVNC extensions are supported?
</font>
</p>
<p>
Some of them are supported. To get UltraVNC
Viewers to attempt to use these extensions you will need to supply
this option to <b>x11vnc</b>:
</p><pre>   -rfbversion 3.6
</pre>
Or use 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ultrafilexfer"><code>-ultrafilexfer</code></a>
which is an alias for the above option and "<code>-permitfiletransfer</code>".
UltraVNC evidently treats any other RFB version number as non-UltraVNC. 
<p></p><p>
Here are a list of the UltraVNC extensions supported by <b>x11vnc</b>:
</p><ul>
<li> ServerInput: "Toggle Remote Input and Remote Blank Monitor"</li> 
<li> FileTransfer: "Open File Transfer..."</li> 
<li> SingleWindow: "Select Single Window..."</li> 
<li> TextChat: "Open Chat..."</li> 
<li> 1/n Server Scaling</li> 
<!--
<li> rfbEncodingUltra compression encoding</li> 
-->
</ul>

The <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">SSVNC</a> Unix VNC viewer supports these
UltraVNC extensions.
<p></p><p>
To disable SingleWindow and ServerInput use
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noultraext"><code>-noultraext</code></a>
(the others are managed by LibVNCServer.)
See this option too:
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-noserverdpms"><code>-noserverdpms</code></a>.
</p><p>
Also, the 
<a href="http://web.archive.org/web/20210304200604/http://www.uvnc.com/addons/repeater.html"><code>UltraVNC repeater proxy</code></a>
is supported for use with reverse connections:
"<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-connect"><code>-connect repeater://host:port+ID:NNNN</code></a>".
Use it for both plaintext and SSL connections.
This mode can send any string before switching to the VNC protocol, and
so could be used with other proxy/gateway tools.
Also, a perl repeater implemention is here: <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ultravnc_repeater.pl"><code>ultravnc_repeater.pl</code></a>
</p><p>&nbsp;</p>

<a name="faq-singleclick"></a>
<a name="FAQ-127"></a>
<p><b>Q-127:</b>
<font color="#007f00">
Can <b>x11vnc</b> emulate UltraVNC's Single Click helpdesk mode for Unix?  I.e. something
very simple for a naive user to initiate
a reverse vnc connection from their Unix desktop to a helpdesk operator's
VNC Viewer.
</font>
</p>
<p>
Yes, UltraVNC's <a href="http://web.archive.org/web/20210304200604/http://www.uvnc.com/addons/singleclick.html">
Single Click (SC)</a> mode can be emulated fairly well on Unix.
</p><p>
We use the term "helpdesk" below, but it could be any sort of remote
assistance you want to set up, e.g. something for Unix-using 
friends or family to use.
This includes <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-macosx">Mac OS X</a>.
</p><p>
Assume you create a helpdesk directory "<code>hd</code>" on your website:
<code>http://www.mysite.com/hd</code>
(any website that you can upload files to should work, although remember
the user will be running the programs you place there.)
</p><p>
In that "<code>hd</code>" subdirectory copy an <b>x11vnc</b> binary to
be run on the Unix user's machine (e.g. Linux, etc) and
also create a file named "<code>vnc</code>" containing the following:
</p><pre>#!/bin/sh

webhost="http://www.mysite.com/hd"  # Your helpdesk dir URL.

vnchost="ip.someplace.net"          # Your host running 'vncviewer -listen' 
                                    # It could also be your IP number. If it is
                                    # a router/firewall, you will need to 
                                    # configure it to redirect port 5500 to your
                                    # workstation running 'vncviewer -listen'

dir=/tmp/vnc_helpdesk.$$            # Make a temporary working dir.
mkdir $dir || exit 1
cd $dir || exit 1

trap "cd /tmp; rm -rf $dir" 0 2 15  # Cleans up on exit.

wget $webhost/x11vnc                # Fetch x11vnc binary.  If multi-
chmod 755 ./x11vnc                  # platform, use $webhost/`uname`/x11vnc
                                    # or similar.

./x11vnc -connect_or_exit $vnchost -rfbport 0 -nopw
</pre>
with the hostnames / IP addresses customized to your case.
<p></p><p>
On the helpdesk VNC viewer machine (<code>ip.someplace.net</code> in this
example) you have the helpdesk operator running VNC viewer in listen
mode:
</p><pre>   vncviewer -listen
</pre>
or if on Windows, etc. somehow have the VNC viewer be in "listen" mode.
<p></p><p>
Then, when the naive user needs assistance you instruct him to open
up a terminal window on his Unix desktop and paste the following into
the shell:
</p><pre>   wget -qO - http://www.mysite.com/hd/vnc | sh -
</pre>
and then press Enter.  You could have this instruction on a web page or
in an email you send him, etc.
This requires that the <code>wget</code> is installed on the user's Unix machine
(he might only have <code>curl</code> or <code>lynx</code>, see below for more info.)
<p></p><p>
&nbsp;<br>
So I guess this is about 3-4 clicks (start a terminal and paste) and
pressing "Enter" instead of "single click"...
</p><p>
See <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/single-click.html">this page</a> for some variations
on this method, e.g. how to add a password, SSL Certificates, etc.
</p><p>
&nbsp;<br>
If you don't have a website (there are many free ones) or don't want to
use one you will have to email him all of the ingredients (x11vnc binary
and a launcher script) and tell him how to run it.  This could be easy
or challenging depending on the skill of the naive unix user...
</p><p>
A bit of obscurity security could be put in with a <code>-passwd</code>,
<code>-rfbauth</code> options, etc. (note that <b>x11vnc</b> will require
a password even for reverse connections.)
More info <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/single-click.html">here</a>.
</p><p>
&nbsp;<br>
<b>Firewalls:</b> If the helpdesk (you) with the vncviewer is behind a NAT/Firewall/Router
the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/index.html#firewalls">router</a> will have to be configured to redirect a port (i.e. 5500 or
maybe different one if you like) to the vncviewer machine.  If the 
vncviewer machine also has its own host-level firewall, you will have to
open up the port there as well.
</p><p>
<b>NAT-2-NAT:</b>
There is currently no way to go "NAT-2-NAT", i.e. both User and Helpdesk workstations
behind NAT'ing Firewall/Routers without configuring a router to do a port
redirection (i.e. on your side, the HelpDesk.)  To avoid modifying either
firewall/router, one would need some public (IP address reachable on the internet)
redirection/proxy service.  Perhaps such a thing exists. <a href="http://web.archive.org/web/20210304200604/http://sc.uvnc.com/">
http://sc.uvnc.com</a> provides this service for their UltraVNC Single Click users.
</p><p>
<em>Update:</em> It may be possible to do "NAT-2-NAT" with a UDP tunnel
such as <a href="http://web.archive.org/web/20210304200604/http://samy.pl/pwnat/">http://samy.pl/pwnat/</a>.
All that is required is that both NAT firewalls allow in UDP packets
from an IP address to which a UDP packet has recently been sent to.
If you try it out let us know how it went.
</p><p>
&nbsp;<br>
<b><em>Very Naive Users:</em></b>
</p><p>
If it is beyond the user how to open a terminal window and paste in
a command (you have my condolences...) you would have to somehow setup
his Web browser to download the "<code>vnc</code>" file (or a script
containing the above <code>wget</code> line) and prompt the user if he
wants to run it.  This may be tricky to set up (which is probably
a good thing to not have the web browser readily run arbitrary programs
downloaded from the internet...)
</p><p>
One command-line free way, tested with KDE, is to name the file
<code>vnc.sh</code> and then instruct the user to right-click on the link and do "Save Link As" to
his Desktop.  It will appear as an icon, probably one that looks like
a terminal or a command line prompt.  He next should right-click on the
icon and select "Properties" and go to the "Permissions" tab.  Then in
that dialog select the checkbox "Is executable".  He should then be able
to click on the icon to launch it.  Another option is to right-click on
the icon and select "Open With -&gt; Other ..."  and for the name of the
application type in "<code>/bin/sh</code>".  Unfortunately in both cases
the command output is lost and so errors cannot be debugged as easily.
A similar thing appears to work in GNOME if under
"Properties -&gt; Permissions" they click on "Execute" checkbox
for "Owner".  Then when they click on the icon, they will get a dialog
where they can select "Run in Terminal".
In general for such cases, if it is feasible, it might be easier to
<code>ssh</code> to his machine and set things up yourself...
</p><p>
&nbsp;<br>
<b><em>SSL Encrypted Helpdesk Connections:</em></b>&nbsp;
</p><p>
As of Apr/2007 <b>x11vnc</b> supports reverse
connections in SSL and so we can do this.
On the Helpdesk side (Viewer) you will need STUNNEL or better use the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a> package we provide
that automates all of the SSL for you.
</p><p>
To do this create a file named
"<code>vncs</code>" in the website "<code>hd</code>" directory containing the following:
</p><pre>#!/bin/sh

webhost="http://www.mysite.com/hd"  # Your helpdesk dir URL.

vnchost="ip.someplace.net"          # Your host running 'vncviewer -listen' 
                                    # It could also be your IP number. If it is
                                    # a router/firewall, you will need to 
                                    # configure it to redirect port 5500 to your
                                    # workstation running 'vncviewer -listen'

dir=/tmp/vnc_helpdesk.$$            # Make a temporary working dir.
mkdir $dir || exit 1
cd $dir || exit 1

trap "cd /tmp; rm -rf $dir" 0 2 15  # Cleans up on exit.

wget $webhost/x11vnc                # Fetch x11vnc binary.  If multi-
chmod 755 ./x11vnc                  # platform, use $webhost/`uname`/x11vnc
                                    # or similar.

./x11vnc -connect_or_exit $vnchost -rfbport 0 -nopw -ssl    # Note -ssl option.
</pre>
with the hostnames or IP addresses customized to your case.
<p></p><p>
The only change from the "<code>vnc</code>" above is the addition
of the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-ssl"><code>-ssl</code></a> option to
<b>x11vnc</b>.  This will create a temporary SSL cert: <code>openssl(1)</code>
will need to be installed on the user's end.  A fixed SSL cert file could be
used to avoid this (and provide some authentication;
more info <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/single-click.html">here</a>.)
</p><p>
The naive user will be doing this:
</p><pre>   wget -qO - http://www.mysite.com/hd/vncs | sh -
</pre>
(or perhaps even use https:// if available.)
<p></p><p>
But before that,
the helpdesk operator needs to have "<code>vncviewer -listen</code>" running
as before, however he needs an SSL tunnel at his end.
The easiest way to do this is use
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">Enhanced TightVNC Viewer (SSVNC)</a>.
Start it, and select Options -&gt; 'Reverse VNC Connection (-listen)'.
Then <b>UN-</b>select 'Verify All Certs' (this can be enabled later if you
want; you'll need the x11vnc SSL certificate), and click 'Listen'.

</p><p>
If you don't want to use SSVNC for the viewer, but rather set up STUNNEL
manually instead, make a file
"<code>stunnel.cfg</code>" containing:
</p><pre>foreground = yes
pid =

[vnc]
accept = 5500
connect = localhost:5501
</pre>
and run:
<pre>  stunnel ./stunnel.cfg
</pre>
and then start the "<code>vncviewer -listen 1</code>"
(i.e. 1 to correspond to the 5501 port.)
Note that this assumes the stunnel install created
a Server SSL cert+key, usually <code>/etc/stunnel/stunnel.pem</code> (not
all distros will do this.)  Also, that file is by default only readable by
root, so stunnel needs to be run as root.  If your system does not have
a key installed or you do not want to run stunnel as root (or change
the permissions on the file), you can use <b>x11vnc</b> to create one
for you for example:
<pre>  x11vnc -sslGenCert server self:mystunnel
</pre>
answer the prompts with whatever you want; you can
take the default for all of them if you like.  The <code>openssl(1)</code>
package must be installed.
See <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/single-click.html">this link</a> and <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssl.html">this one too</a>
for more info on SSL certs.
This creates
<code>$HOME/.vnc/certs/server-self:mystunnel.pem</code>, then you would
change the "<code>stunnel.cfg</code>" to look something like:
<pre>foreground = yes
pid =
cert = /home/myusername/.vnc/certs/server-self:mystunnel.pem

[vnc]
accept = 5500
connect = localhost:5501
</pre>
<p></p><p>
In any event, with stunnel having been setup, the naive user is instructed
to paste in and run:
</p><pre>   wget -qO - http://www.mysite.com/hd/vncs | sh -
</pre>
to pick up the <code>vncs</code> script this time.
<p></p><p>
Of course if a man-in-the-middle can alter what the user <b><em>downloads</em></b>
then all bets are off!.
</p><p>
More SSL variations and info about certificates can be found
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/single-click.html">here</a>.
</p><p>
<a name="infaq_libssl-problems"></a>
&nbsp;<br>
<b><em>OpenSSL libssl.so.0.9.7 problems:</em></b>
</p><p>
If you build your own stunnel or x11vnc for deployment, you may want to <em>statically
link</em> <code>libssl.a</code> and <code>libcrypto.a</code> into it because
Linux distros are currently a bit of a mess regarding which version
of <code>libssl</code> is installed.
</p><p>
You will find the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/single-click.html#libssl-problems">details here</a>. 
</p><p>&nbsp;</p>

<a name="faq-smb-shares"></a>
<a name="FAQ-128"></a>
<p><b>Q-128:</b>
<font color="#007f00">
Can I (temporarily) mount my local (viewer-side) Windows/Samba File share
on the machine where <b>x11vnc</b> is running?
</font>
</p>
<p>
You will have to use an external network redirection for this.
Filesystem mounting is not part of the VNC protocol.  
</p><p>
We show a simple <b><a href="http://web.archive.org/web/20210304200604/http://www.samba.org/">Samba</a></b> example here.
</p><p>
First you will need a tunnel to redirect the SMB requests from the remote
machine to the one you sitting at.  We use an <code>ssh</code> tunnel:
</p><pre>  sitting-here&gt; ssh -C -R 1139:localhost:139 far-away.east
</pre>
Or one could combine this with the VNC tunnel at the same time, e.g.:
<pre>  sitting-here&gt; ssh -C -R 1139:localhost:139 -t -L 5900:localhost:5900 far-away.east 'x11vnc -localhost -display :0'
</pre>
Port 139 is the Windows Service port.  For Windows systems instead of
Samba, you may need to use the actual IP address of the Window machine
instead of "localhost" in the -R option (since the Windows service does
not listen on localhost by default.)
<p></p><p>
Note that we use 1139 instead of 139 on the remote side because 139 would
require root permission to listen on (and you may have a samba server
running on it already.)
</p><p>
The ssh <code>-C</code> is to enable compression, which might speed
up the data transfers.
</p><p>
Depending on the remote system side configuration, it may or may not
be possible to mount the SMB share as a non-root user.  Try it first
as a non-root user and if that fails you will have to become root.
</p><p>
We will assume the user name is "fred" and we will try to mount the viewer-side
Windows SMB share "<code>//haystack/pub</code>" in <code>/home/fred/smb-haystack-pub</code>. 
</p><pre>  far-away&gt; mkdir -p /home/fred/smb-haystack-pub
  far-away&gt; smbmount //haystack/pub /home/fred/smb-haystack-pub -o username=fred,ip=127.0.0.1,port=1139
</pre>
(The 2nd command may need to be run as root.)
Then run "<code>df</code>" or "<code>ls -l /home/fred/smb-haystack-pub</code>"
to see if it is mounted properly.  Consult the <code>smbmount(8)</code>
and related documentation (it may require some fiddling to get
write permissions correct, etc.)  To unmount:
<pre>  far-away&gt; smbumount /home/fred/smb-haystack-pub
</pre>
<p></p><p>
At some point we hope to fold some automation for SMB ssh redir
setup into the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">
Enhanced TightVNC Viewer (SSVNC)</a> package we provide (as of Sep 2006 it is
there for testing.)
</p><p>&nbsp;</p>

<a name="faq-cups"></a>
<a name="FAQ-129"></a>
<p><b>Q-129:</b>
<font color="#007f00">
Can I redirect CUPS print jobs from the remote desktop where 
<b>x11vnc</b> is running to a printer on my local (viewer-side) machine?
</font>
</p>
<p>
You will have to use an external network redirection for this.
Printing is not part of the VNC protocol.  
</p><p>
We show a simple Unix to Unix <b><a href="http://web.archive.org/web/20210304200604/http://www.cups.org/">CUPS</a></b> example here.
Non-CUPS port redirections (e.g. LPD) should also be possible, but may
be a bit more tricky.
If you are viewing on Windows SMB and don't have a local cups server it
may be trickier still (see below.) 
</p><p>
First you will need a tunnel to redirect the print requests from the remote
machine to the one you sitting at.  We use an <code>ssh</code> tunnel:
</p><pre>  sitting-here&gt; ssh -C -R 6631:localhost:631 far-away.east
</pre>
Or one could combine this with the VNC tunnel at the same time, e.g.:
<pre>  sitting-here&gt; ssh -C -R 6631:localhost:631 -t -L 5900:localhost:5900 far-away.east 'x11vnc -localhost -display :0'
</pre>
Port 631 is the default CUPS port.
The above assumes you have a Cups server running on your viewer
machine (<code>localhost:631</code>), if not, use something like
<code>my-cups-srv:631</code> (the viewer-side Cups server) 
in the <code>-R</code> instead.
<p></p><p>
Note that we use 6631 instead of 631 on the remote side because 631 would
require root permission to listen on (and you likely have a cups server
running on it already.)
</p><p>
Now the tricky part: to get applications to <em>notice</em> your cups server/printer
on <code>localhost:6631</code>.
</p><p>
If you have administrative privilege (i.e. root password) on the
<b>x11vnc</b> side where the desktop is running, it should be easy to
add the printer through some configuration utility
(e.g. in KDE: Utilities -&gt; Printing -&gt; Printing Manager, and
then supply admin password, and then Add Printer/Class, and then fill
in the inquisitive wizard. Most important is the "Remote IPP server"
panel where you put in localhost for Host and 6631 for Port.)
The main setting you want to convey is the host is localhost
and the port is non-standard (e.g. 6631.)  Some configuration
utilities will take an Internet Printing Protocol (IPP) URI,
e.g. <code>http://localhost:6631/printers/</code>,
<code>ipp://localhost:6631/printers/printer-name</code>,
<code>ipp://localhost:6631/ipp/printer-name</code>, etc.
Check your CUPS documentation and admin interfaces to find what
the syntax is and what the "<code>printer name</code>" is.
</p><p>
If you do not have root or print admin privileges, but are running a recent
(version 1.2 or greater) of the Cups client software, then an easy way to
temporarily switch Cups servers is to create the directory and file:
<code>$HOME/.cups/client.conf</code> on the remote side with a line like:
</p><pre>  ServerName localhost:6631
</pre>
When not using <b>x11vnc</b> for remote access you can comment the
above line out with a '#' (or rename the client.conf file), to have normal
cups operation.
<p></p><p>
Unfortunately, running applications may need to be restarted
to notice the new printers (libcups does not track changes in client.conf.)
Depending on circumstances, a running application may actually notice
the new printers without restarting (e.g. no print dialog has taken
place yet, or there are no CUPS printers configured on the remote side.)
</p><p>
Cups client software that is older (1.1) does
not support appending the port number, and for newer ones
there is a bug preventing it from always working (fixed in 1.2.3.)
Kludges like these at the command line will work:
</p><pre>  far-away&gt; env CUPS_SERVER=localhost IPP_PORT=6631 lpstat -p -d
  far-away&gt; env CUPS_SERVER=localhost IPP_PORT=6631 lpr -P myprinter file.ps
  far-away&gt; env CUPS_SERVER=localhost IPP_PORT=6631 firefox
</pre>
but are somewhat awkward since you have to retroactively set the
env. var <code>IPP_PORT</code>.  Its value cannot be broadcast to
already running apps (like the <code>$HOME/.cups/client.conf</code> trick sometimes does.)
A common workaround for an already running app is to somehow get it
to "Print To File", e.g. <code>file.ps</code> and then use something
like the <code>lpr</code> example above.
Also, the option "<code>-h host:port</code>" works with CUPS <code>lp(1)</code>
and <code>lpr(1)</code>.
<p></p><p>
You can also print to Windows shares printers in principle.
You may do this with the <code>smbspool(8)</code> command, or
configure the remote CUPS via <code>lpadmin(8)</code>, etc,
to use a printer URI something like <code>smb://machine:port/printer</code>
(this may have some name resolution problems WRT localhost.)  Also,
as with SMB mounting, the port redir (-R) to the Windows machine must
use the actual IP address instead of "localhost".
</p><p>
At some point we hope to fold some automation for CUPS ssh redir
setup into the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">
Enhanced TightVNC Viewer (SSVNC)</a> package we provide (as of Sep 2006 it is
there for testing.)
</p><p>&nbsp;</p>

<a name="faq-sound"></a>
<a name="FAQ-130"></a>
<p><b>Q-130:</b>
<font color="#007f00">
How can I hear the sound (audio) from the remote applications on the desktop
I am viewing via <b>x11vnc</b>?
</font>
</p>
<p>
You will have to use an external network audio mechanism for this.
Audio is not part of the VNC protocol.  
</p><p>
We show a simple Unix to Unix <b>esd</b> example here (<b>artsd</b> should
be possible too, we have also verified the esd 
Windows port works for the method described below.)
</p><p>
First you will need a tunnel to redirect the audio from the remote
machine to the one you sitting at.  We use an <code>ssh</code> tunnel:
</p><pre>  sitting-here&gt; ssh -C -R 16001:localhost:16001 far-away.east
</pre>
Or one could combine this with the VNC tunnel at the same time, e.g.:
<pre>  sitting-here&gt; ssh -C -R 16001:localhost:16001 -t -L 5900:localhost:5900 far-away.east 'x11vnc -localhost -display :0'
</pre>
Port 16001 is the default ESD uses.  So when an application on the remote
desktop makes a sound it will connect to this tunnel and be redirected
to port 16001 on the local machine (<code>sitting-here</code> in this 
example.)  The <code>-C</code> option is an attempt to compress the
audio a little bit.
<p></p><p>
So we next need a local (<code>sitting-here</code>) esd daemon running that will
receive those requests and play them on the local sound device:
</p><pre>  sitting-here&gt; esd -promiscuous -port 16001 -tcp -bind 127.0.0.1
</pre>
See the <code>esd(1)</code> man page for the meaning of the options (the above
are not very secure.)
(This method also works with the EsounD windows port esd.exe)
<p></p><p>
To test this sound tunnel, we use the <code>esdplay</code> program to
play a simple .wav file:
</p><pre>  far-away&gt; esdplay -s localhost:16001 im_so_happy.wav
</pre>
If you hear the sound (Captain Kirk in this example), that means you
are in great shape.
<p></p><p>
To run individual audio applications you can use the <code>esddsp(1)</code>
command:
</p><pre>  far-away&gt; esddsp -s localhost:16001 xmms
</pre>
Then you could try playing some sounds inside xmms.  You could also set
the environment variable <code>ESPEAKER=localhost:16001</code> to 
not need to supply the <code>-s</code> option all the time.  
(for reasons not clear, sometimes <code>esddsp</code> can figure it out
on its own.)  All
the script <code>esddsp</code> does is to set <code>ESPEAKER</code>
and <code>LD_PRELOAD</code> for you so that when the application opens
the sound device (usually <code>/dev/dsp</code>) its interactions with
the device will be intercepted and sent to the <code>esd</code>
daemon running on <code>sitting-here</code> (that in turn writes them to
the real, local <code>/dev/dsp</code>.)
<p></p><p>
<em>Redirecting All sound:</em></p><p> It does not seem to be possible
to switch all of the sound of the remote machine from its sound device
to the above <code>esd+ssh</code> tunnel without some preparation.
But it can be done reasonably well if you prepare (i.e. restart) the
desktop with this in mind.
</p><p>
Here is one way to redirect all sound.  The idea is we run the
<em>entire</em> desktop with sound directed to <code>localhost:16001</code>.
When we are sitting at <code>far-away.east</code> we run "<code>esd -promiscuous -port 16001 -tcp -bind 127.0.0.1</code>"
on <code>far-away.east</code> (to be able to hear the sound.)
However, when we are sitting at <code>sitting-here.west</code> we kill that
<code>esd</code> process and run that same <code>esd</code> command on
<code>sitting-here.west</code> and start up the above <code>ssh</code>
tunnel.  This is a little awkward, but with some scripts one would
probably kill and restart the esd processes automatically when
<b>x11vnc</b> is used.
</p><p>
So next we have to run the whole desktop pointing toward our <code>esd</code>.
Here is a simple way to test.  Log in to the machine via the "FailSafe"
desktop.  Then in the lone terminal type something like:
</p><pre>  esddsp -s localhost:16001 gnome-session
or:
  esddsp -s localhost:16001 startkde
</pre>
where the last part is whatever command starts your desktop
(even <code>fvwm2</code>.)  This causes the environment variables
<code>ESPEAKER</code> and <code>LD_PRELOAD</code> to be set appropriately
and <em>every</em> application (processes with the desktop as an ancestor)
will use them.
If this scheme works well you can make it less klunky by adding the
command to your <code>~/.xsession</code>, etc. file that starts your
default desktop.  Or you may be able to configure your desktop to
use <code>localhost:16001</code>, or whatever is needed, via a gui
configuration panel.
<p></p>
<em>Some Notes:</em>
<ul>
<li>
Not all audio applications are compatible
with the <b>esd</b> and <b>artsd</b> mechanisms, but many are.
</li>
<li>
The audio is not compressed so you probably need a broadband or faster
connection. Listening to music may not be very pleasant... 
(Although we found streaming music from across the US over cable
modem worked OK, but took 200 KB/sec, to use less bandwidth consider
something like "<code>ssh far-away.east 'cat favorite.mp3' | mpg123 -b 4000 -</code>")
</li>
<li>
Linux does not seem to have the concept of <code>LD_PRELOAD_64</code>
so if you run on a mixed 64- and 32-bit ABI system (e.g. AMD <code>x86_64</code>)
some of the applications will fail to run because <code>LD_PRELOAD</code>
will point to libraries of the wrong wordsize.
</li>
<li>
At some point we hope to fold some automation for esd or artsd ssh redir
setup into the <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">
Enhanced TightVNC Viewer (SSVNC)</a> package we provide (as of Sep/2006 it is
there for testing.)
</li>
</ul>
<p></p><p>&nbsp;</p>

<a name="faq-beeps"></a>
<a name="FAQ-131"></a>
<p><b>Q-131:</b>
<font color="#007f00">
Why don't I hear the "Beeps" in my X session (e.g. when typing <code>tput bel</code>
in an xterm)?
</font>
</p>
<p>
As of Dec/2003 "Beep" XBell events are tracked
by default.  The X server must support the XKEYBOARD extension (this is not
on by default in Solaris, see <code>Xserver(1)</code> for how to turn it on
via <code>+kb</code>),
and so you won't hear them if the extension is not present.
</p><p>
If you don't want to hear the beeps use the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-nobell"><code>-nobell</code></a> option.
If you want to hear the audio from the remote applications, consider trying
a <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-sound">redirector such as <b>esd</b></a>. 
</p>
<p></p><p>&nbsp;</p>

<a name="faq-ipv6"></a>
<a name="FAQ-132"></a>
<p><b>Q-132:</b>
<font color="#007f00">
Does <b>x11vnc</b> work with IPv6?
</font>
</p>
<p>
<em><b>Update</b>:</em> as of Apr/2010 in the 0.9.10 <b>x11vnc</b> development tarball,
there is now built-in support for IPv6 (128 bit internet addresses.)
See the 
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-6"><code>-6</code></a> and
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-connect"><code>-connect</code></a> options
for details.
</p><p>
The remainder of this FAQ entry shows how to do with this
with pre 0.9.10 x11vnc using IPv6 helper tools.
</p><p>
</p><hr noshade="1" size="1">
<em>Using an external IPv6 helper:</em><br>
<br>
A way to do this is via a separate helper program such as
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/faq.html#faq-inetd">inetd</a> (or for encrypted connections: ssh or stunnel.)
For example, you configure <b>x11vnc</b> to be
run from inetd or xinetd and instruct it to listen on an IPv6 address. 
For xinetd the setting "<code>flags = IPv6</code>" will be needed.
For inetd.conf, an example is:
<pre>  5900 stream tcp6 nowait root /usr/sbin/tcpd /usr/local/bin/x11vnc_wrapper.sh
</pre>
<p></p><p>
We also provide a transitional tool in "<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/inet6to4"><code>x11vnc/misc/inet6to4</code></a>"
that acts as a relay for any IPv4 application to allow connections
over IPv6.  For example:
</p><pre>  inet6to4 5900 localhost:5900
</pre>
where <b>x11vnc</b> is listening on IPv4 port 5900.
<p></p><p>
Also note that not all VNC Viewers are IPv6 enabled, so a redirector may
also be needed for them.  The tool "<code>inet6to4 -r ...</code>" can do
this as well.  SSVNC (see below) supports IPv6 without need for the helper.
</p><p>
</p><pre>  # ./inet6to4 -help
  
  inet6to4:  Act as an ipv6-to-ipv4 relay for tcp applications that
             do not support ipv6.
  
  Usage:     inet6to4    <ipv6-listen-port> <ipv4-host:port>
             inet6to4 -r <ipv4-listen-port> <ipv6-host:port>
  
  Examples:  inet6to4 5900 localhost:5900
             inet6to4 8080 web1:80
             inet6to4 -r 5900 fe80::217:f2ff:fee6:6f5a%eth0:5900
  
  The -r option reverses the direction of translation (e.g. for ipv4
  clients that need to connect to ipv6 servers.)  Reversing is the default
  if this script is named 'inet4to6' (e.g. by a symlink.)
  
  Use Ctrl-C to stop this program.
  
  You can also set env. vars INET6TO4_LOOP=1 or INET6TO4_LOOP=BG
  to have an outer loop restarting this program (BG means do that
  in the background), and INET6TO4_LOGFILE for a log file.
  Also set INET6TO4_VERBOSE to verbosity level and INET6TO4_WAITTIME
  and INET6TO4_PIDFILE (see below.)

</ipv6-host:port></ipv4-listen-port></ipv4-host:port></ipv6-listen-port></pre>
The "<code>INET6TO4_LOOP=BG</code>" and "<code>INET6TO4_LOGFILE=...</code>" env. variables make
the tool run reliably as a daemon for very long periods.
Read the top part of the script for more information.
<p></p><p>
</p><hr noshade="1" size="1">
<em>Encrypted Tunnels with IPv6 Support:</em><br>
<br>
For SSH tunnelled encrypted VNC connections, one can of course use the IPv6
support in ssh(1).
<p></p><p>
For SSL encrypted VNC connections, one possibility is to use the IPv6
support in stunnel(1).  This includes the built-in support via the
<a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-stunnel"><code>-stunnel</code></a> option.
For example:
</p><pre>  x11vnc -stunnel SAVE -env STUNNEL_LISTEN=:: -env STUNNEL_DEBUG=1 ...
</pre>
<p></p><p>
</p><hr noshade="1" size="1">
<em>SSH IPv6 Tricks:</em><br>
<br>
It is interesting to note that ssh(1) can do basically the same thing as inet6to4 above by:
<pre>  ssh -g -L 5900:localhost:5901 localhost "printf 'Press Enter to Exit: '; read x"
</pre>
(where we have x11vnc running via "<code>-rfbport 5901</code>" in this case.)
<p></p><p>
Note that one can also make a home-brew SOCKS5 ipv4-to-ipv6 gateway
proxy using ssh like this:
</p><pre>  ssh -D '*:1080' localhost "printf 'Press Enter to Exit: '; read x"
</pre>
then specify a proxy like <code>socks://hostname:1080</code> where
hostname is the machine running the above ssh command (add -v to ssh
for connection logging info.)
<p></p><p>
</p><hr noshade="1" size="1">
<em>IPv6 SSVNC Viewer:</em><br>
<br>
Our <a href="http://web.archive.org/web/20210304200604/http://www.karlrunge.com/x11vnc/ssvnc.html">SSVNC VNC Viewer</a> is basically a wrapper for
ssh(1) and stunnel(1), and so it already has good IPv6 support because
these two commands do.  On Unix, MacOSX, and Windows nearly all of the
the remaining parts of SSVNC (e.g. the built-in proxying and un-encrypted
connections) have been modified to support IPv6 in SSVNC 1.0.26.
<p></p>
<p>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
</p>
<h4>Contributions:</h4>

<a name="faq-thanks"></a>
<a name="FAQ-133"></a>
<p><b>Q-133:</b>
<font color="#007f00">
Thanks for your program or for your help!  Can I make a donation?
</font>
</p>
<p>
Please do (any amount is appreciated; very few have donated)
and thank you for your support!  
Click on the PayPal button below for more info.
</p>
<p>
<!--
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
<input type="hidden" name="cmd" value="_donations">
<input type="hidden" name="business" value="runge at-sign karlrunge.com">
<input type="hidden" name="item_name" value="x11vnc Donation">
<input type="hidden" name="image_url" value="http://www.karlrunge.com/x11vnc/x11vnc2.gif">
<input type="hidden" name="cpp_header_image" value="http://www.karlrunge.com/x11vnc/x11vnc2.gif">
<input type="hidden" name="no_shipping" value="1">
<input type="hidden" name="no_note" value="1">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="tax" value="0">
<input type="image" src="x-click-but04.gif" border="0" name="submit" alt="[PayPal]">
-->
</p><form action="http://web.archive.org/web/20210304200604/https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
<input type="hidden" name="cmd" value="_donations">
<input type="hidden" name="business" value="runge at-sign karlrunge.com">
<input type="hidden" name="item_name" value="x11vnc Donation">
<input type="hidden" name="no_shipping" value="1">
<input type="hidden" name="no_note" value="0">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="tax" value="0">
<input type="image" src="./x11vnc_files/x-click-but04.gif" border="0" name="submit" alt="">
<img alt="" border="0" src="./x11vnc_files/pixel.gif" width="1" height="1">
</form>
<!--
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
<input type="hidden" name="cmd" value="_donations">
<input type="hidden" name="business" value="runge at-sign karlrunge.com">
<input type="hidden" name="item_name" value="x11vnc Donation">
<input type="hidden" name="no_shipping" value="1">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="tax" value="0">
<input type="image" src="http://www.karlrunge.com/x11vnc/x-click-but04.gif" border="0" name="submit" alt="">
<img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
-->


<p></p>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>



</body></html>